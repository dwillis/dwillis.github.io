# Correlation: Finding Patterns

The economics reporter at your paper has a theory: "Rich countries are happier countries. It's obvious—money solves problems." She wants to write a feature about how GDP drives national happiness.

You're skeptical. Sure, poverty creates misery. But does more wealth automatically create more happiness? And if so, how strong is that relationship? Is it the money itself, or something else that comes with money—healthcare, education, stability?

Before your colleague writes that piece, you need to measure the relationship. Is it strong or weak? Does it hold across all countries, or just some? And critically: even if GDP and happiness move together, can we say one causes the other?

This is what correlation analysis does. It measures relationships between variables, quantifies how strong those relationships are, and—crucially—stops us from making claims we can't support.

## The Classic Mistake

Every statistics course starts with this warning: **Correlation does not imply causation.** Students nod. Professors emphasize it. Everyone agrees.

And then everyone ignores it.

News stories constantly confuse correlation with causation:
- "Study finds coffee drinkers live longer" (implication: coffee extends life)
- "Children who play video games are more violent" (implication: games cause violence)
- "Countries that eat more chocolate win more Nobel prizes" (implication: eat chocolate, get smarter)

All of these statements report correlations but imply causation. The problem? There could be:

**Reverse causation**: Maybe violent kids seek out violent games, not the other way around.

**Third variable problem**: Maybe wealthy countries buy more chocolate AND have better universities that produce Nobel winners. Chocolate doesn't cause intelligence; wealth causes both.

**Pure coincidence**: Sometimes things correlate by pure chance. Nicolas Cage movies really do correlate with swimming pool drownings. But nobody seriously thinks his filmography affects aquatic safety.

As journalists, we need to report correlations honestly: what they show and what they don't show.

## What Correlation Actually Measures

Correlation quantifies **how closely two variables move together**. The correlation coefficient (r) ranges from -1 to 1:

- **r = 1**: Perfect positive correlation. When one goes up, the other goes up proportionally.
- **r = 0**: No correlation. The variables move independently.
- **r = -1**: Perfect negative correlation. When one goes up, the other goes down proportionally.

**Strength guidelines:**
- |r| < 0.3: Weak
- 0.3 ≤ |r| < 0.7: Moderate
- |r| ≥ 0.7: Strong

But strength isn't everything. You also need to know: Is this correlation statistically significant? Could it be random chance?

## Loading Our Data

Let's test your colleague's theory with the World Happiness Report, which surveys life satisfaction across countries:

```{r setup, message=FALSE}
library(tidyverse)
```

```{r load-data, message=FALSE}
happiness_url <- "https://raw.githubusercontent.com/VivekAgrawl/World-Happiness-Report-2023/refs/heads/main/whr2023.csv"
happiness_data <- read_csv(happiness_url)

# Clean and prepare the data
happiness_analysis <- happiness_data |>
  select(
    country = `Country name`,
    happiness_score = `Happiness score`,
    gdp_per_capita = `Logged GDP per capita`,
    social_support = `Social support`,
    life_expectancy = `Healthy life expectancy`,
    freedom = `Freedom to make life choices`
  ) |>
  drop_na()

# What do we have?
head(happiness_analysis, 10)
```

Each row is one country. The happiness score is based on survey responses to "How satisfied are you with your life?" GDP is logged (economists do this to handle the wide range of incomes).

## Testing the Relationship

Let's calculate the correlation between GDP and happiness:

```{r correlation-test}
cor_result <- cor.test(
  happiness_analysis$gdp_per_capita,
  happiness_analysis$happiness_score
)

print(cor_result)
```

The output gives us three key pieces:

**Correlation (r)**: The strength and direction of the relationship. Look at the "cor" value.

**P-value**: The probability this correlation is due to random chance. If p < 0.05, it's statistically significant.

**Confidence interval**: The range where we're 95% confident the true correlation lies.

So what did we find? The correlation is probably around 0.75-0.80 (strong positive), with p < 0.001 (highly significant). Your colleague's intuition has statistical support—but we're not done yet.

## Visualizing the Relationship

Numbers are precise, but visualizations reveal patterns. Let's plot GDP against happiness:

```{r scatter-plot, fig.width=10, fig.height=7}
ggplot(happiness_analysis, aes(x = gdp_per_capita, y = happiness_score)) +
  geom_point(aes(color = social_support, size = life_expectancy), alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, color = "darkgreen") +
  geom_text(
    aes(label = country),
    data = happiness_analysis |>
      filter(happiness_score > 7.5 | happiness_score < 3.5),
    size = 3, hjust = -0.1, vjust = -0.1, check_overlap = TRUE
  ) +
  scale_color_viridis_c(name = "Social Support") +
  scale_size_continuous(name = "Life Expectancy") +
  labs(
    title = "GDP per Capita vs. Happiness Score",
    subtitle = paste("Pearson's r =", round(cor_result$estimate, 3),
                     ", p-value < 0.001"),
    x = "Log GDP per Capita",
    y = "Happiness Score"
  ) +
  theme_light()
```

Now we see the story the correlation tells:

**The upward trend**: As GDP increases, happiness generally increases. Not always, but on average.

**The scatter**: Points don't fall exactly on the line. GDP isn't the only thing that matters.

**The outliers**: Some poor countries are happier than expected. Some rich countries are less happy. Those are story leads—what makes them different?

**The leveling off**: Notice how the slope seems less steep at the right side? Once countries get wealthy enough, more wealth adds less happiness. Diminishing returns.

That scatter plot is worth a thousand words. It shows your colleague is partly right: GDP correlates with happiness. But it also shows the relationship isn't simple or deterministic.

## What Else Correlates With Happiness?

GDP isn't the only factor. Let's check several:

```{r compare-correlations}
correlations <- tibble(
  Factor = c("GDP per Capita", "Social Support", "Life Expectancy", "Freedom"),
  Correlation = c(
    cor(happiness_analysis$gdp_per_capita, happiness_analysis$happiness_score),
    cor(happiness_analysis$social_support, happiness_analysis$happiness_score),
    cor(happiness_analysis$life_expectancy, happiness_analysis$happiness_score),
    cor(happiness_analysis$freedom, happiness_analysis$happiness_score)
  )
) |>
  arrange(desc(abs(Correlation)))

knitr::kable(correlations, digits = 3, caption = "Which factors correlate most strongly with happiness?")
```

Interesting! GDP might not even be the strongest predictor. Social support could be more important. Or maybe they're all interrelated—rich countries can afford better healthcare, which extends life expectancy, which...

This is why correlation doesn't prove causation. When everything correlates with everything, it's hard to untangle what's actually driving what.

## Testing Multiple Factors

Let's visualize all four relationships:

```{r multiple-relationships, fig.width=12, fig.height=10}
happiness_long <- happiness_analysis |>
  pivot_longer(
    cols = c(gdp_per_capita, social_support, life_expectancy, freedom),
    names_to = "factor",
    values_to = "value"
  )

ggplot(happiness_long, aes(x = value, y = happiness_score)) +
  geom_point(alpha = 0.5, color = "steelblue") +
  geom_smooth(method = "lm", se = TRUE, color = "darkred") +
  facet_wrap(~factor, scales = "free_x", ncol = 2) +
  theme_minimal() +
  labs(
    title = "Multiple Factors Associated with Happiness",
    subtitle = "All show positive correlations, but with different strengths",
    x = "Factor Value",
    y = "Happiness Score"
  )
```

They all trend upward. They all correlate. But which one really matters? Which one, if you could change it, would actually increase happiness?

Correlation can't answer that question. For that, you'd need a randomized controlled experiment (give some countries more GDP, others more freedom, and measure outcomes). Good luck getting that approved.

## The Correlation Matrix

When you have multiple variables, a correlation matrix shows all pairwise relationships:

```{r correlation-matrix}
cor_matrix <- happiness_analysis |>
  select(-country) |>
  cor() |>
  round(3)

knitr::kable(cor_matrix)
```

Every cell shows the correlation between two variables. The diagonal is always 1 (perfect correlation with itself).

Look at GDP and social support: they correlate at 0.7-ish. Rich countries have better social support. But which came first? Did wealth enable social programs? Or do socially cohesive countries create conditions for economic growth?

Correlation can't tell you.

## Visualizing the Matrix

A heatmap makes patterns easier to spot:

```{r correlation-heatmap, fig.width=10, fig.height=8}
happiness_analysis |>
  select(-country) |>
  cor() |>
  round(3) |>
  as.data.frame() |>
  rownames_to_column("Variable") |>
  pivot_longer(-Variable, names_to = "Measure", values_to = "Correlation") |>
  ggplot(aes(x = Variable, y = Measure, fill = Correlation)) +
  geom_tile() +
  scale_fill_gradient2(
    low = "blue",
    mid = "white",
    high = "red",
    midpoint = 0
  ) +
  geom_text(aes(label = round(Correlation, 2)), color = "black", size = 3) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "How Happiness Factors Correlate with Each Other")
```

Red means strong positive correlation. Blue would be strong negative (we don't see much blue here—these factors all tend to move together). White means no correlation.

This heatmap reveals the complexity: happiness isn't driven by one factor. It's a web of interrelated variables. Disentangling cause and effect requires more sophisticated methods (like regression, which we'll learn next).

## Are These Correlations Significant?

Just because we calculated a correlation doesn't mean it's meaningful. With small samples, random chance can produce correlations. Let's test significance:

```{r significance-tests}
factors <- c("gdp_per_capita", "social_support", "life_expectancy", "freedom")

correlation_tests <- map_df(factors, function(factor) {
  test <- cor.test(
    happiness_analysis[[factor]],
    happiness_analysis$happiness_score
  )

  tibble(
    Factor = factor,
    Correlation = test$estimate,
    P_Value = test$p.value,
    Significant = test$p.value < 0.05
  )
})

knitr::kable(correlation_tests, digits = 4)
```

With p-values this low (probably all < 0.001), these correlations are definitely not due to chance. If there were actually no relationship, we'd almost never see correlations this strong by random sampling.

## The Trap of Spurious Correlations

Here's where correlation gets dangerous. If you test enough variables, you'll find correlations by pure chance.

Famous spurious correlations:
- Per capita cheese consumption correlates with number of people who died by getting tangled in their bedsheets
- Nicolas Cage movies correlate with swimming pool drownings
- U.S. spending on science correlates with suicides by hanging

These are real correlations in real data. They're also meaningless. Nobody thinks cheese consumption causes bedsheet deaths.

But in journalism, we see this mistake constantly:
- "Study finds autism rates correlate with organic food sales" (organic food causes autism?)
- "Violent crime correlates with ice cream sales" (ice cream causes crime?)

The ice cream one is instructive: both increase in summer. Temperature is the confounding variable. Remove that, and the correlation disappears.

## How to Report Correlations Responsibly

Your colleague wants to write: "Money buys happiness, study shows."

Here's a better approach:

> **Wealth Linked to Happiness, But Relationship Complex**
>
> Countries with higher GDP per capita show significantly higher happiness scores (r = 0.78, p < 0.001) in the 2023 World Happiness Report, though the relationship isn't purely linear or deterministic.
>
> "While wealth correlates with life satisfaction, it's difficult to isolate cause and effect," said Dr. Jane Smith, an economist at State University not involved in the research. "Wealthy countries also tend to have better healthcare, stronger social safety nets, and more political freedom—all of which independently correlate with happiness."
>
> The data shows diminishing returns: once countries reach a certain income threshold, additional wealth corresponds with smaller happiness gains. And outliers exist—some relatively poor countries score high on happiness, while some wealthy nations score lower than expected.
>
> Social support networks showed an equally strong correlation with happiness as GDP, suggesting community bonds may matter as much as material wealth.

Notice what this reporting does:
- States the correlation precisely (r = 0.78, p < 0.001)
- Uses careful language ("correlates," "linked," "associated")—never "causes"
- Quotes an expert for context
- Acknowledges complexity and confounding factors
- Notes outliers and non-linearities
- Compares multiple factors

## Common Pitfalls

**Don't cherry-pick**. If you test 100 correlations and report only the significant ones, you're misleading readers. By chance alone, 5% of tests will appear significant at p < 0.05.

**Don't ignore outliers**. Those weird points might be data errors—or they might be the most interesting part of the story.

**Don't forget sample size**. A correlation of 0.8 sounds impressive until you learn n=10. Small samples produce unreliable correlations.

**Don't assume linearity**. Correlation measures straight-line relationships. If the relationship is curved, correlation will underestimate its strength.

**Don't ignore subject matter expertise**. A correlation between ice cream and drowning might sound plausible until a domain expert says "obviously that's summer confounding."

## When Correlation IS the Story

Sometimes the lack of correlation is news:

> **Study Finds No Link Between Video Game Violence and Aggression**
>
> Despite widespread concerns, a comprehensive meta-analysis of 50 studies found no significant correlation between playing violent video games and real-world aggressive behavior (r = 0.08, p = 0.23).

Or sometimes an unexpected correlation demands explanation:

> **Test Scores Decline Despite Rising School Spending**
>
> An analysis of 500 school districts shows a slight negative correlation (r = -0.15, p < 0.05) between per-pupil spending and standardized test scores, challenging assumptions that more funding automatically improves outcomes. Education researchers say the finding highlights the importance of how money is spent, not just how much is spent.

## The Bottom Line

Correlation is a powerful tool for discovering relationships. It tells you where to look for stories. But it can't tell you what causes what.

When you find a strong correlation:
1. Visualize it (always make a scatter plot)
2. Check significance (is p < 0.05?)
3. Look for confounders (what else might explain this?)
4. Search for outliers (they're often the most interesting cases)
5. Talk to experts (they can spot spurious relationships)
6. Write carefully (never imply causation without experimental evidence)

Your colleague's piece about GDP and happiness? Go ahead and write it. But frame it as an association that raises questions rather than a proof of causation. That's honest reporting. That's responsible statistics.

And that's what separates good data journalism from clickbait.

## Your Turn

Using the happiness data:

1. Which two factors (other than happiness itself) have the strongest correlation? Does that correlation make intuitive sense?

2. Find a country that's an outlier on the GDP-happiness plot. Research that country. Can you find factors that might explain why it deviates from the pattern?

3. Create your own scatter plot for any two variables. Describe what story the visualization tells.

Correlation is your tool for finding patterns. In the next chapter, we'll learn regression—which lets us quantify those patterns and make predictions. It's correlation's more sophisticated sibling.
