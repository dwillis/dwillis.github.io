[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Sports Data Analysis and Visualization",
    "section": "",
    "text": "1 Throwing cold water on hot takes\nWhy do teams struggle? There are lots of potential reasons: injuries, athletes in the wrong position, poor execution. Or it could be external factors: well-prepared opponents, the weather, the altitude or, of course, the refs.\nYou could turn the question around: why do teams succeed? Again, there are plenty of possibilities that get tossed around on talk radio, on the sports pages and across social media. A lot of hot takes.\nThe more fundamental question that this course will empower you to answer is this: what do teams and athletes do? Using data, you’ll learn to ask questions and visualize the answers, ranging across sports and scenarios. What did the 2021-22 Maryland men’s lacrosse team do well en route to the national championship? How has the transfer portal (and additional eligibility) changed the nature of programs? In football, do penalties have any relationship on scoring?\nTo get into these and other questions, we’ll use a lot of different tools and techniques, but this class rests on three pillars:\nDo you need to be a math whiz to read this book? No. I’m not one either. What we’re going to look at is pretty basic, but that’s also why it’s so powerful.\nDo you need to be a computer science major to write code? Nope. I’m not one of those either. But anyone can think logically, and write simple code that is repeatable and replicable.\nDo you need to be an artist to create compelling visuals? I think you see where this is going. No. I can barely draw stick figures, but I’ve been paid to make graphics in my career. With a little graphic design know how, you can create publication worthy graphics with code.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Throwing cold water on hot takes</span>"
    ]
  },
  {
    "objectID": "index.html#requirements-and-conventions",
    "href": "index.html#requirements-and-conventions",
    "title": "Sports Data Analysis and Visualization",
    "section": "1.1 Requirements and Conventions",
    "text": "1.1 Requirements and Conventions\nThis book is all in the R statistical language. To follow along, you’ll do the following:\n\nInstall the R language on your computer. Go to the R Project website, click download R and select a mirror closest to your location. Then download the version for your computer.\nInstall RStudio Desktop. The free version is great.\n\nGoing forward, you’ll see passages like this:\n\ninstall.packages(\"tidyverse\")\n\nDon’t do it now, but that is code that you’ll need to run in your RStudio. When you see that, you’ll know what to do: click the green arrow.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Throwing cold water on hot takes</span>"
    ]
  },
  {
    "objectID": "index.html#about-this-book",
    "href": "index.html#about-this-book",
    "title": "Sports Data Analysis and Visualization",
    "section": "1.2 About this book",
    "text": "1.2 About this book\nThis book is the collection of class materials for the Fall 2024 JOUR479X course in the Philip Merrill College of Journalism at the University of Maryland. There’s some things you should know about it:\n\nIt is free for students.\nThe topics will remain the same but the text is going to be constantly tinkered with.\nWhat is the work of the author is copyright Derek Willis 2024 & Matt Waite 2019-2023.\nThe text is Attribution-NonCommercial-ShareAlike 4.0 International Creative Commons licensed. That means you can share it and change it, but only if you share your changes with the same license and it cannot be used for commercial purposes. I’m not making money on this so you can’t either.\nAs such, the whole book – authored in Quarto – is open sourced on Github. Pull requests welcomed!",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Throwing cold water on hot takes</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "2  The very basics",
    "section": "",
    "text": "2.1 Adding libraries, part 1\nThe real strength of any given programming language is the external libraries that power it. The base language can do a lot, but it’s the external libraries that solve many specific problems – even making the base language easier to use.\nFor this class, we’re going to need several external libraries.\nThe first library we’re going to use is called Swirl. So in the console, type install.packages('swirl') and hit enter. That installs swirl.\nNow, to use the library, type library(swirl) and hit enter. That loads swirl. Then type swirl() and hit enter. Now you’re running swirl. Follow the directions on the screen. When you are asked, you want to install course 1 R Programming: The basics of programming in R. Then, when asked, you want to do option 1, R Programming, in that course.\nWhen you are finished with the course – it will take just a few minutes – it will first ask you if you want credit on Coursera. You do not. Then type 0 to exit (it will not be very clear that’s what you do when you are done).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The very basics</span>"
    ]
  },
  {
    "objectID": "intro.html#adding-libraries-part-2",
    "href": "intro.html#adding-libraries-part-2",
    "title": "2  The very basics",
    "section": "2.2 Adding libraries, part 2",
    "text": "2.2 Adding libraries, part 2\nWe’ll mostly use two libraries for analysis – dplyr and ggplot2. To get them, and several other useful libraries, we can install a single collection of libraries called the tidyverse. Type this into your console: install.packages('tidyverse')\nNOTE: This is a pattern. You should always install libraries in the console.\nThen, to help us with learning and replication, we’re going to use R Notebooks. So we need to install that library. Type this into your console: install.packages('rmarkdown')",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The very basics</span>"
    ]
  },
  {
    "objectID": "intro.html#notebooks",
    "href": "intro.html#notebooks",
    "title": "2  The very basics",
    "section": "2.3 Notebooks",
    "text": "2.3 Notebooks\nFor the rest of the class, we’re going to be working in notebooks. In notebooks, you will both run your code and explain each step, much as I am doing here.\nTo start a notebook, you click on the green plus in the top left corner and go down to R Notebook. Do that now.\n\n\n\n\n\n\n\n\n\nYou will see that the notebook adds a lot of text for you. It tells you how to work in notebooks – and you should read it. The most important parts are these:\nTo add text, simply type. To add code you can click on the Insert button on the toolbar or by pressing Cmd+Option+I on Mac or Ctl+Alt+I on Windows.\nHighlight all that text and delete it. You should have a blank document. This document is called a R Markdown file – it’s a special form of text, one that you can style, and one you can include R in the middle of it. Markdown is a simple markup format that you can use to create documents. So first things first, let’s give our notebook a big headline. Add this:\n# My awesome notebook\nNow, under that, without any markup, just type This is my awesome notebook.\nUnder that, you can make text bold by writing It is **really** awesome.\nIf you want it italics, just do this on the next line: No, it's _really_ awesome. I swear.\nTo see what it looks like without the markup, click the Preview or Knit button in the toolbar. That will turn your notebook into a webpage, with the formatting included.\nThroughout this book, we’re going to use this markdown to explain what we are doing and, more importantly, why we are doing it. Explaining your thinking is a vital part of understanding what you are doing.\nThat explaination, plus the code, is the real power of notebooks. To add a block of code, follow the instructions from above: click on the Insert button on the toolbar or by pressing Cmd+Option+I on Mac or Ctl+Alt+I on Windows.\nIn that window, use some of the code from above and add two numbers together. To see it run, click the green triangle on the right. That runs the chunk. You should see the answer to your addition problem.\nAnd that, just that, is the foundation you need to start this book.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>The very basics</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "3  Data, structures and types",
    "section": "",
    "text": "3.1 Rows and columns\nData, oversimplifying it a bit, is information organized. Generally speaking, it’s organized into rows and columns. Rows, generally, are individual elements. A team. A player. A game. Columns, generally, are components of the data, sometimes called variables. So if each row is a player, the first column might be their name. The second is their position. The third is their batting average. And so on.\nOne of the critical components of data analysis, especially for beginners, is having a mental picture of your data. What does each row mean? What does each column in each row signify? How many rows do you have? How many columns?",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data, structures and types</span>"
    ]
  },
  {
    "objectID": "data.html#types",
    "href": "data.html#types",
    "title": "3  Data, structures and types",
    "section": "3.2 Types",
    "text": "3.2 Types\nThere are scores of data types in the world, and R has them. In this class, we’re primarily going to be dealing with data frames, and each element of our data frames will have a data type.\nTypically, they’ll be one of four types of data:\n\nNumeric: a number, like the number of touchdown passes in a season or a batting average.\nCharacter: Text, like a name, a team, a conference.\nDate: Fully formed dates – 2019-01-01 – have a special date type. Elements of a date, like a year (ex. 2019) are not technically dates, so they’ll appear as numeric data types.\nLogical: Rare, but every now and then we’ll have a data type that’s Yes or No, True or False, etc.\n\nQuestion: Is a zip code a number? Is a jersey number a number? Trick question, because the answer is no. Numbers are things we do math on. If the thing you want is not something you’re going to do math on – can you add two phone numbers together? – then make it a character type. If you don’t, most every software system on the planet will drop leading zeros. For example, every zip code in Boston starts with 0. If you record that as a number, your zip code will become a four digit number, which isn’t a zip code anymore.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data, structures and types</span>"
    ]
  },
  {
    "objectID": "data.html#a-simple-way-to-get-data",
    "href": "data.html#a-simple-way-to-get-data",
    "title": "3  Data, structures and types",
    "section": "3.3 A simple way to get data",
    "text": "3.3 A simple way to get data\nOne good thing about sports is that there’s lots of interest in it. And that means there’s outlets that put sports data on the internet. Now I’m going to show you a trick to getting it easily.\nThe site sports-reference.com takes NCAA (and other league) stats and puts them online. For instance, here’s their page on Maryland’s men’s basketball’s game logs, which you should open now.\nNow, in a new tab, log into Google Docs/Drive and open a new spreadsheet (type sheet.new in the url bar). In the first cell of the first row, copy and paste this formula in:\n=IMPORTHTML(\"https://www.sports-reference.com/cbb/schools/maryland/2023-gamelogs.html\", \"table\", 1)\nIf it worked right, you’ve got the data from that page in a spreadsheet.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data, structures and types</span>"
    ]
  },
  {
    "objectID": "data.html#cleaning-the-data",
    "href": "data.html#cleaning-the-data",
    "title": "3  Data, structures and types",
    "section": "3.4 Cleaning the data",
    "text": "3.4 Cleaning the data\nThe first thing we need to do is recognize that we don’t have data, really. We have the results of a formula. You can tell by putting your cursor on that field, where you’ll see the formula again. This is where you’d look:\n\n\n\n\n\n\n\n\n\nThe solution is easy:\nEdit &gt; Select All or type command/control A Edit &gt; Copy or type command/control c Edit &gt; Paste Special &gt; Values Only or type command/control shift v\nYou can verify that it worked by looking in that same row 1 column A, where you’ll see the formula is gone.\n\n\n\n\n\n\n\n\n\nNow you have data, but your headers are all wrong. You want your headers to be one line – not two, like they have. And the header names repeat – first for our team, then for theirs. So you have to change each header name to be UsORB or TeamORB and OpponentORB instead of just ORB.\nAfter you’ve done that, note we have repeating headers. There’s two ways to deal with that – you could just hightlight it and go up to Edit &gt; Delete Rows XX-XX depending on what rows you highlighted. That’s the easy way with our data.\nBut what if you had hundreds of repeating headers like that? Deleting them would take a long time.\nYou can use sorting to get rid of anything that’s not data. So click on Data &gt; Sort Range. You’ll want to check the “Data has header row” field. Then hit Sort.\n\n\n\n\n\n\n\n\n\nNow all you need to do is search through the data for where your junk data – extra headers, blanks, etc. – got sorted and delete it. After you’ve done that, you can export it for use in R. Go to File &gt; Download as &gt; Comma Separated Values. Remember to put it in the same directory as your R Notebook file so you can import the data easily.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data, structures and types</span>"
    ]
  },
  {
    "objectID": "aggregates.html",
    "href": "aggregates.html",
    "title": "4  Aggregates",
    "section": "",
    "text": "4.1 Basic data analysis: Group By and Count\nThe first thing we need to do is get some data to work with. We do that by reading it in. In our case, we’re going to read data from a csv file – a comma-separated values file.\nThe CSV file we’re going to read from is a Basketball Reference page of advanced metrics for NBA players this past season. The Sports Reference sites are a godsend of data, a trove of stuff, and we’re going to use it a lot in this class.\nSo step 2, after setting up our libraries, is most often going to be importing data. In order to analyze data, we need data, so it stands to reason that this would be something we’d do very early.\nThe code looks something like this, but hold off copying it just yet:\nnbaplayers &lt;- read_csv(\"~/SportsData/nbaadvancedplayers2223.csv\")\nLet’s unpack that.\nThe first part – nbaplayers – is the name of your variable. A variable is just a name of a thing that stores stuff. In this case, our variable is a data frame, which is R’s way of storing data (technically it’s a tibble, which is the tidyverse way of storing data, but the differences aren’t important and people use them interchangeably). We can call this whatever we want. I always want to name data frames after what is in it. In this case, we’re going to import a dataset of NBA players. Variable names, by convention are one word all lower case. You can end a variable with a number, but you can’t start one with a number.\nThe &lt;- bit is the variable assignment operator. It’s how we know we’re assigning something to a word. Think of the arrow as saying “Take everything on the right of this arrow and stuff it into the thing on the left.” So we’re creating an empty vessel called nbaplayers and stuffing all this data into it.\nThe read_csv bits are pretty obvious, except for one thing. What happens in the quote marks is the path to the data. In there, I have to tell R where it will find the data. The easiest thing to do, if you are confused about how to find your data, is to put your data in the same folder as as your notebook (you’ll have to save that notebook first). If you do that, then you just need to put the name of the file in there (nbaadvancedplayers2122.csv). In my case, in my home directory (that’s the ~ part), there is a folder called SportsData that has the file called nbaadvancedplayers2122.csv in it. Some people – insane people – leave the data in their downloads folder. The data path then would be ~/Downloads/nameofthedatafilehere.csv on PC or Mac.\nWhat you put in there will be different from mine. So your first task is to import the data.\nnbaplayers &lt;- read_csv(\"data/nbaadvancedplayers2324.csv\")\n\nRows: 735 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (3): Player, Pos, Tm\ndbl (24): Rk, Age, G, MP, PER, TS%, 3PAr, FTr, ORB%, DRB%, TRB%, AST%, STL%,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nNow we can inspect the data we imported. What does it look like? To do that, we use head(nbaplayers) to show the headers and the first six rows of data. If we wanted to see them all, we could just simply enter nbaplayers and run it.\nTo get the number of records in our dataset, we run nrow(nbaplayers)\nhead(nbaplayers)\n\n# A tibble: 6 × 27\n     Rk Player     Pos     Age Tm        G    MP   PER `TS%` `3PAr`   FTr `ORB%`\n  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1     1 Precious … PF-C     24 TOT      74  1624  14.6 0.545  0.207 0.239   13  \n2     1 Precious … C        24 TOR      25   437  15   0.512  0.276 0.247   12.3\n3     1 Precious … PF       24 NYK      49  1187  14.5 0.564  0.167 0.234   13.3\n4     2 Bam Adeba… C        26 MIA      71  2416  19.8 0.576  0.041 0.381    7.4\n5     3 Ochai Agb… SG       23 TOT      78  1641   7.7 0.497  0.487 0.129    4.9\n6     3 Ochai Agb… SG       23 UTA      51  1003   8.1 0.531  0.57  0.08     3.9\n# … with 15 more variables: `DRB%` &lt;dbl&gt;, `TRB%` &lt;dbl&gt;, `AST%` &lt;dbl&gt;,\n#   `STL%` &lt;dbl&gt;, `BLK%` &lt;dbl&gt;, `TOV%` &lt;dbl&gt;, `USG%` &lt;dbl&gt;, OWS &lt;dbl&gt;,\n#   DWS &lt;dbl&gt;, WS &lt;dbl&gt;, `WS/48` &lt;dbl&gt;, OBPM &lt;dbl&gt;, DBPM &lt;dbl&gt;, BPM &lt;dbl&gt;,\n#   VORP &lt;dbl&gt;\nnrow(nbaplayers)\n\n[1] 735\nAnother way to look at nrow – we have 735 players from this season in our dataset.\nWhat if we wanted to know how many players there were by position? To do that by hand, we’d have to take each of the 651 records and sort them into a pile. We’d put them in groups and then count them.\ndplyr has a group by function in it that does just this. A massive amount of data analysis involves grouping like things together at some point. So it’s a good place to start.\nSo to do this, we’ll take our dataset and we’ll introduce a new operator: |&gt;. The best way to read that operator, in my opinion, is to interpret that as “and then do this.”\nAfter we group them together, we need to count them. We do that first by saying we want to summarize our data (a count is a part of a summary). To get a summary, we have to tell it what we want. So in this case, we want a count. To get that, let’s create a thing called total and set it equal to n(), which is dplyrs way of counting something.\nHere’s the code:\nnbaplayers |&gt; \n  group_by(Pos) |&gt;\n  summarise(\n    total = n()\n  )\n\n# A tibble: 12 × 2\n   Pos   total\n   &lt;chr&gt; &lt;int&gt;\n 1 C       119\n 2 C-PF      3\n 3 PF      147\n 4 PF-C      1\n 5 PF-SF     1\n 6 PG      147\n 7 PG-SG     4\n 8 SF      155\n 9 SF-PF     2\n10 SF-SG     1\n11 SG      154\n12 SG-PG     1\nSo let’s walk through that. We start with our dataset – nbaplayers – and then we tell it to group the data by a given field in the data which we get by looking at either the output of head or you can look in the environment where you’ll see nbaplayers.\nIn this case, we wanted to group together positions, signified by the field name Pos. After we group the data, we need to count them up. In dplyr, we use summarize which can do more than just count things. Inside the parentheses in summarize, we set up the summaries we want. In this case, we just want a count of the positions: total = n(), says create a new field, called total and set it equal to n(), which might look weird, but it’s common in stats. The number of things in a dataset? Statisticians call in n. There are n number of players in this dataset. So n() is a function that counts the number of things there are.\nAnd when we run that, we get a list of positions with a count next to them. But it’s not in any order. So we’ll add another And Then Do This |&gt; and use arrange. Arrange does what you think it does – it arranges data in order. By default, it’s in ascending order – smallest to largest. But if we want to know the position with the most players, we need to sort it in descending order. That looks like this:\nnbaplayers |&gt;\n  group_by(Pos) |&gt;\n  summarise(\n    total = n()\n  ) |&gt; arrange(desc(total))\n\n# A tibble: 12 × 2\n   Pos   total\n   &lt;chr&gt; &lt;int&gt;\n 1 SF      155\n 2 SG      154\n 3 PF      147\n 4 PG      147\n 5 C       119\n 6 PG-SG     4\n 7 C-PF      3\n 8 SF-PF     2\n 9 PF-C      1\n10 PF-SF     1\n11 SF-SG     1\n12 SG-PG     1\nSo the most common position in the NBA? Small forward, followed by shooting guard.\nWe can, if we want, group by more than one thing. Which team has the most of a single position? To do that, we can group by the team – called Tm in the data – and position, or Pos in the data:\nnbaplayers |&gt;\n  group_by(Tm, Pos) |&gt;\n  summarise(\n    total = n()\n  ) |&gt; arrange(desc(total))\n\n`summarise()` has grouped output by 'Tm'. You can override using the `.groups`\nargument.\n\n\n# A tibble: 162 × 3\n# Groups:   Tm [31]\n   Tm    Pos   total\n   &lt;chr&gt; &lt;chr&gt; &lt;int&gt;\n 1 TOT   PG       18\n 2 TOT   PF       15\n 3 TOT   SF       14\n 4 DET   SG       10\n 5 TOT   C        10\n 6 MEM   PF        9\n 7 NYK   SG        9\n 8 TOR   SG        9\n 9 TOT   SG        8\n10 CHO   PG        7\n# … with 152 more rows\nSo wait, what team is TOT?\nValuable lesson: whoever collects the data has opinions on how to solve problems. In this case, Basketball Reference, when a player get’s traded, records stats for the player’s first team, their second team, and a combined season total for a team called TOT, meaning Total. Is there a team abbreviated TOT? No. So ignore them here.\nDetroit had 10 shooting guards! You can learn a bit about how a team is assembled by looking at these simple counts.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Aggregates</span>"
    ]
  },
  {
    "objectID": "aggregates.html#basic-data-analysis-group-by-and-count",
    "href": "aggregates.html#basic-data-analysis-group-by-and-count",
    "title": "4  Aggregates",
    "section": "",
    "text": "For this walkthrough:\n   Download csv file",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Aggregates</span>"
    ]
  },
  {
    "objectID": "aggregates.html#other-aggregates-mean-and-median",
    "href": "aggregates.html#other-aggregates-mean-and-median",
    "title": "4  Aggregates",
    "section": "4.2 Other aggregates: Mean and median",
    "text": "4.2 Other aggregates: Mean and median\nIn the last example, we grouped some data together and counted it up, but there’s so much more you can do. You can do multiple measures in a single step as well.\nSticking with our NBA player data, we can calculate any number of measures inside summarize. Here, we’ll use R’s built in mean and median functions to calculate … well, you get the idea.\nLet’s look just a the number of minutes each position gets.\n\nnbaplayers |&gt;\n  group_by(Pos) |&gt;\n  summarise(\n    count = n(),\n    mean_minutes = mean(MP),\n    median_minutes = median(MP)\n  )\n\n# A tibble: 12 × 4\n   Pos   count mean_minutes median_minutes\n   &lt;chr&gt; &lt;int&gt;        &lt;dbl&gt;          &lt;dbl&gt;\n 1 C       119         930.           763 \n 2 C-PF      3        1115.           974 \n 3 PF      147         879.           581 \n 4 PF-C      1        1624           1624 \n 5 PF-SF     1         630            630 \n 6 PG      147         905.           678 \n 7 PG-SG     4        1581           1926.\n 8 SF      155         912.           608 \n 9 SF-PF     2         983            983 \n10 SF-SG     1        2160           2160 \n11 SG      154         887.           700.\n12 SG-PG     1         507            507 \n\n\nLet’s look at centers. The average center plays 929 minutes and the median is 763 minutes.\nWhy?\nLet’s let sort help us.\n\nnbaplayers |&gt; arrange(desc(MP))\n\n# A tibble: 735 × 27\n      Rk Player    Pos     Age Tm        G    MP   PER `TS%` `3PAr`   FTr `ORB%`\n   &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n 1   120 DeMar De… SF       34 CHI      79  2989  19.7 0.584  0.166 0.452    1.6\n 2   444 Domantas… C        27 SAC      82  2928  23.2 0.637  0.081 0.389   11  \n 3   540 Coby Whi… PG       23 CHI      79  2881  14.5 0.57   0.46  0.215    1.7\n 4    61 Mikal Br… SF       27 BRK      82  2854  14.9 0.56   0.457 0.245    2.5\n 5    25 Paolo Ba… PF       21 ORL      80  2799  17.3 0.546  0.249 0.397    3.4\n 6   137 Kevin Du… PF       35 PHO      75  2791  21.2 0.626  0.283 0.295    1.7\n 7   363 Dejounte… SG       27 ATL      78  2783  17.7 0.555  0.379 0.179    2.3\n 8   140 Anthony … SG       22 MIN      79  2770  19.7 0.575  0.341 0.325    2.2\n 9   263 Nikola J… C        28 DEN      79  2737  31   0.65   0.164 0.31     9.3\n10    76 Jalen Br… PG       27 NYK      77  2726  23.4 0.592  0.319 0.302    1.8\n# … with 725 more rows, and 15 more variables: `DRB%` &lt;dbl&gt;, `TRB%` &lt;dbl&gt;,\n#   `AST%` &lt;dbl&gt;, `STL%` &lt;dbl&gt;, `BLK%` &lt;dbl&gt;, `TOV%` &lt;dbl&gt;, `USG%` &lt;dbl&gt;,\n#   OWS &lt;dbl&gt;, DWS &lt;dbl&gt;, WS &lt;dbl&gt;, `WS/48` &lt;dbl&gt;, OBPM &lt;dbl&gt;, DBPM &lt;dbl&gt;,\n#   BPM &lt;dbl&gt;, VORP &lt;dbl&gt;\n\n\nThe player with the most minutes on the floor is a small forward. So that means there’s DeMar DeRozan rolling up 2,989 minutes in a season, and then there’s Philly sensation Javonte Smart. Never heard of Javonte Smart? Might be because he logged a single minute in one game this season.\nThat’s a huge difference.\nSo when choosing a measure of the middle, you have to ask yourself – could I have extremes? Because a median won’t be sensitive to extremes. It will be the point at which half the numbers are above and half are below. The average or mean will be a measure of the middle, but if you have a bunch of pine riders and then one ironman superstar, the average will be wildly skewed.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Aggregates</span>"
    ]
  },
  {
    "objectID": "aggregates.html#even-more-aggregates",
    "href": "aggregates.html#even-more-aggregates",
    "title": "4  Aggregates",
    "section": "4.3 Even more aggregates",
    "text": "4.3 Even more aggregates\nThere’s a ton of things we can do in summarize – we’ll work with more of them as the course progresses – but here’s a few other questions you can ask.\nWhich position in the NBA plays the most minutes? And what is the highest and lowest minute total for that position? And how wide is the spread between minutes? We can find that with sum to add up the minutes to get the total minutes, min to find the minimum minutes, max to find the maximum minutes and sd to find the standard deviation in the numbers.\n\nnbaplayers |&gt; \n  group_by(Pos) |&gt; \n  summarise(\n    total = sum(MP), \n    avgminutes = mean(MP), \n    minminutes = min(MP),\n    maxminutes = max(MP),\n    stdev = sd(MP)) |&gt; arrange(desc(total))\n\n# A tibble: 12 × 6\n   Pos    total avgminutes minminutes maxminutes stdev\n   &lt;chr&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;\n 1 SF    141284       912.          1       2989  832.\n 2 SG    136539       887.          3       2783  807.\n 3 PG    132967       905.          1       2881  820.\n 4 PF    129198       879.          4       2799  815.\n 5 C     110659       930.          1       2928  781.\n 6 PG-SG   6324      1581         433       2040  769.\n 7 C-PF    3344      1115.        555       1815  642.\n 8 SF-SG   2160      2160        2160       2160   NA \n 9 SF-PF   1966       983         488       1478  700.\n10 PF-C    1624      1624        1624       1624   NA \n11 PF-SF    630       630         630        630   NA \n12 SG-PG    507       507         507        507   NA \n\n\nSo again, no surprise, small forwards spend the most minutes on the floor in the NBA. They average 911 minutes, but we noted why that’s trouble. The minimum is a one-minute wonder, max is some team failing at load management, and the standard deviation is a measure of how spread out the data is. In this case, not the highest spread among positions, but pretty high. So you know you’ve got some huge minutes players and a bunch of bench players.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Aggregates</span>"
    ]
  },
  {
    "objectID": "mutating.html",
    "href": "mutating.html",
    "title": "5  Mutating data",
    "section": "",
    "text": "5.1 A more complex example\nThere’s metric in basketball that’s easy to understand – shooting percentage. It’s the number of shots made divided by the number of shots attempted. Simple, right? Except it’s a little too simple. Because what about three point shooters? They tend to be more vailable because the three point shot is worth more. What about players who get to the line? In shooting percentage, free throws are nowhere to be found.\nBasketball nerds, because of these weaknesses, have created a new metric called True Shooting Percentage. True shooting percentage takes into account all aspects of a players shooting to determine who the real shooters are.\nUsing dplyr and mutate, we can calculate true shooting percentage. So let’s look at a new dataset, one of every college basketball player’s season stats in 2023-24 season. It’s a dataset of 5,688 players, and we’ve got 59 variables – one of them is True Shooting Percentage, but we’re going to ignore that.\nImport it like this:\nplayers &lt;- read_csv(\"data/players24.csv\")\n\nRows: 5678 Columns: 59\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (10): Team, Player, Class, Pos, Height, Hometown, High School, Summary, ...\ndbl (49): #, Weight, Rk.x, G, GS, MP, FG, FGA, FG%, 2P, 2PA, 2P%, 3P, 3PA, 3...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nThe basic true shooting percentage formula is (Points / (2*(FieldGoalAttempts + (.44 * FreeThrowAttempts)))) * 100. Let’s talk that through. Points divided by a lot. It’s really field goal attempts plus 44 percent of the free throw attempts. Why? Because that’s about what a free throw is worth, compared to other ways to score. After adding those things together, you double it. And after you divide points by that number, you multiply the whole lot by 100.\nIn our data, we need to be able to find the fields so we can complete the formula. To do that, one way is to use the Environment tab in R Studio. In the Environment tab is a listing of all the data you’ve imported, and if you click the triangle next to it, it’ll list all the field names, giving you a bit of information about each one.\nSo what does True Shooting Percentage look like in code?\nLet’s think about this differently. Who had the best true shooting season last year?\nplayers |&gt;\n  mutate(trueshooting = (PTS/(2*(FGA + (.44*FTA))))*100) |&gt;\n  arrange(desc(trueshooting))\n\n# A tibble: 5,678 × 60\n   Team     Player   `#` Class Pos   Height Weight Homet…¹ High …² Summary  Rk.x\n   &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;\n 1 Winthro… Henry…    21 FR    G     5-11      175 Lewisb… Lewisb… 1.3 Pt…    14\n 2 Tenness… D.J. …    44 FR    G     6-5       207 Ricahr… Minnes… 3.0 Pt…    13\n 3 San Jos… Benne…    24 FR    G     6-0       180 Austin… L.C. A… 1.2 Pt…    13\n 4 Richmon… Liam …    10 JR    G     6-2       190 Kansas… Pembro… 1.0 Pt…    12\n 5 Niagara… Jalen…    10 SO    G     5-10      160 Chicag… De La … 0.6 Pt…    12\n 6 Nevada … Isaac…    24 FR    F     6-8       195 Phoeni… Hillcr… 3.0 Pt…    13\n 7 Georget… Austi…     4 SO    F     6-4       180 Hoover… Hoover… 1.0 Pt…    11\n 8 Florida… Renat…    15 JR    G     6-1       180 Planta… Americ… 3.0 Pt…    15\n 9 Florida… Adefe…    22 FR    G     6-1       160 Mirama… Norlan… 1.5 Pt…    16\n10 Dayton … Attic…    54 SO    G     6-6       190 Wester… St. Fr… 0.4 Pt…    12\n# … with 5,668 more rows, 49 more variables: G &lt;dbl&gt;, GS &lt;dbl&gt;, MP &lt;dbl&gt;,\n#   FG &lt;dbl&gt;, FGA &lt;dbl&gt;, `FG%` &lt;dbl&gt;, `2P` &lt;dbl&gt;, `2PA` &lt;dbl&gt;, `2P%` &lt;dbl&gt;,\n#   `3P` &lt;dbl&gt;, `3PA` &lt;dbl&gt;, `3P%` &lt;dbl&gt;, FT &lt;dbl&gt;, FTA &lt;dbl&gt;, `FT%` &lt;dbl&gt;,\n#   ORB &lt;dbl&gt;, DRB &lt;dbl&gt;, TRB &lt;dbl&gt;, AST &lt;dbl&gt;, STL &lt;dbl&gt;, BLK &lt;dbl&gt;,\n#   TOV &lt;dbl&gt;, PF &lt;dbl&gt;, PTS &lt;dbl&gt;, Rk.y &lt;dbl&gt;, PER &lt;dbl&gt;, `TS%` &lt;dbl&gt;,\n#   `eFG%` &lt;dbl&gt;, `3PAr` &lt;dbl&gt;, FTr &lt;dbl&gt;, PProd &lt;dbl&gt;, `ORB%` &lt;dbl&gt;,\n#   `DRB%` &lt;dbl&gt;, `TRB%` &lt;dbl&gt;, `AST%` &lt;dbl&gt;, `STL%` &lt;dbl&gt;, `BLK%` &lt;dbl&gt;, …\nYou’ll be forgiven if you did not hear about Winthrop’s shooting sensation Henry Harrison. He played in seven games, took three shots and actually hit them all. They all happened to be three pointers, which is three more three pointer than I’ve hit in college basketball. So props to him. Does that mean he had the best true shooting season in college basketball in the 2023-24 season?\nNot hardly.\nWe’ll talk about how to narrow the pile and filter out data in the next chapter.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Mutating data</span>"
    ]
  },
  {
    "objectID": "mutating.html#a-more-complex-example",
    "href": "mutating.html#a-more-complex-example",
    "title": "5  Mutating data",
    "section": "",
    "text": "For this walkthrough:\n   Download csv file",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Mutating data</span>"
    ]
  },
  {
    "objectID": "filtering.html",
    "href": "filtering.html",
    "title": "6  Filters and selections",
    "section": "",
    "text": "6.1 Selecting data to make it easier to read\nSo now we have our Power Five list. What if we just wanted to see attendance from the most recent season and ignore all the rest? Select to the rescue.\nattendance |&gt; filter(Conference %in% powerfive) |&gt; select(Institution, Conference, `2022`)\n\n# A tibble: 65 × 3\n   Institution    Conference `2022`\n   &lt;chr&gt;          &lt;chr&gt;       &lt;dbl&gt;\n 1 Alabama        SEC        692870\n 2 Arizona        Pac-12     309465\n 3 Arizona St.    Pac-12     258488\n 4 Arkansas       SEC        512087\n 5 Auburn         SEC        681621\n 6 Baylor         Big 12     272779\n 7 Boston College ACC        214233\n 8 California     Pac-12     270172\n 9 Clemson        ACC        564860\n10 Colorado       Pac-12     257084\n# … with 55 more rows\nIf you have truly massive data, Select has tools to help you select fields that start_with the same things or ends with a certain word. The documentation will guide you if you need those someday. For 90 plus percent of what we do, just naming the fields will be sufficient.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Filters and selections</span>"
    ]
  },
  {
    "objectID": "filtering.html#using-conditional-filters-to-set-limits",
    "href": "filtering.html#using-conditional-filters-to-set-limits",
    "title": "6  Filters and selections",
    "section": "6.2 Using conditional filters to set limits",
    "text": "6.2 Using conditional filters to set limits\nLet’s return to the problem of one-hit wonders in basketball mucking up our true shooting analysis. How can we set limits in something like a question of who had the best season? Let’s grab every player from last season.\nFor this walkthrough:\n   Download csv file\n\nLet’s get set up similar to the previous chapter.\n\nplayers &lt;- read_csv(\"data/players24.csv\")\n\nRows: 5678 Columns: 59\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (10): Team, Player, Class, Pos, Height, Hometown, High School, Summary, ...\ndbl (49): #, Weight, Rk.x, G, GS, MP, FG, FGA, FG%, 2P, 2PA, 2P%, 3P, 3PA, 3...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nplayers |&gt;\n  mutate(trueshooting = (PTS/(2*(FGA + (.44*FTA))))*100) |&gt;\n  arrange(desc(trueshooting))\n\n# A tibble: 5,678 × 60\n   Team     Player   `#` Class Pos   Height Weight Homet…¹ High …² Summary  Rk.x\n   &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;\n 1 Winthro… Henry…    21 FR    G     5-11      175 Lewisb… Lewisb… 1.3 Pt…    14\n 2 Tenness… D.J. …    44 FR    G     6-5       207 Ricahr… Minnes… 3.0 Pt…    13\n 3 San Jos… Benne…    24 FR    G     6-0       180 Austin… L.C. A… 1.2 Pt…    13\n 4 Richmon… Liam …    10 JR    G     6-2       190 Kansas… Pembro… 1.0 Pt…    12\n 5 Niagara… Jalen…    10 SO    G     5-10      160 Chicag… De La … 0.6 Pt…    12\n 6 Nevada … Isaac…    24 FR    F     6-8       195 Phoeni… Hillcr… 3.0 Pt…    13\n 7 Georget… Austi…     4 SO    F     6-4       180 Hoover… Hoover… 1.0 Pt…    11\n 8 Florida… Renat…    15 JR    G     6-1       180 Planta… Americ… 3.0 Pt…    15\n 9 Florida… Adefe…    22 FR    G     6-1       160 Mirama… Norlan… 1.5 Pt…    16\n10 Dayton … Attic…    54 SO    G     6-6       190 Wester… St. Fr… 0.4 Pt…    12\n# … with 5,668 more rows, 49 more variables: G &lt;dbl&gt;, GS &lt;dbl&gt;, MP &lt;dbl&gt;,\n#   FG &lt;dbl&gt;, FGA &lt;dbl&gt;, `FG%` &lt;dbl&gt;, `2P` &lt;dbl&gt;, `2PA` &lt;dbl&gt;, `2P%` &lt;dbl&gt;,\n#   `3P` &lt;dbl&gt;, `3PA` &lt;dbl&gt;, `3P%` &lt;dbl&gt;, FT &lt;dbl&gt;, FTA &lt;dbl&gt;, `FT%` &lt;dbl&gt;,\n#   ORB &lt;dbl&gt;, DRB &lt;dbl&gt;, TRB &lt;dbl&gt;, AST &lt;dbl&gt;, STL &lt;dbl&gt;, BLK &lt;dbl&gt;,\n#   TOV &lt;dbl&gt;, PF &lt;dbl&gt;, PTS &lt;dbl&gt;, Rk.y &lt;dbl&gt;, PER &lt;dbl&gt;, `TS%` &lt;dbl&gt;,\n#   `eFG%` &lt;dbl&gt;, `3PAr` &lt;dbl&gt;, FTr &lt;dbl&gt;, PProd &lt;dbl&gt;, `ORB%` &lt;dbl&gt;,\n#   `DRB%` &lt;dbl&gt;, `TRB%` &lt;dbl&gt;, `AST%` &lt;dbl&gt;, `STL%` &lt;dbl&gt;, `BLK%` &lt;dbl&gt;, …\n\n\nIn that season, we’ve got several players that can lay claim to the title of One Shot One Three True Shooting champion.\nIn most contests, like the batting title in Major League Baseball, there’s a minimum number of X to qualify. In baseball, it’s at bats. In basketball, it attempts. So let’s set a floor and see how it changes. What if we said you had to have played 100 minutes in a season? The top players in college basketball play more than 1000 minutes in a season. So 100 is not that much. Let’s try it and see.\n\nplayers |&gt;\n  mutate(trueshooting = (PTS/(2*(FGA + (.44*FTA))))*100) |&gt;\n  arrange(desc(trueshooting)) |&gt;\n  filter(MP &gt; 100)\n\n# A tibble: 3,820 × 60\n   Team     Player   `#` Class Pos   Height Weight Homet…¹ High …² Summary  Rk.x\n   &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;\n 1 Radford… TJ Ne…    23 SR    F     6-9       220 Burlin… Graham… 8.9 Pt…     9\n 2 UNC Wil… Khama…    21 JR    F     6-8       175 Tallah… James … 3.8 Pt…     7\n 3 Baylor … Dantw…    12 SR    G     6-2       190 Ocala,… PHS Ac… 4.7 Pt…    10\n 4 Furman … Coope…    21 FR    F     6-11      210 Woodbr… Saint … 3.9 Pt…     9\n 5 Temple … Emman…    21 JR    C     6-10      225 Jackso… Oak Hi… 0.7 Pt…    10\n 6 UNC Tar… Jalen…    13 SO    F     6-10      225 Gary, … West S… 3.9 Pt…     8\n 7 St. Bon… Noel …    20 JR    C     6-11      250 Leesbu… Flint … 6.1 Pt…     7\n 8 North D… Brian…    12 JR    F     6-9       230 Chicag… DePaul… 2.3 Pt…    10\n 9 Illinoi… Nicco…    11 FR    G     6-1       170 Bologn… DME Ac… 1.5 Pt…    11\n10 College… James…    23 FR    F     6-11      210 Fayett… E.E. S… 5.0 Pt…     7\n# … with 3,810 more rows, 49 more variables: G &lt;dbl&gt;, GS &lt;dbl&gt;, MP &lt;dbl&gt;,\n#   FG &lt;dbl&gt;, FGA &lt;dbl&gt;, `FG%` &lt;dbl&gt;, `2P` &lt;dbl&gt;, `2PA` &lt;dbl&gt;, `2P%` &lt;dbl&gt;,\n#   `3P` &lt;dbl&gt;, `3PA` &lt;dbl&gt;, `3P%` &lt;dbl&gt;, FT &lt;dbl&gt;, FTA &lt;dbl&gt;, `FT%` &lt;dbl&gt;,\n#   ORB &lt;dbl&gt;, DRB &lt;dbl&gt;, TRB &lt;dbl&gt;, AST &lt;dbl&gt;, STL &lt;dbl&gt;, BLK &lt;dbl&gt;,\n#   TOV &lt;dbl&gt;, PF &lt;dbl&gt;, PTS &lt;dbl&gt;, Rk.y &lt;dbl&gt;, PER &lt;dbl&gt;, `TS%` &lt;dbl&gt;,\n#   `eFG%` &lt;dbl&gt;, `3PAr` &lt;dbl&gt;, FTr &lt;dbl&gt;, PProd &lt;dbl&gt;, `ORB%` &lt;dbl&gt;,\n#   `DRB%` &lt;dbl&gt;, `TRB%` &lt;dbl&gt;, `AST%` &lt;dbl&gt;, `STL%` &lt;dbl&gt;, `BLK%` &lt;dbl&gt;, …\n\n\nNow you get Radford’s TJ NeSmith, who played in seven games and was on the floor for 113 minutes. So he played a little bit, but not a lot. But in that time, he only attempted 32 shots, and made 75 percent of them. In other words, when he shot, he probably scored. He just rarely shot.\nSo is 100 minutes our level? Here’s the truth – there’s not really an answer here. We’re picking a cutoff. If you can cite a reason for it and defend it, then it probably works.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Filters and selections</span>"
    ]
  },
  {
    "objectID": "filtering.html#top-list",
    "href": "filtering.html#top-list",
    "title": "6  Filters and selections",
    "section": "6.3 Top list",
    "text": "6.3 Top list\nOne last little dplyr trick that’s nice to have in the toolbox is a shortcut for selecting only the top values for your dataset. Want to make a Top 10 List? Or Top 25? Or Top Whatever You Want? It’s easy.\nSo what are the top 10 Power Five schools by season attendance. All we’re doing here is chaining commands together with what we’ve already got. We’re filtering by our list of Power Five conferences, we’re selecting the three fields we need, now we’re going to arrange it by total attendance and then we’ll introduce the new function: top_n. The top_n function just takes a number. So we want a top 10 list? We do it like this:\n\nattendance |&gt; filter(Conference %in% powerfive) |&gt; select(Institution, Conference, `2023`) |&gt; arrange(desc(`2023`)) |&gt; top_n(10)\n\nSelecting by 2023\n\n\n# A tibble: 10 × 3\n   Institution Conference `2023`\n   &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;\n 1 Michigan    Big Ten    769797\n 2 Penn St.    Big Ten    758864\n 3 Tennessee   SEC        713405\n 4 LSU         SEC        705191\n 5 Alabama     SEC        700539\n 6 Texas A&M   SEC        694639\n 7 Georgia     SEC        649222\n 8 Ohio St.    Big Ten    622753\n 9 Auburn      SEC        616301\n10 Texas       Big 12     609748\n\n\nThat’s all there is to it. Just remember – for it to work correctly, you need to sort your data BEFORE you run top_n. Otherwise, you’re just getting the first 10 values in the list. The function doesn’t know what field you want the top values of. You have to do it.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Filters and selections</span>"
    ]
  },
  {
    "objectID": "transforming.html",
    "href": "transforming.html",
    "title": "7  Transforming data",
    "section": "",
    "text": "7.1 Making long data wide\nWe can reverse this process using pivot_wider, which makes long data wide.\nWhy do any of this?\nIn some cases, you’re going to be given long data and you need to calculate some metric using two of the years – a percent change for instance. So you’ll need to make the data wide to do that. You might then have to re-lengthen the data now with the percent change. Some project require you to do all kinds of flexing like this. It just depends on the data.\nSo let’s take what we made above and turn it back into wide data.\nlongdata &lt;- attendance |&gt; pivot_longer(cols = starts_with(\"20\"), names_to = \"Year\", values_to = \"Attendance\")\n\nlongdata\n\n# A tibble: 1,606 × 4\n   Institution Conference Year  Attendance\n   &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;\n 1 Air Force   MWC        2013      228562\n 2 Air Force   MWC        2014      168967\n 3 Air Force   MWC        2015      156158\n 4 Air Force   MWC        2016      177519\n 5 Air Force   MWC        2017      174924\n 6 Air Force   MWC        2018      166205\n 7 Air Force   MWC        2019      162505\n 8 Air Force   MWC        2020        5600\n 9 Air Force   MWC        2021      136984\n10 Air Force   MWC        2022      188482\n# … with 1,596 more rows\nTo pivot_wider, we just need to say where our column names are coming from – the Year – and where the data under it should come from – Attendance.\nlongdata |&gt; pivot_wider(names_from = Year, values_from = Attendance)\n\n# A tibble: 146 × 13\n   Institution   Confe…¹ `2013` `2014` `2015` `2016` `2017` `2018` `2019` `2020`\n   &lt;chr&gt;         &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;\n 1 Air Force     MWC     228562 168967 156158 177519 174924 166205 162505   5600\n 2 Akron         MAC     107101  55019 108588  62021 117416  92575 107752     NA\n 3 Alabama       SEC     710538 710736 707786 712747 712053 710931 707817  97120\n 4 Appalachian … FBS In… 149366     NA     NA     NA     NA     NA     NA     NA\n 5 Appalachian … Sun Be…     NA 138995 128755 156916 154722 131716 166640     NA\n 6 Arizona       Pac-12  285713 354973 308355 338017 255791 318051 237194     NA\n 7 Arizona St.   Pac-12  501509 343073 368985 286417 359660 291091 344161     NA\n 8 Arkansas      SEC     431174 399124 471279 487067 442569 367748 356517  82500\n 9 Arkansas St.  Sun Be… 149477 149163 138043 136200 119538 119001 124017  24095\n10 Army West Po… FBS In… 169781 171310 185946 163267 185543 190156 185935  45548\n# … with 136 more rows, 3 more variables: `2021` &lt;dbl&gt;, `2022` &lt;dbl&gt;,\n#   `2023` &lt;dbl&gt;, and abbreviated variable name ¹​Conference\nAnd just like that, we’re back.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Transforming data</span>"
    ]
  },
  {
    "objectID": "transforming.html#why-this-matters",
    "href": "transforming.html#why-this-matters",
    "title": "7  Transforming data",
    "section": "7.2 Why this matters",
    "text": "7.2 Why this matters\nThis matters because certain visualization types need wide or long data. A significant hurdle you will face for the rest of the semester is getting the data in the right format for what you want to do.\nSo let me walk you through an example using this data.\nLet’s look at Maryland’s attendance over the time period. In order to do that, I need long data because that’s what the charting library, ggplot2, needs. You’re going to learn a lot more about ggplot later. Since this data is organized by school and conference, I also need to remove records that have no attendance data (because we have a Maryland in the ACC row).\n\nmaryland &lt;- longdata |&gt; filter(Institution == \"Maryland\") |&gt; filter(!is.na(Attendance))\n\nNow that we have long data for just Maryland, we can chart it.\n\nggplot(maryland, aes(x=Year, y=Attendance, group=1)) + \n  geom_line() + \n  scale_y_continuous(labels = scales::comma) + \n  labs(x=\"Year\", y=\"Attendance\", title=\"Maryland Football Attendance Climbs Under Locksley\", subtitle=\"Heading back to the 300,000 mark?\", caption=\"Source: NCAA | By Derek Willis\", color = \"Outcome\") +\n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank(),\n    axis.text = element_text(size = 7),\n    axis.ticks = element_blank(),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    legend.position=\"bottom\"\n  )",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Transforming data</span>"
    ]
  },
  {
    "objectID": "significancetests.html",
    "href": "significancetests.html",
    "title": "8  Significance tests",
    "section": "",
    "text": "8.1 Accepting the null hypothesis\nSo what does it look like when your hypothesis is wrong?\nLet’s test another thing that may have been impacted by bubble games: home court advantage. If you’re the home team, but you’re not at home, does it affect you? It has to, right? Your fans aren’t there. Home and away are just positions on the scoreboard. It can’t matter, can it?\nMy hypothesis is that home court is no longer an advantage, and the home team will score less relative to the away team.\nFirst things first: We need to make a dataframe where Team is the home team. And then we’ll create a differential between the home team and away team. If home court is an advantage, the differential should average out to be positive – the home team scores more than the away team.\nhomecourt &lt;- logs |&gt; filter(is.na(HomeAway) == TRUE) |&gt; mutate(differential = TeamScore - OpponentScore)\nNow let’s test it.\nt.test(differential ~ COVID, data=homecourt)\n\n\n    Welch Two Sample t-test\n\ndata:  differential by COVID\nt = 0.36892, df = 107.84, p-value = 0.7129\nalternative hypothesis: true difference in means between group With Fans and group Without Fans is not equal to 0\n95 percent confidence interval:\n -2.301628  3.354268\nsample estimates:\n   mean in group With Fans mean in group Without Fans \n                  2.174047                   1.647727\nSo again, start at the bottom. With Fans, the home team averages 2.17 more points than the away team. Without fans, they average 1.64 more.\nIf you are a bad sportswriter or a hack sports talk radio host, you look at this and scream “the bubble killed home court!”\nBut two things: first, the home team is STILL, on average, scoring more than the away team on the whole.\nAnd two: Look at the p-value. It’s .7129. Is that less than .05? No, no it is not. So that means we have to accept the null hypothesis that there is no difference between fans and no fans when it comes to the difference between the home team and the away team’s score.\nNow, does this mean that the bubble hasn’t impacted the magic of home court? Not necessarily. What it’s saying is that the variance between one and the other is too large to be able to say that they’re different. It could just be random noise that’s causing the difference, and so it’s not real. More to the point, it’s saying that this metric isn’t capable of telling you that there’s no home court in the bubble.\nWe’re going to be analyzing these bubble games for years trying to find the true impact of fans.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Significance tests</span>"
    ]
  },
  {
    "objectID": "correlations.html",
    "href": "correlations.html",
    "title": "9  Correlations and regression",
    "section": "",
    "text": "9.1 A more predictive example\nSo we’ve firmly established that fouls aren’t predictive. But what is?\nSo instead of looking at fouls, let’s make a new metric: shots on goal. Can we predict the score differential by looking at the shots they put on goal?\nFirst, let’s look at the correlation coefficent.\nnewcorrelations |&gt; \n  summarise(correlation = cor(differential, so_g, method=\"pearson\"))\n\n# A tibble: 1 × 1\n  correlation\n        &lt;dbl&gt;\n1       0.629\nAnswer: 63 percent. Not a perfect relationship, but pretty good. But how meaningful is that relationship and how predictive is it?\nnet &lt;- lm(differential ~ so_g, data = newcorrelations)\nsummary(net)\n\n\nCall:\nlm(formula = differential ~ so_g, data = newcorrelations)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-11.5238  -1.1225   0.0781   1.2772   7.2819 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -2.275609   0.042262  -53.84   &lt;2e-16 ***\nso_g         0.399685   0.006196   64.50   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.812 on 6363 degrees of freedom\nMultiple R-squared:  0.3954,    Adjusted R-squared:  0.3953 \nF-statistic:  4161 on 1 and 6363 DF,  p-value: &lt; 2.2e-16\nFirst we check p-value: 0.00000000000000022. That’s sixteen zeros between the decimal and 22. Is that less than .05? Uh, yeah. So this is really, really, really not random. But anyone who has watched a game of soccer knows this is true. It makes intuitive sense.\nSecond, Adjusted R-squared: 0.3953. So we can predict about 39 percent of the difference in the score differential by simply looking at the shots on goal the team has.\nThird, the coefficients: In this case, our y=mx+b formula looks like y = 0.399685x + -2.275609. So if we were applying this, let’s look at Maryland’s 3-3 draw against Navy on August 24, 2023. Maryland’s shots on goal in that game? 11. What does our model say the point differential should have been?\n(0.399685*11)+-2.275609 \n\n[1] 2.120926\nSo by our model, Maryland should have won by two goals. Some games are closer than others. But when you can explain 39 percent of the difference, this is the kind of result you get. What would improve the model? Using more data to start. And using more inputs.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Correlations and regression</span>"
    ]
  },
  {
    "objectID": "multipleregression.html",
    "href": "multipleregression.html",
    "title": "10  Multiple regression",
    "section": "",
    "text": "Last chapter, we looked at correlations and linear regression to predict how one element of a game would predict the score. But we know that a single variable, in all but the rarest instances, is not going to be that predictive. We need more than one. Enter multiple regression. Multiple regression lets us add – wait for it – multiple predictors to our equation to help us get a better fit to reality.\nThat presents it’s own problems. So let’s get set up. The dataset we’ll use is all men’s college basketball games between 2015 and 2024.\nFor this walkthrough:\n   Download csv file\n\nWe need the tidyverse.\n\nlibrary(tidyverse)\n\nAnd the data.\n\nlogs &lt;- read_csv(\"data/cbblogs1524.csv\")\n\nRows: 98161 Columns: 51\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (9): Season, TeamFull, Opponent, HomeAway, W_L, URL, Conference, Team,...\ndbl  (39): Game, TeamScore, OpponentScore, TeamFG, TeamFGA, TeamFGPCT, Team3...\nlgl   (2): Blank, season\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nOne way to show how successful a basketball team was for a game is to show the differential between the team’s score and the opponent’s score. Score a lot more than the opponent = good, score a lot less than the opponent = bad. And, relatively speaking, the more the better. So let’s create that differential. Let’s add in net rebounds. And because we’ll need it later, let’s add the turnover margin.\n\nlogs &lt;- logs |&gt; mutate(\n  Differential = TeamScore - OpponentScore, \n  NetRebounds = TeamTotalRebounds - OpponentTotalRebounds,\n  TurnoverMargin = TeamTurnovers - OpponentTurnovers)\n\nThe linear model code we used before is pretty straight forward. Its field is predicted by field. Here’s a simple linear model that looks at predicting a team’s point differential by looking at their net turnovers.\n\nrebounds &lt;- lm(Differential ~ NetRebounds, data=logs)\nsummary(rebounds)\n\n\nCall:\nlm(formula = Differential ~ NetRebounds, data = logs)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-59.216  -8.579  -0.233   8.203  78.185 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 0.651821   0.041475   15.72   &lt;2e-16 ***\nNetRebounds 1.072698   0.004278  250.72   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.97 on 98133 degrees of freedom\n  (26 observations deleted due to missingness)\nMultiple R-squared:  0.3905,    Adjusted R-squared:  0.3904 \nF-statistic: 6.286e+04 on 1 and 98133 DF,  p-value: &lt; 2.2e-16\n\n\nRemember: There’s a lot here, but only some of it we care about. What is the Adjusted R-squared value? What’s the p-value and is it less than .05? In this case, we can predict about 39 percent of the difference in differential with the net rebounds in the game.\nTo add more predictors to this mix, we merely add them. But it’s not that simple, as you’ll see in a moment. So first, let’s look at adding turnover margin to our prediction model:\n\nmodel1 &lt;- lm(Differential ~ NetRebounds + TurnoverMargin, data=logs)\nsummary(model1)\n\n\nCall:\nlm(formula = Differential ~ NetRebounds + TurnoverMargin, data = logs)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-46.158  -6.899  -0.062   6.845  45.874 \n\nCoefficients:\n                Estimate Std. Error  t value Pr(&gt;|t|)    \n(Intercept)     0.303968   0.032952    9.225   &lt;2e-16 ***\nNetRebounds     1.200686   0.003438  349.286   &lt;2e-16 ***\nTurnoverMargin -1.557334   0.006487 -240.067   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.3 on 98132 degrees of freedom\n  (26 observations deleted due to missingness)\nMultiple R-squared:  0.616, Adjusted R-squared:  0.616 \nF-statistic: 7.87e+04 on 2 and 98132 DF,  p-value: &lt; 2.2e-16\n\n\nFirst things first: What is the adjusted R-squared? This model predicts about 61 percent of the differential.\nSecond: what is the p-value and is it less than .05?\nThird: Compare the residual standard error. We went from 12.95 to 10.3. The meaning of this is both really opaque and also simple – by adding data, we reduced the amount of error in our model. Residual standard error is the total distance between what our model would predict and what we actually have in the data. So lots of residual error means the distance between reality and our model is wider. So the width of our predictive range in this example shrank while we improved the amount of the difference we could predict. That’s good, and not always going to be the case.\nOne of the more difficult things to understand about multiple regression is the issue of multicollinearity. What that means is that there is significant correlation overlap between two variables – the two are related to each other as well as to the target output – and all you are doing by adding both of them is adding error with no real value to the R-squared. In pure statistics, we don’t want any multicollinearity at all. Violating that assumption limits the applicability of what you are doing. So if we have some multicollinearity, it limits our scope of application to college basketball. We can’t say this will work for every basketball league and level everywhere. What we need to do is see how correlated each value is to each other and throw out ones that are highly co-correlated.\nSo to find those, we have to create a correlation matrix that shows us how each value is correlated to our outcome variable, but also with each other. We can do that in the Hmisc library. We install that in the console with install.packages(\"Hmisc\")\n\nlibrary(Hmisc)\n\nWe can pass in every numeric value to the Hmisc library and get a correlation matrix out of it, but since we have a large number of values – and many of them character values – we should strip that down and reorder them. So that’s what I’m doing here. I’m saying give me all the columns with numeric values, except for Game, and then show me the differential, net yards, turnover margin and then everything else.\n\nsimplelogs &lt;- logs |&gt; select_if(is.numeric) |&gt; select(-Game) |&gt; select(Differential, NetRebounds, TurnoverMargin, TeamFGPCT, TeamTotalRebounds, OpponentFGPCT, OpponentTotalRebounds)\n\nBefore we proceed, what we’re looking to do is follow the Differential column down, looking for correlation values near 1 or -1. Correlations go from -1, meaning perfect negative correlation, to 0, meaning no correlation, to 1, meaning perfect positive correlation. So we’re looking for numbers near 1 or -1 for their predictive value. BUT: We then need to see if that value is also highly correlated with something else. If it is, we have a decision to make.\nWe get our correlation matrix like this:\n\ncormatrix &lt;- rcorr(as.matrix(simplelogs))\n\ncormatrix$r\n\n                      Differential NetRebounds TurnoverMargin   TeamFGPCT\nDifferential             1.0000000   0.6248635    -0.37224236  0.60842699\nNetRebounds              0.6248635   1.0000000     0.15509130  0.36726732\nTurnoverMargin          -0.3722424   0.1550913     1.00000000 -0.03109904\nTeamFGPCT                0.6084270   0.3672673    -0.03109904  1.00000000\nTeamTotalRebounds        0.4887337   0.7514775     0.09713362  0.02665011\nOpponentFGPCT           -0.6165787  -0.3776729     0.03438953 -0.11505868\nOpponentTotalRebounds   -0.4292394  -0.7190817    -0.13197214 -0.52680962\n                      TeamTotalRebounds OpponentFGPCT OpponentTotalRebounds\nDifferential                 0.48873374  -0.616578694          -0.429239429\nNetRebounds                  0.75147749  -0.377672886          -0.719081689\nTurnoverMargin               0.09713362   0.034389532          -0.131972135\nTeamFGPCT                    0.02665011  -0.115058678          -0.526809615\nTeamTotalRebounds            1.00000000  -0.546787074          -0.081890501\nOpponentFGPCT               -0.54678707   1.000000000          -0.005413951\nOpponentTotalRebounds       -0.08189050  -0.005413951           1.000000000\n\n\nNotice right away – NetRebounds is highly correlated. But NetRebounds is also highly correlated with TeamTotalRebounds. And that makes sense: TeamTotalRebounds feeds into NetRebounds. Including both of these measures would be pointless – they would add error without adding much in the way of predictive power.\n\nYour turn: What else do you see? What other values have predictive power and aren’t co-correlated? Add or remove some of the columns above and re-run the correlation matrix.\n\nWe can add more just by simply adding them. Let’s add the average FG PCT for both the team and opponent. They’re correlated to Differential, but not as much as you might expect.\n\nmodel2 &lt;- lm(Differential ~ NetRebounds + TurnoverMargin + TeamFGPCT + OpponentFGPCT, data=logs)\nsummary(model2)\n\n\nCall:\nlm(formula = Differential ~ NetRebounds + TurnoverMargin + TeamFGPCT + \n    OpponentFGPCT, data = logs)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-26.171  -3.679  -0.023   3.651  37.368 \n\nCoefficients:\n                 Estimate Std. Error  t value Pr(&gt;|t|)    \n(Intercept)      0.226590   0.156372    1.449    0.147    \nNetRebounds      0.656535   0.002128  308.520   &lt;2e-16 ***\nTurnoverMargin  -1.311144   0.003484 -376.362   &lt;2e-16 ***\nTeamFGPCT       91.270480   0.254245  358.986   &lt;2e-16 ***\nOpponentFGPCT  -91.510307   0.254204 -359.988   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.474 on 98130 degrees of freedom\n  (26 observations deleted due to missingness)\nMultiple R-squared:  0.8915,    Adjusted R-squared:  0.8915 \nF-statistic: 2.015e+05 on 4 and 98130 DF,  p-value: &lt; 2.2e-16\n\n\nGo down the list:\nWhat is the Adjusted R-squared now? What is the p-value and is it less than .05? What is the Residual standard error?\nThe final thing we can do with this is predict things. Look at our coefficients table. See the Estimates? We can build a formula from that, same as we did with linear regressions.\nHow does this apply in the real world? Let’s pretend for a minute that you are Kevin Willard, and you want to win conference titles. To do that, we need to know what attributes of a team we should emphasize. We can do that by looking at what previous Big Ten conference champions looked like.\nSo if our goal is to predict a conference champion team, we need to know what those teams did. Here’s the regular season conference champions in this dataset.\n\nlogs |&gt; \n  filter(Team == \"Michigan\" & Season == '2020-2021' | Team == \"Wisconsin\" & Season == '2019-2020' | Team == \"Michigan State\" & Season == '2018-2019' | Team == \"Michigan State\" & Season == '2017-2018' | Team == 'Illinois' & Season == '2021-2022' | Team == 'Purdue' & Season == '2022-2023' | Team == 'Purdue' & Season == '2023-2024') |&gt; \n  summarise(\n    meanNetRebounds = mean(NetRebounds),\n    meanTurnoverMargin = mean(TurnoverMargin),\n    meanTeamFGPCT = mean(TeamFGPCT),\n    meanOpponentFGPCT = mean(OpponentFGPCT)\n  )\n\n# A tibble: 1 × 4\n  meanNetRebounds meanTurnoverMargin meanTeamFGPCT meanOpponentFGPCT\n            &lt;dbl&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;\n1            9.61               1.97         0.477             0.399\n\n\nNow it’s just plug and chug.\n\n# (netrebounds estimate * meanNetRebounds) + (turnover margin estimate * meanTurnoverMargin) + (TeamFGPCT estimate * meanTeamFGPCT) + (OpponentFGPCT estimate * meanOpponentFGPCT) + Intercept\n(0.657726*9.645933) + (-1.313064*1.933014) + (91.403110*0.4780766) + (-91.650923*0.3981818) + 0.233954\n\n[1] 11.24412\n\n\nSo a team with those numbers is going to average scoring 11 more points per game than their opponent. Not a ton, but hey, the Big Ten has been a competitive conference lately.\nHow does that compare to Maryland in 2023-24 season?\n\nlogs |&gt; \n  filter(\n    Team == \"Maryland\" & Season == '2023-2024'\n    ) |&gt; \n  summarise(\n    meanNetRebounds = mean(NetRebounds),\n    meanTurnoverMargin = mean(TurnoverMargin),\n    meanTeamFGPCT = mean(TeamFGPCT),\n    meanOpponentFGPCT = mean(OpponentFGPCT)\n  )\n\n# A tibble: 1 × 4\n  meanNetRebounds meanTurnoverMargin meanTeamFGPCT meanOpponentFGPCT\n            &lt;dbl&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;\n1            1.27             -0.394         0.414             0.419\n\n\n\n(0.657726*1.277778) + (-0.3055556*1.933014) + (91.403110*0.4133056) + (-91.650923*0.4171944) + 0.233954\n\n[1] 0.02490395\n\n\nBy this model, it predicted we would, on average, barely outscore our opponents over that season. The reality?\n\nlogs |&gt; \n     filter(\n         Team == \"Maryland\" & Season == '2023-2024'\n     ) |&gt; summarise(avg_score = mean(TeamScore), avg_opp = mean(OpponentScore))\n\n# A tibble: 1 × 2\n  avg_score avg_opp\n      &lt;dbl&gt;   &lt;dbl&gt;\n1      69.0    65.9\n\n\nWe outscored them by about 3 points on average, so maybe this isn’t the best model, or suggests that perhaps Maryland found a way to be successful outside of these parameters. What would you change?",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Multiple regression</span>"
    ]
  },
  {
    "objectID": "residuals.html",
    "href": "residuals.html",
    "title": "11  Residuals",
    "section": "",
    "text": "11.1 Fouls\nNow let’s look at it where it doesn’t work as well: the total number of fouls\nfouls &lt;- logs |&gt; \n  mutate(\n    differential = TeamScore - OpponentScore, \n    TotalFouls = TeamPersonalFouls+OpponentPersonalFouls\n  )\npfit &lt;- lm(differential ~ TotalFouls, data = fouls)\nsummary(pfit)\n\n\nCall:\nlm(formula = differential ~ TotalFouls, data = fouls)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-81.056 -10.628  -0.056   9.587 106.658 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  3.771005   0.262763  14.351   &lt;2e-16 ***\nTotalFouls  -0.071448   0.007219  -9.898   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.61 on 98133 degrees of freedom\n  (26 observations deleted due to missingness)\nMultiple R-squared:  0.0009973, Adjusted R-squared:  0.0009871 \nF-statistic: 97.97 on 1 and 98133 DF,  p-value: &lt; 2.2e-16\nSo from top to bottom:\nSo what we can say about this model is that it’s statistically significant, but doesn’t really explain much. It’s not meaningless, but on its own the total number of fouls doesn’t go very far in explaining the point differential. Normally, we’d stop right here – why bother going forward with a predictive model that isn’t terribly predictive? But let’s do it anyway. Oh, and see that “(65 observations deleted due to missingness)” bit? That means we need to lose some incomplete data again.\nfouls &lt;- fouls |&gt; filter(!is.na(TotalFouls))\nfouls$predicted &lt;- predict(pfit)\nfouls$residuals &lt;- residuals(pfit)\nfouls |&gt; arrange(desc(residuals)) |&gt; select(Team, Opponent, W_L, TeamScore, OpponentScore, TotalFouls, residuals)\n\n# A tibble: 98,135 × 7\n   Team                  Opponent         W_L   TeamSc…¹ Oppon…² Total…³ resid…⁴\n   &lt;chr&gt;                 &lt;chr&gt;            &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n 1 Bryant                Thomas (ME)      W          147      39      34   107. \n 2 McNeese State         Dallas Christian W          140      37      33   102. \n 3 Appalachian State     Toccoa Falls     W          135      34      35    99.7\n 4 Purdue Fort Wayne     &lt;NA&gt;             W          130      34      19    93.6\n 5 James Madison         Carlow           W          135      40      29    93.3\n 6 North Dakota State    Oak Hills        W          108      14      12    91.1\n 7 Florida International Trinity (FL)     W          146      55      39    90.0\n 8 Lamar                 Howard Payne     W          121      32      35    87.7\n 9 Georgia Southern      Carver College   W          139      51      38    86.9\n10 Youngstown State      Franciscan       W          134      46      35    86.7\n# … with 98,125 more rows, and abbreviated variable names ¹​TeamScore,\n#   ²​OpponentScore, ³​TotalFouls, ⁴​residuals\nFirst, note all of the biggest misses here are all blowout games. The worst games of the season, the worst being Bryant vs. Thomas. The model missed that differential by … 107 points. The margin of victory? 108 points. In other words, this model is not great! But let’s look at it anyway.\nWell … it actually says that a linear model is appropriate. Which an important lesson – just because your residual plot says a linear model works here, that doesn’t say your linear model is good. There are other measures for that, and you need to use them.\nHere’s the segment plot of residuals – you’ll see some really long lines. That’s a bad sign. Another bad sign? A flat fit line. It means there’s no relationship between these two things. Which we already know.\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Residuals</span>"
    ]
  },
  {
    "objectID": "residuals.html#fouls",
    "href": "residuals.html#fouls",
    "title": "11  Residuals",
    "section": "",
    "text": "Our min and max go from -94 to positive 107\nOur adjusted R-squared is … 0.000986. Not much at all.\nOur p-value is … is less than than .05, so that’s something.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Residuals</span>"
    ]
  },
  {
    "objectID": "zscores.html",
    "href": "zscores.html",
    "title": "12  Z-scores",
    "section": "",
    "text": "12.1 Calculating a Z score in R\nFor this we’ll need the logs of all college basketball games last season.\nLoad the tidyverse.\nlibrary(tidyverse)\nAnd load the data.\ngamelogs &lt;- read_csv(\"data/wbblogs24.csv\")\n\nRows: 11503 Columns: 48\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (8): Season, TeamFullName, Opponent, HomeAway, W_L, URL, Conference, Team\ndbl  (39): Game, TeamScore, OpponentScore, TeamFG, TeamFGA, TeamFGPCT, Team3...\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nThe first thing we need to do is select some fields we think represent team quality and a few things to help us keep things straight. So I’m going to pick shooting percentage, rebounding and the opponent version of the same two:\nteamquality &lt;- gamelogs |&gt; \n  select(Conference, Team, TeamFGPCT, TeamTotalRebounds, OpponentFGPCT, OpponentTotalRebounds)\nAnd since we have individual game data, we need to collapse this into one record for each team. We do that with … group by and summarize.\nteamtotals &lt;- teamquality |&gt; \n  group_by(Conference, Team) |&gt; \n  summarise(\n    FGAvg = mean(TeamFGPCT), \n    ReboundAvg = mean(TeamTotalRebounds), \n    OppFGAvg = mean(OpponentFGPCT),\n    OffRebAvg = mean(OpponentTotalRebounds)\n    ) \n\n`summarise()` has grouped output by 'Conference'. You can override using the\n`.groups` argument.\nTo calculate a z-score in R, the easiest way is to use the scale function in base R. To use it, you use scale(FieldName, center=TRUE, scale=TRUE). The center and scale indicate if you want to subtract from the mean and if you want to divide by the standard deviation, respectively. We do.\nWhen we have multiple z-scores, it’s pretty standard practice to add them together into a composite score. That’s what we’re doing at the end here with TotalZscore. Note: We have to invert OppZscore and OppRebZScore by multiplying it by a negative 1 because the lower someone’s opponent number is, the better.\nteamzscore &lt;- teamtotals |&gt; \n  mutate(\n    FGzscore = as.numeric(scale(FGAvg, center = TRUE, scale = TRUE)),\n    RebZscore = as.numeric(scale(ReboundAvg, center = TRUE, scale = TRUE)),\n    OppZscore = as.numeric(scale(OppFGAvg, center = TRUE, scale = TRUE)) * -1,\n    OppRebZScore = as.numeric(scale(OffRebAvg, center = TRUE, scale = TRUE)) * -1,\n    TotalZscore = FGzscore + RebZscore + OppZscore + OppRebZScore\n  )\nSo now we have a dataframe called teamzscore that has 360 basketball teams with Z scores. What does it look like?\nhead(teamzscore)\n\n# A tibble: 6 × 11\n# Groups:   Conference [1]\n  Confere…¹ Team   FGAvg Rebou…² OppFG…³ OffRe…⁴ FGzsc…⁵ RebZs…⁶ OppZs…⁷ OppRe…⁸\n  &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 A-10 WBB  Davi… NA        NA    NA        NA   NA       NA      NA      NA    \n2 A-10 WBB  Dayt…  0.400    35.7   0.437    28.7 -0.0992   1.17   -1.10    0.649\n3 A-10 WBB  Duqu…  0.424    33.8   0.390    32.4  0.595    0.637   0.441  -0.432\n4 A-10 WBB  Ford… NA        NA    NA        NA   NA       NA      NA      NA    \n5 A-10 WBB  Geor…  0.397    34.9   0.381    32.7 -0.201    0.946   0.764  -0.530\n6 A-10 WBB  Geor…  0.370    33.7   0.390    29.7 -0.980    0.631   0.466   0.364\n# … with 1 more variable: TotalZscore &lt;dbl&gt;, and abbreviated variable names\n#   ¹​Conference, ²​ReboundAvg, ³​OppFGAvg, ⁴​OffRebAvg, ⁵​FGzscore, ⁶​RebZscore,\n#   ⁷​OppZscore, ⁸​OppRebZScore\nA way to read this – a team with a TotalZScore of 0 is precisely average. The larger the positive number, the more exceptional they are. The larger the negative number, the more truly terrible they are.\nSo who are the best teams in the country?\nteamzscore |&gt; arrange(desc(TotalZscore))\n\n# A tibble: 360 × 11\n# Groups:   Conference [33]\n   Confere…¹ Team  FGAvg Rebou…² OppFG…³ OffRe…⁴ FGzsc…⁵ RebZs…⁶ OppZs…⁷ OppRe…⁸\n   &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n 1 SEC WBB   Sout… 0.495    42.2   0.324    28.3   2.13    1.70    2.17    1.22 \n 2 MAAC WBB  Fair… 0.464    33.1   0.361    27.4   2.26    1.26    1.61    1.64 \n 3 Big East… Conn… 0.498    33.5   0.356    27.8   2.41    0.883   1.78    0.999\n 4 WCC WBB   Gonz… 0.482    34.2   0.403    25.4   1.82    1.05    0.811   2.26 \n 5 Sun Belt… Jame… 0.424    42.4   0.363    31.0   1.10    1.64    1.64    1.47 \n 6 Big 12 W… Texas 0.490    36.2   0.384    24.4   1.63    0.775   1.17    2.22 \n 7 Summit W… Sout… 0.476    35.1   0.370    26.5   1.95    0.878   1.54    1.42 \n 8 OVC WBB   Sout… 0.452    35.6   0.359    31.1   1.90    1.32    1.90    0.596\n 9 MWC WBB   Neva… 0.463    37.6   0.381    28.2   1.69    1.84    0.954   1.18 \n10 SWAC WBB  Jack… 0.397    38.5   0.341    29.9   0.722   1.36    1.79    1.38 \n# … with 350 more rows, 1 more variable: TotalZscore &lt;dbl&gt;, and abbreviated\n#   variable names ¹​Conference, ²​ReboundAvg, ³​OppFGAvg, ⁴​OffRebAvg, ⁵​FGzscore,\n#   ⁶​RebZscore, ⁷​OppZscore, ⁸​OppRebZScore\nDon’t sleep on Fairfield! If we look for Power Five schools, UConn and South Carolina are at the top, which checks out.\nBut closer to home, how is Maryland doing?\nteamzscore |&gt; \n  filter(Conference == \"Big Ten WBB\") |&gt; \n  arrange(desc(TotalZscore)) |&gt;\n  select(Team, TotalZscore)\n\nAdding missing grouping variables: `Conference`\n\n\n# A tibble: 14 × 3\n# Groups:   Conference [1]\n   Conference  Team           TotalZscore\n   &lt;chr&gt;       &lt;chr&gt;                &lt;dbl&gt;\n 1 Big Ten WBB Iowa                 4.41 \n 2 Big Ten WBB Indiana              3.84 \n 3 Big Ten WBB Nebraska             3.15 \n 4 Big Ten WBB Penn State           1.88 \n 5 Big Ten WBB Illinois             1.20 \n 6 Big Ten WBB Michigan             0.396\n 7 Big Ten WBB Maryland            -0.651\n 8 Big Ten WBB Ohio State          -0.662\n 9 Big Ten WBB Minnesota           -0.856\n10 Big Ten WBB Wisconsin           -0.905\n11 Big Ten WBB Michigan State      -1.17 \n12 Big Ten WBB Rutgers             -1.91 \n13 Big Ten WBB Purdue              -2.54 \n14 Big Ten WBB Northwestern        -6.20\nSo, as we can see, with our composite Z Score, Maryland is below average; not great. But better than Ohio State. Notice how, by this measure, Indiana and Iowa are far ahead of most of the conference, with Nebraska a somewhat surprising third.\nWe can limit our results to just Power Five conferences plus the Big East:\npowerfive_plus_one &lt;- c(\"SEC WBB\", \"Big Ten WBB\", \"Pac-12 WBB\", \"Big 12 WBB\", \"ACC WBB\", \"Big East WBB\")\nteamzscore |&gt; \n  filter(Conference %in% powerfive_plus_one) |&gt; \n  arrange(desc(TotalZscore)) |&gt;\n  select(Team, TotalZscore)\n\nAdding missing grouping variables: `Conference`\n\n\n# A tibble: 80 × 3\n# Groups:   Conference [6]\n   Conference   Team            TotalZscore\n   &lt;chr&gt;        &lt;chr&gt;                 &lt;dbl&gt;\n 1 SEC WBB      South Carolina         7.22\n 2 Big East WBB Connecticut            6.07\n 3 Big 12 WBB   Texas                  5.80\n 4 Pac-12 WBB   Stanford               4.97\n 5 SEC WBB      Louisiana State        4.83\n 6 Pac-12 WBB   UCLA                   4.67\n 7 ACC WBB      Virginia Tech          4.53\n 8 Big Ten WBB  Iowa                   4.41\n 9 Big Ten WBB  Indiana                3.84\n10 ACC WBB      Duke                   3.65\n# … with 70 more rows\nThis makes a certain amount of sense: three of the Final Four teams - South Carolina, UConn and Iowa are in the top 10. N.C. State, the fourth team, ranks 16th. Duke is an interesting #10 here. It doesn’t necessarily mean they were the ninth-best team, but given their competition they shot the ball and rebounded the ball very well.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Z-scores</span>"
    ]
  },
  {
    "objectID": "zscores.html#calculating-a-z-score-in-r",
    "href": "zscores.html#calculating-a-z-score-in-r",
    "title": "12  Z-scores",
    "section": "",
    "text": "For this walkthrough:\n   Download csv file",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Z-scores</span>"
    ]
  },
  {
    "objectID": "zscores.html#writing-about-z-scores",
    "href": "zscores.html#writing-about-z-scores",
    "title": "12  Z-scores",
    "section": "12.2 Writing about z-scores",
    "text": "12.2 Writing about z-scores\nThe great thing about z-scores is that they make it very easy for you, the sports analyst, to create your own measures of who is better than who. The downside: Only a small handful of sports fans know what the hell a z-score is.\nAs such, you should try as hard as you can to avoid writing about them.\nIf the word z-score appears in your story or in a chart, you need to explain what it is. “The ranking uses a statistical measure of the distance from the mean called a z-score” is a good way to go about it. You don’t need a full stats textbook definition, just a quick explanation. And keep it simple.\nNever use z-score in a headline. Write around it. Away from it. Z-score in a headline is attention repellent. You won’t get anyone to look at it. So “Tottenham tops in z-score” bad, “Tottenham tops in the Premiere League” good.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Z-scores</span>"
    ]
  },
  {
    "objectID": "clustering.html",
    "href": "clustering.html",
    "title": "13  Clustering",
    "section": "",
    "text": "13.1 Advanced metrics\nHow much does this change if we change the metrics? I used pretty standard box score metrics above. What if we did it using Player Efficiency Rating, True Shooting Percentage, Point Production, Assist Percentage, Win Shares Per 40 Minutes and Box Plus Minus (you can get definitions of all of them by hovering over the stats on Nebraksa’s stats page).\nWe’ll repeat the process. Filter out players who don’t play, players with stats missing, and just focus on those stats listed above.\nplayersadvanced &lt;- players |&gt;\n  filter(MP&gt;0) |&gt;\n  filter(Pos == \"F\") |&gt;\n  select(Player, Team, Pos, PER, `TS%`, PProd, `AST%`, `WS/40`, BPM) |&gt;\n  na.omit()\nNow to scale them.\nplayersadvscaled &lt;- playersadvanced |&gt;\n  select(PER, `TS%`, PProd, `AST%`, `WS/40`, BPM) |&gt;\n  mutate_all(scale) |&gt;\n  na.omit()\nLet’s find the optimal number of clusters.\n# function to compute total within-cluster sum of square\nwss &lt;- function(k) {\n  kmeans(playersadvscaled, k, nstart = 10 )$tot.withinss\n}\n\n# Compute and plot wss for k = 1 to k = 15\nk.values &lt;- 1:15\n\n# extract wss for 2-15 clusters\nwss_values &lt;- map_dbl(k.values, wss)\n\nWarning: did not converge in 10 iterations\n\nWarning: did not converge in 10 iterations\n\nplot(k.values, wss_values,\n       type=\"b\", pch = 19, frame = FALSE,\n       xlab=\"Number of clusters K\",\n       ylab=\"Total within-clusters sum of squares\")\nLooks like 4.\nadvk4 &lt;- kmeans(playersadvscaled, centers = 4, nstart = 25)\nWhat do we have here?\nadvk4\n\nK-means clustering with 4 clusters of sizes 627, 320, 612, 82\n\nCluster means:\n         PER        TS%      PProd        AST%      WS/40        BPM\n1  0.3328142  0.5094144 -0.0942388 -0.09932351  0.3805037  0.3628638\n2  0.9655878  0.4538599  1.5112893  0.82146770  0.8477533  0.8427975\n3 -0.5374881 -0.3986254 -0.5452426 -0.22446363 -0.5022825 -0.4844985\n4 -2.3014614 -2.6912101 -1.1077608 -0.77100101 -2.4690239 -2.4475330\n\nClustering vector:\n   [1] 2 1 1 3 3 2 2 3 1 3 3 1 1 2 2 1 1 3 1 3 3 3 1 4 2 1 1 1 2 2 2 2 2 1 3 4 2\n  [38] 2 1 2 2 3 1 2 1 3 2 3 3 3 3 2 1 3 1 1 1 3 2 2 1 1 1 2 2 1 1 3 1 1 1 3 1 2\n  [75] 2 2 1 1 1 3 1 2 1 1 3 3 3 3 3 1 1 1 3 3 1 3 2 2 3 4 1 1 3 1 1 1 4 2 1 1 1\n [112] 2 2 2 1 3 1 2 2 1 3 3 2 3 3 1 3 3 1 1 4 2 1 1 3 1 1 4 2 2 1 2 1 3 3 2 2 3\n [149] 3 1 2 1 3 3 3 2 1 1 1 1 2 1 3 3 2 1 3 3 1 3 2 3 1 1 2 1 1 1 1 1 3 3 3 1 3\n [186] 3 1 3 4 2 1 1 1 3 3 2 1 3 1 3 1 2 1 3 1 1 3 2 1 3 3 1 1 1 3 4 2 1 3 3 3 4\n [223] 3 1 3 3 1 2 1 1 2 3 3 3 3 3 1 3 3 4 2 2 1 1 1 2 1 1 4 2 3 4 3 2 2 1 1 3 2\n [260] 1 1 1 1 2 1 3 4 2 3 3 3 2 1 3 3 2 1 1 3 3 4 1 1 1 1 2 2 3 1 3 2 2 1 3 1 2\n [297] 3 3 1 3 3 3 3 3 2 2 1 3 2 1 3 3 4 2 1 3 3 3 1 1 3 1 2 1 1 3 4 2 2 1 3 2 1\n [334] 1 1 1 1 4 4 3 3 1 1 1 4 2 1 1 3 1 4 3 2 2 1 3 3 2 3 3 3 2 3 2 3 1 1 3 2 2\n [371] 1 1 3 3 3 3 3 3 1 1 1 3 3 3 1 3 1 2 2 1 1 1 3 3 2 2 1 3 1 2 1 1 3 2 3 3 3\n [408] 2 1 1 1 1 3 2 1 3 3 3 3 3 3 3 1 1 1 2 1 3 3 3 1 1 3 3 1 2 1 3 3 1 3 3 3 2\n [445] 1 3 2 1 1 3 3 2 4 2 1 1 3 4 2 3 1 1 3 3 1 1 3 2 1 1 3 4 2 1 3 3 1 1 1 3 3\n [482] 1 1 1 1 1 3 2 1 3 4 2 3 1 3 1 1 1 3 3 1 1 3 1 1 3 3 2 2 1 2 1 3 2 2 1 1 3\n [519] 3 1 1 1 1 3 1 2 2 3 1 3 2 2 1 3 1 1 1 3 3 1 2 2 1 1 3 1 2 1 1 4 4 2 1 3 1\n [556] 3 1 2 2 2 1 1 3 3 4 2 2 3 2 2 1 1 2 1 3 3 3 2 3 3 3 2 1 1 4 2 1 1 3 4 1 3\n [593] 1 3 3 3 2 1 1 3 4 2 2 1 1 3 1 1 1 2 1 1 3 2 2 1 3 1 2 2 2 3 3 3 3 2 1 1 2\n [630] 2 1 3 3 3 4 2 1 3 2 1 1 3 3 4 2 1 1 1 1 3 2 1 3 1 4 2 3 1 3 3 1 3 3 3 4 1\n [667] 1 1 1 3 3 1 3 1 3 2 1 3 2 1 1 1 3 1 3 1 1 2 1 3 2 2 3 1 3 2 2 1 3 3 1 1 1\n [704] 1 4 2 1 1 3 3 3 3 1 2 3 3 1 3 3 3 3 2 2 1 1 1 1 1 3 3 3 1 1 3 3 3 3 1 3 1\n [741] 3 3 1 1 3 1 3 4 2 3 1 3 3 3 1 3 1 3 3 1 1 1 1 3 1 1 2 1 1 1 1 4 2 2 1 1 2\n [778] 1 3 3 3 3 3 3 3 3 4 2 1 3 1 1 1 1 4 1 1 1 3 3 3 3 1 3 3 3 1 3 3 1 1 1 1 3\n [815] 1 2 2 1 1 1 1 1 1 1 1 3 1 1 3 4 1 3 3 1 2 2 3 1 3 3 2 1 1 3 2 1 1 3 1 3 3\n [852] 4 2 3 3 3 2 1 1 3 1 1 1 3 3 3 3 3 2 2 3 3 3 3 1 1 1 1 1 1 1 1 1 3 2 1 3 3\n [889] 1 1 3 1 2 1 3 3 3 3 3 1 2 1 3 3 2 1 1 1 3 3 3 1 3 1 4 2 2 2 1 3 2 1 1 3 1\n [926] 3 2 2 2 1 2 3 3 3 2 3 1 1 1 1 1 3 1 1 4 1 2 1 3 3 4 3 3 3 3 2 2 1 3 1 1 3\n [963] 3 2 3 3 3 2 2 1 1 3 1 3 2 3 3 4 2 1 1 3 3 4 2 1 1 1 3 3 3 3 3 1 3 3 2 1 4\n[1000] 2 1 3 3 3 1 4 1 1 3 3 1 1 1 3 2 1 3 1 1 4 1 3 3 3 3 4 1 2 3 1 3 2 1 3 3 3\n[1037] 3 2 1 1 3 2 1 3 3 3 2 1 1 3 1 3 3 4 1 3 3 3 1 3 1 1 3 1 3 3 3 1 1 3 3 3 1\n[1074] 1 3 3 1 2 3 3 1 1 3 3 2 1 1 3 3 1 3 1 3 2 3 1 3 3 2 3 1 3 3 1 3 3 3 4 4 2\n[1111] 1 3 1 2 1 1 1 1 1 1 3 1 2 3 1 1 3 2 3 1 1 1 1 4 3 3 3 3 2 1 3 2 2 2 2 2 1\n[1148] 2 1 1 3 3 1 2 2 1 3 4 2 1 1 1 3 1 2 1 1 3 3 1 3 3 3 1 1 1 3 1 3 4 2 3 1 3\n[1185] 2 1 1 2 2 2 1 2 2 3 3 1 1 3 3 2 2 1 1 2 1 1 1 1 2 2 1 3 1 3 3 1 2 1 1 3 1\n[1222] 1 1 3 1 4 4 2 2 3 3 1 3 1 3 3 2 3 1 1 1 3 3 2 1 3 3 2 1 3 3 2 2 1 3 1 2 1\n[1259] 3 2 1 3 1 2 2 1 3 2 3 2 1 1 1 1 1 2 3 3 1 3 3 3 2 1 3 1 2 1 3 3 3 3 2 1 1\n[1296] 3 1 3 3 3 3 2 1 1 3 3 3 3 3 2 2 1 2 1 1 3 3 2 3 3 2 3 3 2 2 3 2 2 3 3 3 3\n[1333] 3 4 4 3 1 1 1 1 1 1 3 3 1 2 1 1 3 2 3 2 1 1 3 1 3 2 2 1 2 3 1 3 3 2 3 3 3\n[1370] 3 4 2 1 1 3 4 3 1 3 3 1 3 4 2 1 3 3 3 3 3 3 3 2 1 1 4 1 1 3 2 3 4 2 2 1 1\n[1407] 3 1 2 3 4 3 3 3 3 4 3 3 3 1 1 1 1 3 3 3 3 2 4 3 1 3 3 1 3 2 2 1 3 2 1 1 3\n[1444] 2 2 1 1 1 1 3 2 1 1 2 3 3 3 3 4 2 2 1 3 3 4 2 1 1 3 3 1 3 3 3 3 3 3 2 2 1\n[1481] 2 1 3 3 2 2 3 1 3 1 1 1 3 3 1 1 2 3 3 3 2 1 3 1 3 4 2 2 1 3 2 2 3 1 2 1 3\n[1518] 1 1 2 3 3 3 4 4 2 1 3 2 1 2 3 3 2 1 2 3 1 2 1 1 1 3 3 1 2 1 1 1 4 2 1 1 3\n[1555] 3 4 4 1 1 3 1 4 2 1 1 4 3 1 3 3 3 3 3 3 4 2 2 1 1 2 1 1 1 2 1 3 1 1 3 3 2\n[1592] 1 1 3 1 1 1 1 1 2 3 1 1 3 1 3 3 3 3 4 1 2 1 3 3 3 1 3 3 3 4 3 3 3 3 4 1 2\n[1629] 1 1 3 1 2 2 1 1 1 1 2 1 3\n\nWithin cluster sum of squares by cluster:\n[1] 1427.2032 1442.9566 1161.4081  669.2421\n (between_SS / total_SS =  52.2 %)\n\nAvailable components:\n\n[1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n[6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"\nLooks like this time, cluster 1 is all below average and cluster 5 is all above. Which cluster is Jalen Smith in?\nplayeradvcluster &lt;- data.frame(playersadvanced, advk4$cluster)\njsadv &lt;- playeradvcluster |&gt; filter(Player == \"Jalen Smith\")\n\njsadv\n\n       Player               Team Pos  PER   TS. PProd AST. WS.40  BPM\n1 Jalen Smith Maryland Terrapins   F 28.9 0.623   392  5.2 0.252 11.8\n  advk4.cluster\n1             2\nCluster 4 on my dataset. So in this season, we can say he’s in a big group of players who are all above average on these advanced metrics.\nNow who are his Big Ten peers?\nplayeradvcluster |&gt;\n  filter(advk4.cluster == 4) |&gt;\n  filter(Team %in% big10) |&gt;\n  arrange(desc(PProd))\n\n            Player                Team Pos   PER TS. PProd AST.  WS.40   BPM\n1 Harrison Hookfin Ohio State Buckeyes   F  -8.3 0.2     3    0 -0.206 -15.0\n2       Samad Qawi   Wisconsin Badgers   F -17.5 0.0     1    0 -0.206 -14.6\n3 Nathan Childress    Indiana Hoosiers   F  -6.0 0.0     1    0 -0.200 -27.3\n  advk4.cluster\n1             4\n2             4\n3             4\nSorting on Points Produced, Jalen Smith is third out of the 15 forwards in the Big Ten who land in Cluster 4. Seems advanced metrics rate Jalen Smith pretty highly.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Clustering</span>"
    ]
  },
  {
    "objectID": "simulations.html",
    "href": "simulations.html",
    "title": "14  Simulations",
    "section": "",
    "text": "14.1 Cold streaks\nDuring the final regular-season game in the 2021-22 season, Maryland’s men’s team, shooting .326 on the season from behind the arc, went 1-15 in the first half. How strange is that?\nset.seed(1234)\n\nsimulations &lt;- rbinom(n = 1000, size = 15, prob = .326)\n\nhist(simulations)\n\n\n\n\n\n\n\ntable(simulations)\n\nsimulations\n  0   1   2   3   4   5   6   7   8   9  10  11 \n  5  17  61 135 204 222 164  93  60  33   3   3\nShort answer: Pretty weird, but not totally unheard of. If you simulate 15 threes 1000 times, about 17 times it will result in a single made three-pointer. It’s slightly more common that the team would hit 9 threes out of 15. So going that cold is not totally out of the realm of random chance, but it’s pretty rare.",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Simulations</span>"
    ]
  },
  {
    "objectID": "simulations.html#the-hottest-of-streaks",
    "href": "simulations.html#the-hottest-of-streaks",
    "title": "14  Simulations",
    "section": "14.2 The hottest of streaks",
    "text": "14.2 The hottest of streaks\nLast season, Terps baseball player Sam Hojnar hit two home runs in consecutive games. He hit 16 HRs for the season in 233 at-bats, so his home run probability per at-bat was just under seven percent. We’ll use that and the number of games (56) to calculate the odds that he’d hit two home runs in each of two consecutive games.\n\n# Hojnar's statistics\nhome_runs &lt;- 16\ngames &lt;- 56\nat_bats &lt;- 233\n\n# Calculate probabilities\nhome_run_prob_per_at_bat &lt;- home_runs / at_bats\navg_at_bats_per_game &lt;- at_bats / games\n\n# Set simulation parameters\nnum_simulations &lt;- 100000\n\n# Run simulation\nset.seed(1234)  # For reproducibility\n\nsimulation_results &lt;- tibble(\n  sim = 1:num_simulations,\n  game1 = rbinom(num_simulations, round(avg_at_bats_per_game), home_run_prob_per_at_bat),\n  game2 = rbinom(num_simulations, round(avg_at_bats_per_game), home_run_prob_per_at_bat)\n) |&gt;\n  mutate(two_hr_each_game = game1 == 2 & game2 == 2)\n\n# Calculate probability\nprobability &lt;- simulation_results |&gt;\n  summarise(prob = mean(two_hr_each_game)) |&gt;\n  pull(prob)\n\n# Print results\ncat(\"Estimated probability of hitting exactly two home runs in each of two consecutive games:\", format(round(probability, 6), scientific = FALSE))\n\nEstimated probability of hitting exactly two home runs in each of two consecutive games: 0.0007\n\n\nLet’s parse that code. We set up our simulations as usual, with one change: because this already seems like a pretty rare event, we’re running 100,000 simulations, and we have to calculate the odds for two games, not one. Then we’re looking for results where the number of home runs in both games is two. The simulation_results dataframe shows that 70 times out of 100,000 Hojnar would hit two home runs in consecutive games, based on his own performance. That’s very, very, very unlikely, and quite a hot streak.",
    "crumbs": [
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Simulations</span>"
    ]
  },
  {
    "objectID": "barcharts.html",
    "href": "barcharts.html",
    "title": "15  Intro to ggplot with bar charts",
    "section": "",
    "text": "15.1 The bar chart\nThe easiest thing we can do is create a simple bar chart of our data. Bar charts show magnitude. They invite you to compare how much more or less one thing is compared to others.\nWe could, for instance, create a bar chart of the total attendance. To do that, we simply tell ggplot2 what our dataset is, what element of the data we want to make the bar chart out of (which is the aesthetic), and the geometry type (which is the geom). It looks like this:\nggplot() + geom_bar(data=top10, aes(x=Institution))\nNote: top10 is our data, aes means aesthetics, x=Institution explicitly tells ggplot2 that our x value – our horizontal value – is the Institution field from the data, and then we add on the geom_bar() as the geometry. And what do we get when we run that?\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(x=Institution)\n  )\nWe get … weirdness. We expected to see bars of different sizes, but we get all with a count of 1. What gives? Well, this is the default behavior. What we have here is something called a histogram, where ggplot2 helpfully counted up the number of times the Institution appears and counted them up. Since we only have one record per Institution, the count is always 1. How do we fix this? By adding weight to our aesthetic.\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(x=Institution, weight=`2023`)\n  )\nCloser. But … what order is that in? And what happened to our count numbers on the left? Why are they in scientific notation?\nLet’s deal with the ordering first. ggplot2’s default behavior is to sort the data by the x axis variable. So it’s in alphabetical order. To change that, we have to reorder it. With reorder, we first have to tell ggplot what we are reordering, and then we have to tell it HOW we are reordering it. So it’s reorder(FIELD, SORTFIELD).\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(\n      x=reorder(Institution, `2023`), \n      weight=`2023`\n      )\n    )\nBetter. We can argue about if the right order is smallest to largest or largest to smallest. But this gets us close. By the way, to sort it largest to smallest, put a negative sign in front of the sort field.\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(\n      x=reorder(Institution, -`2023`), \n      weight=`2023`\n      )\n    )",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Intro to ggplot with bar charts</span>"
    ]
  },
  {
    "objectID": "barcharts.html#scales",
    "href": "barcharts.html#scales",
    "title": "15  Intro to ggplot with bar charts",
    "section": "15.2 Scales",
    "text": "15.2 Scales\nTo fix the axis labels, we need try one of the other main elements of the ggplot2 library, which is transform a scale. More often that not, that means doing something like putting it on a logarithmic scale or some other kind of transformation. In this case, we’re just changing how it’s represented. The default in ggplot2 for large values is to express them as scientific notation. Rarely ever is that useful in our line of work. So we have to transform them into human readable numbers.\nThe easiest way to do this is to use a library called scales and it’s already installed.\n\nlibrary(scales)\n\n\nAttaching package: 'scales'\n\n\nThe following object is masked from 'package:purrr':\n\n    discard\n\n\nThe following object is masked from 'package:readr':\n\n    col_factor\n\n\nTo alter the scale, we add a piece to our plot with + and we tell it which scale is getting altered and what kind of data it is. In our case, our Y axis is what is needing to be altered, and it’s continuous data (meaning it can be any number between x and y, vs discrete data which are categorical). So we need to add scale_y_continuous and the information we want to pass it is to alter the labels with a function called comma.\n\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(\n      x=reorder(Institution, -`2023`), \n      weight=`2023`\n      )\n    ) + \n  scale_y_continuous(labels=comma)\n\n\n\n\n\n\n\n\nBetter.",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Intro to ggplot with bar charts</span>"
    ]
  },
  {
    "objectID": "barcharts.html#styling",
    "href": "barcharts.html#styling",
    "title": "15  Intro to ggplot with bar charts",
    "section": "15.3 Styling",
    "text": "15.3 Styling\nWe are going to spend a lot more time on styling, but let’s add some simple labels to this with a new bit called labs which is short for labels.\n\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(\n      x=reorder(Institution, -`2023`), \n      weight=`2023`)\n    ) + \n  scale_y_continuous(labels=comma) + \n  labs(\n    title=\"Top 10 Football Programs By Attendance\", \n    x=\"School\", \n    y=\"Attendance\"\n)\n\n\n\n\n\n\n\n\nThe library has lots and lots of ways to alter the styling – we can programmatically control nearly every part of the look and feel of the chart. One simple way is to apply themes in the library already. We do that the same way we’ve done other things – we add them. Here’s the light theme.\n\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(x=reorder(Institution, -`2023`),\n        weight=`2023`)) + \n  scale_y_continuous(labels=comma) + \n  labs(\n    title=\"Top 10 Football Programs By Attendance\", \n    x=\"School\", \n    y=\"Attendance\") + \n  theme_light()\n\n\n\n\n\n\n\n\nOr the minimal theme:\n\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(x=reorder(Institution, -`2023`),\n        weight=`2023`)) + \n  scale_y_continuous(labels=comma) + \n  labs(\n    title=\"Top 10 Football Programs By Attendance\", \n    x=\"School\", \n    y=\"Attendance\") + \n  theme_minimal()\n\n\n\n\n\n\n\n\nIf you like, you can write your own themes. For now, the built in ones will get us closer to something that looks good.",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Intro to ggplot with bar charts</span>"
    ]
  },
  {
    "objectID": "barcharts.html#one-last-trick-coord-flip",
    "href": "barcharts.html#one-last-trick-coord-flip",
    "title": "15  Intro to ggplot with bar charts",
    "section": "15.4 One last trick: coord flip",
    "text": "15.4 One last trick: coord flip\nSometimes, we don’t want vertical bars. Maybe we think this would look better horizontal. How do we do that? By adding coord_flip() to our code. It does what it says – it inverts the coordinates of the figures.\n\nggplot() + \n  geom_bar(\n    data=top10, \n    aes(x=reorder(Institution, -`2023`),\n        weight=`2023`)) + \n  scale_y_continuous(labels=comma) + \n  labs(\n    title=\"Top 10 Football Programs By Attendance\", \n    x=\"School\", \n    y=\"Attendance\") + \n  theme_minimal() + \n  coord_flip()",
    "crumbs": [
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Intro to ggplot with bar charts</span>"
    ]
  },
  {
    "objectID": "stackedbars.html",
    "href": "stackedbars.html",
    "title": "16  Stacked bar charts",
    "section": "",
    "text": "One of the elements of data visualization excellence is inviting comparison. Often that comes in showing what proportion a thing is in relation to the whole thing. With bar charts, we’re showing magnitude of the whole thing. If we have information about the parts of the whole, we can stack them on top of each other to compare them, showing both the whole and the components. And it’s a simple change to what we’ve already done.\nWe’re going to use a dataset of college basketball games from this past season.\nFor this walkthrough:\n   Download csv file\n\nLoad the tidyverse.\n\nlibrary(tidyverse)\n\nAnd the data.\n\ngames &lt;- read_csv(\"data/logs24.csv\")\n\nRows: 11990 Columns: 48\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (8): Season, TeamFullName, Opponent, HomeAway, W_L, URL, Conference, Team\ndbl  (39): Game, TeamScore, OpponentScore, TeamFG, TeamFGA, TeamFGPCT, Team3...\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWhat we have here is every game in college basketball this past season. The question we want to answer is this: Who were the best rebounders in the Big Ten? And what role did offensive and defensive rebounds play in making that happen?\nSo to make this chart, we have to just add one thing to a bar chart like we did in the previous chapter. However, it’s not that simple.\nWe have game data, and we need season data. To get that, we need to do some group by and sum work. And since we’re only interested in the Big Ten, we have some filtering to do too. For this, we’re going to measure offensive rebounds and total rebounds, and then we can calculate defensive rebounds. So if we have all the games a team played, and the offensive rebounds and total rebounds for each of those games, what we need to do to get the season totals is just add them up.\n\ngames |&gt; \n  filter(!is.na(TeamTotalRebounds)) |&gt; \n  group_by(Conference, Team) |&gt; \n  summarise(\n    SeasonOffRebounds = sum(TeamOffRebounds),\n    SeasonTotalRebounds = sum(TeamTotalRebounds)\n  ) |&gt;\n  mutate(\n    SeasonDefRebounds = SeasonTotalRebounds - SeasonOffRebounds\n  ) |&gt; \n  select(\n    -SeasonTotalRebounds\n  ) |&gt; \n  filter(Conference == \"Big Ten MBB\")\n\n# A tibble: 14 × 4\n# Groups:   Conference [1]\n   Conference  Team           SeasonOffRebounds SeasonDefRebounds\n   &lt;chr&gt;       &lt;chr&gt;                      &lt;dbl&gt;             &lt;dbl&gt;\n 1 Big Ten MBB Illinois                     423              1000\n 2 Big Ten MBB Indiana                      254               803\n 3 Big Ten MBB Iowa                         279               823\n 4 Big Ten MBB Maryland                     332               734\n 5 Big Ten MBB Michigan                     286               720\n 6 Big Ten MBB Michigan State               305               807\n 7 Big Ten MBB Minnesota                    272               785\n 8 Big Ten MBB Nebraska                     277               899\n 9 Big Ten MBB Northwestern                 248               742\n10 Big Ten MBB Ohio State                   338               889\n11 Big Ten MBB Penn State                   264               704\n12 Big Ten MBB Purdue                       425              1044\n13 Big Ten MBB Rutgers                      332               736\n14 Big Ten MBB Wisconsin                    309               797\n\n\nBy looking at this, we can see we got what we needed. We have 14 teams and numbers that look like season totals for two types of rebounds. Save that to a new dataframe.\n\ngames |&gt; \n  filter(!is.na(TeamTotalRebounds)) |&gt; \n  group_by(Conference, Team) |&gt; \n  summarise(\n    SeasonOffRebounds = sum(TeamOffRebounds),\n    SeasonTotalRebounds = sum(TeamTotalRebounds)\n  ) |&gt;\n  mutate(\n    SeasonDefRebounds = SeasonTotalRebounds - SeasonOffRebounds\n  ) |&gt; \n  select(\n    -SeasonTotalRebounds\n  ) |&gt; \n  filter(Conference == \"Big Ten MBB\") -&gt; rebounds\n\nNow, the problem we have is that ggplot wants long data and this data is wide. So we need to use tidyr to make it long, just like we did in the transforming data chapter.\n\nrebounds |&gt; \n  pivot_longer(\n    cols=starts_with(\"Season\"), \n    names_to=\"Type\", \n    values_to=\"Rebounds\")\n\n# A tibble: 28 × 4\n# Groups:   Conference [1]\n   Conference  Team     Type              Rebounds\n   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;                &lt;dbl&gt;\n 1 Big Ten MBB Illinois SeasonOffRebounds      423\n 2 Big Ten MBB Illinois SeasonDefRebounds     1000\n 3 Big Ten MBB Indiana  SeasonOffRebounds      254\n 4 Big Ten MBB Indiana  SeasonDefRebounds      803\n 5 Big Ten MBB Iowa     SeasonOffRebounds      279\n 6 Big Ten MBB Iowa     SeasonDefRebounds      823\n 7 Big Ten MBB Maryland SeasonOffRebounds      332\n 8 Big Ten MBB Maryland SeasonDefRebounds      734\n 9 Big Ten MBB Michigan SeasonOffRebounds      286\n10 Big Ten MBB Michigan SeasonDefRebounds      720\n# … with 18 more rows\n\n\nWhat you can see now is that we have two rows for each team: one for offensive rebounds, one for defensive rebounds. This is what ggplot needs. Save it to a new dataframe.\n\nrebounds |&gt; \n  pivot_longer(\n    cols=starts_with(\"Season\"), \n    names_to=\"Type\", \n    values_to=\"Rebounds\") -&gt; reboundswide\n\nBuilding on what we learned in the last chapter, we know we can turn this into a bar chart with an x value, a weight and a geom_bar. What we are going to add is a fill. The fill will stack bars on each other based on which element it is. In this case, we can fill the bar by Type, which means it will stack the number of offensive rebounds on top of defensive rebounds and we can see how they compare.\n\nggplot() + \n  geom_bar(\n    data=reboundswide, \n    aes(x=Team, weight=Rebounds, fill=Type)) + \n  coord_flip()\n\n\n\n\n\n\n\n\nWhat’s the problem with this chart?\nThere’s a couple of things, one of which we’ll deal with now: The ordering is alphabetical (from the bottom up). So let’s reorder the teams by Rebounds.\n\nggplot() + \n  geom_bar(\n    data=reboundswide, \n    aes(x=reorder(Team, Rebounds), \n        weight=Rebounds, \n        fill=Type)) + \n  coord_flip()\n\n\n\n\n\n\n\n\nAnd just like that … Purdue, the team with the best record in the league, comes out on top. Maryland is ninth, which seems a little worse than its record would indicate.",
    "crumbs": [
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Stacked bar charts</span>"
    ]
  },
  {
    "objectID": "circularbarcharts.html",
    "href": "circularbarcharts.html",
    "title": "17  Circular bar plots",
    "section": "",
    "text": "17.1 Does November basketball matter?\nSo let’s test the notion of November Basketball Doesn’t Matter. What matters in basketball? Let’s start simple: Wins.\nSports Reference’s win columns are weird, so we need to scan through them and find W and L and we’ll give them numbers using case_when. I’ll also filter out post-season tournament games.\nwinlosslogs &lt;- logs |&gt; \n  filter(Date &lt; '2024-03-15') |&gt; \n  mutate(winloss = case_when(\n    grepl(\"W\", W_L) ~ 1, \n    grepl(\"L\", W_L) ~ 0)\n)\nWe can group by date and conference and sum up the wins. How many wins by day does each conference get?\ndates &lt;- winlosslogs |&gt; group_by(Date, Conference) |&gt; summarise(wins = sum(winloss))\n\n`summarise()` has grouped output by 'Date'. You can override using the\n`.groups` argument.\nEarlier, we did stacked bar charts. We have what we need to do that now.\nggplot() + geom_bar(data=dates, aes(x=Date, weight=wins, fill=Conference)) + theme_minimal()\nEeek. This is already looking not great. But to make it a circular bar chart, we add coord_polar() to our chart.\nggplot() + geom_bar(data=dates, aes(x=Date, weight=wins, fill=Conference)) + theme_minimal() + coord_polar()\nBased on that, the day is probably too thin a slice, and there’s way too many conferences in college basketball. Let’s group this by months and filter out all but the power five conferences.\np5 &lt;- c(\"SEC WBB\", \"Big Ten WBB\", \"Pac-12 WBB\", \"Big 12 WBB\", \"ACC WBB\")\nTo get months, we’re going to use a function in the library lubridate called floor_date, which combine with mutate will give us a field of just months.\nwins &lt;- winlosslogs |&gt; mutate(month = floor_date(Date, unit=\"months\")) |&gt; group_by(month, Conference) |&gt; summarise(wins=sum(winloss)) |&gt; filter(Conference %in% p5) \n\n`summarise()` has grouped output by 'month'. You can override using the\n`.groups` argument.\nNow we can use wins to make our circular bar chart of wins by month in the Power Five.\nggplot() + geom_bar(data=wins, aes(x=month, weight=wins, fill=Conference)) + theme_minimal() + coord_polar()\nYikes. That looks a lot like a broken pie chart. So months are too thick of a slice. Let’s use weeks in our floor date to see what that gives us.\nwins &lt;- winlosslogs |&gt; mutate(week = floor_date(Date, unit=\"weeks\")) |&gt; group_by(week, Conference) |&gt; summarise(wins=sum(winloss)) |&gt; filter(Conference %in% p5) \n\n`summarise()` has grouped output by 'week'. You can override using the\n`.groups` argument.\nggplot() + geom_bar(data=wins, aes(x=week, weight=wins, fill=Conference)) + theme_minimal() + coord_polar()\nThat looks better. But what does it say? Does November basketball matter? What this is saying is … yeah, it kinda does. The reason? Lots of wins get piled up in November and December, during non-conference play. So if you are a team with NCAA tournament dreams, you need to win games in November to make sure your tournament resume is where it needs to be come March. Does an individual win or loss matter? Probably not. But your record in November does.",
    "crumbs": [
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Circular bar plots</span>"
    ]
  },
  {
    "objectID": "circularbarcharts.html#does-it-show-you-where-you-are",
    "href": "circularbarcharts.html#does-it-show-you-where-you-are",
    "title": "17  Circular bar plots",
    "section": "17.2 Does it show you where you are?",
    "text": "17.2 Does it show you where you are?\nSo here is the problem we have:\n\nWe have data for every game. In the past, we were able to calculate the team wins and losses because the way the data records them is team is the main team, and they win or lose. The opponent is recorded, but not in its own column of that name. In addition, the opponent has the mirror image of this game as well, where they are team. So essentially every game is in here twice – one for each team that plays in the game.\nWe need to attach the opponent’s winning percentage to each game so we can decide if it’s a quality win for team.\n\nFirst we need to populate opponent based on the whatever is not the team. Then what we have to do is invert the process that we’ve done before. We need to group by the opponent and we need to invert the wins and losses. A win in the win column is a win for the team. That means each loss in the win column is a WIN for the opponent.\nOnce we invert, the data looks very similar to what we’ve done before. One other thing: I noticed there’s some tournament games in here, so the filter at the end strips them out like we did before.\n\noppwinlosslogs &lt;- logs |&gt; \n  mutate(winloss = case_when(\n    grepl(\"W\", W_L) ~ 0, \n    grepl(\"L\", W_L) ~ 1)\n) |&gt; \n  filter(Date &lt; \"2024-03-15\")\n\nSo now we have a dataframe called oppwinlosslogs that has an inverted winloss column. So now we can group by the Opponent and sum the wins and it will tell us how many games the Opponent won. We can also count the wins and get a winning percentage.\n\noppwinlosslogs |&gt; group_by(Opponent) |&gt; summarise(games=n(), wins=sum(winloss)) |&gt; mutate(winpct = wins/games) -&gt; opprecord\n\nNow we have a dataframe of 614 opponent winning records. Wait, what? There’s like ~350 teams in major college basketball, so why 614? If you look through it, there’s a bunch of teams playing lower level teams. Given that they are lower level, they’re likely cannon fodder and will lose the game, and we’re going to filter them out in a minute.\nNow we can join the opponent winning percentage to our winlosslogs data so we can answer our question about quality wins.\n\nwinlosslogs &lt;- logs |&gt; \n  mutate(winloss = case_when(\n    grepl(\"W\", W_L) ~ 1, \n    grepl(\"L\", W_L) ~ 0)\n) |&gt; \n  filter(Date &lt; \"2024-03-15\")\n\n\nwinlosslogs |&gt; left_join(opprecord, by=(\"Opponent\")) -&gt; winswithopppct\n\nNow that we have a table called winswithopppct, we can filter out non-power 5 teams and teams that won less than 60 percent of their games and run the same calculations in the book.\n\np5 &lt;- c(\"SEC WBB\", \"Big Ten WBB\", \"Pac-12 WBB\", \"Big 12 WBB\", \"ACC WBB\")\n\n\nwinswithopppct |&gt; filter(winpct &gt; .6) |&gt; mutate(week = floor_date(Date, unit=\"weeks\")) |&gt; group_by(week, Conference) |&gt; summarise(wins=sum(winloss)) |&gt; filter(Conference %in% p5) -&gt; qualitywins\n\n`summarise()` has grouped output by 'week'. You can override using the\n`.groups` argument.\n\n\nNow with our dataframe called qualitywins, we can chart it again.\n\nggplot() + geom_bar(data=qualitywins, aes(x=week, weight=wins, fill=Conference)) + theme_minimal() + coord_polar()\n\n\n\n\n\n\n\n\nLook at this chart and compare it to the first one.",
    "crumbs": [
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Circular bar plots</span>"
    ]
  },
  {
    "objectID": "wafflecharts.html",
    "href": "wafflecharts.html",
    "title": "18  Waffle charts",
    "section": "",
    "text": "18.1 Making waffles with vectors\nLet’s look at Maryland’s football game against Michigan State this season. Here’s the box score, which we’ll use for this part of the walkthrough.\nMaybe the easiest way to do waffle charts, at least at first, is to make vectors of your data and plug them in. To make a vector, we use the c or concatenate function.\nSo let’s look at offense. Net rushing vs passing.\nmd &lt;- c(\"Rushing\"=175, \"Passing\"=314)\nms &lt;- c(\"Rushing\"=100, \"Passing\"=221)\nSo what does the breakdown of the night look like?\nThe waffle library can break this down in a way that’s easier on the eyes than a pie chart. We call the library, add the data, specify the number of rows, give it a title and an x value label, and to clean up a quirk of the library, we’ve got to specify colors.\nwaffle(\n        md, \n        rows = 10, \n        title=\"Maryland's offense\", \n        xlab=\"1 square = 1 yard\", \n        colors = c(\"black\", \"red\")\n)\nOr, we could make this two teams in the same chart.\npassing &lt;- c(\"Maryland\"=314, \"Michigan State\"=221)\nwaffle(\n        passing, \n        rows = 10, \n        title=\"Maryland vs Michigan State: passing\", \n        xlab=\"1 square = 1 yard\", \n        colors = c(\"red\", \"green\")\n)\nSo what does it look like if we compare the two teams using the two vectors in the same chart? To do that – and I am not making this up – you have to create a waffle iron. Get it? Waffle charts? Iron?\niron(\n waffle(md, \n        rows = 10, \n        title=\"Maryland's offense\", \n        xlab=\"1 square = 1 yard\", \n        colors = c(\"black\", \"red\")\n        ),\n waffle(ms, \n        rows = 10, \n        title=\"Michigan State's offense\", \n        xlab=\"1 square = 1 yard\", \n        colors = c(\"black\", \"green\")\n        )\n)\nWhat do you notice about this chart? Notice how the squares aren’t the same size? Well, Maryland out-gained Michigan State by a long way. So the squares aren’t the same size because the numbers aren’t the same. We can fix that by adding an unnamed padding number so the number of yards add up to the same thing. Let’s make the total for everyone be 489, Maryland’s total yards of offense. So to do that, we need to add a padding of 168 to Michigan State. REMEMBER: Don’t name it or it’ll show up in the legend.\nmd &lt;- c(\"Rushing\"=175, \"Passing\"=314)\nms &lt;- c(\"Rushing\"=100, \"Passing\"=221, 168)\nNow, in our waffle iron, if we don’t give that padding a color, we’ll get an error. So we need to make it white. Which, given our white background, means it will disappear.\niron(\n waffle(md, \n        rows = 10, \n        title=\"Maryland's offense\", \n        xlab=\"1 square = 1 yard\", \n        colors = c(\"black\", \"red\")\n        ),\n waffle(ms, \n        rows = 10, \n        title=\"Michigan State's offense\", \n        xlab=\"1 square = 1 yard\",\n        colors = c(\"black\", \"green\", \"white\")\n        )\n)\nOne last thing we can do is change the 1 square = 1 yard bit – which makes the squares really small in this case – by dividing our vector. Look, it’s math on vectors!\niron(\n waffle(md/2, \n        rows = 10, \n        title=\"Maryland's offense\", \n        xlab=\"1 square = 1 yard\", \n        colors = c(\"black\", \"red\")\n        ),\n waffle(ms/2, \n        rows = 10, \n        title=\"Michigan State's offense\", \n        xlab=\"1 square = 1 yard\",\n        colors = c(\"black\", \"green\", \"white\")\n        )\n)\nNews flash: Michigan State is changing its fight song to “Everybody Hurts” by REM.",
    "crumbs": [
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Waffle charts</span>"
    ]
  },
  {
    "objectID": "linecharts.html",
    "href": "linecharts.html",
    "title": "19  Line charts",
    "section": "",
    "text": "19.1 This is too simple.\nWith datasets, we want to invite comparison. So let’s answer the question visually. Let’s put two lines on the same chart. How does Maryland compare to Illinois, for example?\nill &lt;- logs |&gt; filter(Team == \"Illinois\")\nIn this case, because we have two different datasets, we’re going to put everything in the geom instead of the ggplot step. We also have to explicitly state what dataset we’re using by saying data= in the geom step.\nFirst, let’s chart Maryland. Read carefully. First we set the data. Then we set our aesthetic. Unlike bars, we need an X and a Y variable. In this case, our X is the date of the game, Y is the thing we want the lines to move with. In this case, the Team Field Goal Percentage – TeamFGPCT.\nggplot() + geom_line(data=umd, aes(x=Date, y=TeamFGPCT), color=\"red\")\nNow, by using +, we can add Illinois to it. REMEMBER COPY AND PASTE IS A THING. Nothing changes except what data you are using.\nggplot() + \n  geom_line(data=umd, aes(x=Date, y=TeamFGPCT), color=\"red\") + \n  geom_line(data=ill, aes(x=Date, y=TeamFGPCT), color=\"orange\")\nLet’s flatten our lines out by zeroing the Y axis. We’ll set the upper limit of the y-axis to 0.70 because Illinois shot fantastically well in one December game.\nggplot() + \n  geom_line(data=umd, aes(x=Date, y=TeamFGPCT), color=\"red\") + \n  geom_line(data=ill, aes(x=Date, y=TeamFGPCT), color=\"orange\") + \n  scale_y_continuous(limits = c(0, .70))\nSo visually speaking, the difference between Maryland and Illinois’ season is that while both had some significant variations shooting the ball, Illinois’ positive outliers were greater and Maryland’s low points were lower - especially after conference play started.",
    "crumbs": [
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Line charts</span>"
    ]
  },
  {
    "objectID": "linecharts.html#but-what-if-i-wanted-to-add-a-lot-of-lines.",
    "href": "linecharts.html#but-what-if-i-wanted-to-add-a-lot-of-lines.",
    "title": "19  Line charts",
    "section": "19.2 But what if I wanted to add a lot of lines.",
    "text": "19.2 But what if I wanted to add a lot of lines.\nFine. How about all Power Five Schools? This data for example purposes. You don’t have to do it.\n\npowerfive &lt;- c(\"SEC MBB\", \"Big Ten MBB\", \"Pac-12 MBB\", \"Big 12 MBB\", \"ACC MBB\")\n\np5conf &lt;- logs |&gt; filter(Conference %in% powerfive)\n\nI can keep layering on layers all day if I want. And if my dataset has more than one team in it, I need to use the group command. And, the layering comes in order – so if you’re going to layer a bunch of lines with a smaller group of lines, you want the bunch on the bottom. So to do that, your code stacks from the bottom. The first geom in the code gets rendered first. The second gets layered on top of that. The third gets layered on that and so on.\n\nggplot() + \n  geom_line(data=p5conf, aes(x=Date, y=TeamFGPCT, group=Team), color=\"grey\") + \n  geom_line(data=umd, aes(x=Date, y=TeamFGPCT), color=\"red\") + \n  geom_line(data=ill, aes(x=Date, y=TeamFGPCT), color=\"orange\") + \n  scale_y_continuous(limits = c(0, .65))\n\nWarning: Removed 1 row containing missing values (`geom_line()`).\n\n\n\n\n\n\n\n\n\nWhat do we see here? How have Maryland’s and Illinois’ seasons evolved against all the rest of the teams in college basketball?\nBut how does that compare to the average? We can add that pretty easily by creating a new dataframe with it and add another geom_line.\n\naverage &lt;- logs |&gt; group_by(Date) |&gt; summarise(mean_shooting=mean(TeamFGPCT))\n\n\nggplot() + \n  geom_line(data=p5conf, aes(x=Date, y=TeamFGPCT, group=Team), color=\"grey\") + \n  geom_line(data=umd, aes(x=Date, y=TeamFGPCT), color=\"red\") + \n  geom_line(data=ill, aes(x=Date, y=TeamFGPCT), color=\"orange\") + \n  geom_line(data=average, aes(x=Date, y=mean_shooting), color=\"black\") + \n  scale_y_continuous(limits = c(0, .70))",
    "crumbs": [
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Line charts</span>"
    ]
  },
  {
    "objectID": "stepcharts.html",
    "href": "stepcharts.html",
    "title": "20  Step charts",
    "section": "",
    "text": "Step charts are a method of showing progress toward something. They combine showing change over time – cumulative change over time – with magnitude. They’re good at inviting comparison.\nThere’s great examples out there. First is the Washington Post looking at Lebron passing Jordan’s career point total. Another is John Burn-Murdoch’s work at the Financial Times (which is paywalled) about soccer stars. Here’s an example of his work outside the paywall.\nTo replicate this, we need cumulative data – data that is the running total of data at a given point. So think of it this way – Maryland scores 50 points in a basketball game and then 50 more the next, their cumulative total at two games is 100 points.\nStep charts can be used for all kinds of things – showing how a player’s career has evolved over time, how a team fares over a season, or franchise history. Let’s walk through an example.\nLet’s look at Maryland’s women basketball team last season.\nFor this walkthrough:\n   Download csv file\n\nWe’ll need the tidyverse.\n\nlibrary(tidyverse)\n\nAnd we need to load our logs data we just downloaded.\n\nlogs &lt;- read_csv(\"data/wbblogs24.csv\")\n\nRows: 11503 Columns: 48\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (8): Season, TeamFullName, Opponent, HomeAway, W_L, URL, Conference, Team\ndbl  (39): Game, TeamScore, OpponentScore, TeamFG, TeamFGA, TeamFGPCT, Team3...\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nHere we’re going to look at the scoring differential of teams. If you score more than your opponent, you win. So it stands to reason that if you score a lot more than your opponent over the course of a season, you should be very good, right? Let’s see.\nThe first thing we’re going to do is calculate that differential. Then, we’ll group it by the team. After that, we’re going to summarize using a new function called cumsum or cumulative sum – the sum for each game as we go forward. So game 1’s cumsum is the differential of that game. Game 2’s cumsum is Game 1 + Game 2. Game 3 is Game 1 + 2 + 3 and so on.\n\ndifflogs &lt;- logs |&gt; \n  mutate(Differential = TeamScore - OpponentScore) |&gt; \n  group_by(TeamFullName) |&gt; \n  mutate(CumDiff = cumsum(Differential))\n\nNow that we have the cumulative sum for each, let’s filter it down to just Big Ten teams.\n\nbigdiff &lt;- difflogs |&gt; filter(Conference == \"Big Ten WBB\")\n\nThe step chart is it’s own geom, so we can employ it just like we have the others. It works almost exactly the same as a line chart, but it uses the cumulative sum instead of a regular value and, as the name implies, creates a step like shape to the line instead of a curve.\n\nggplot() + geom_step(data=bigdiff, aes(x=Date, y=CumDiff, group=Team))\n\n\n\n\n\n\n\n\nLet’s try a different element of the aesthetic: color, but this time inside the aesthetic. Last time, we did the color outside. When you put it inside, you pass it a column name and ggplot will color each line based on what thing that is, and it will create a legend that labels each line that thing.\n\nggplot() + geom_step(data=bigdiff, aes(x=Date, y=CumDiff, group=Team, color=Team))\n\n\n\n\n\n\n\n\nFrom this, we can see a handful of teams in the Big Ten had negative point differentials last season. But which is which? And which one is Maryland? Too many colors and it’s too hard to tell. How to sort that out? Let’s add some helpers beyond layering.\nLet’s look at Maryland, plus another team: Illinois\n\numd &lt;- bigdiff |&gt; filter(Team == \"Maryland\")\nill &lt;- bigdiff |&gt; filter(Team == \"Illinois\")\n\nLet’s introduce a couple of new things here. First, note when I take the color OUT of the aesthetic, the legend disappears.\nThe second thing I’m going to add is the annotation layer. In this case, I am adding a text annotation layer, and I can specify where by adding in a x and a y value where I want to put it. This takes some finesse. After that, I’m going to add labels and a theme.\n\nggplot() + \n  geom_step(data=bigdiff, aes(x=Date, y=CumDiff, group=Team), color=\"light grey\") +\n  geom_step(data=umd, aes(x=Date, y=CumDiff, group=Team), color=\"red\") + \n  geom_step(data=ill, aes(x=Date, y=CumDiff, group=Team), color=\"orange\") +\n  annotate(\"text\", x=(as.Date(\"2023-12-10\")), y=300, label=\"Illinois\") +\n  annotate(\"text\", x=(as.Date(\"2024-02-01\")), y=150, label=\"Maryland\") +\n  labs(\n    x=\"Date\", \n    y=\"Cumulative Point Differential\", \n    title=\"Maryland's Uphill Climb, Illinois Hits Plateau\", \n    subtitle=\"The Terps were middle of the pack in point differential.\", \n    caption=\"Source: Sports-Reference.com | By Derek Willis\") +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Step charts</span>"
    ]
  },
  {
    "objectID": "dumbbellcharts.html",
    "href": "dumbbellcharts.html",
    "title": "21  Dumbbell and lollipop charts",
    "section": "",
    "text": "21.1 Dumbbell plots\nFor this, let’s use college volleyball game logs from this season.\nAnd load it.\nlogs &lt;- read_csv(\"data/ncaa_womens_volleyball_matchstats_2023.csv\")\n\nRows: 9957 Columns: 39\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (4): team, opponent, home_away, result\ndbl  (34): ncaa_id, team_score, opponent_score, s, kills, errors, total_atta...\ndate  (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nFor the first example, let’s look at the difference between a team’s errors versus their opponents’ errors. To get this, we’re going to add up all errors and opponent errors for a team in a season and take a look at where they come out. To make this readable, I’m going to focus on the Big Ten.\nbig10 &lt;- c(\"Nebraska Cornhuskers\", \"Iowa Hawkeyes\", \"Minnesota Golden Gophers\", \"Illinois Fighting Illini\", \"Northwestern Wildcats\", \"Wisconsin Badgers\", \"Indiana Hoosiers\", \"Purdue Boilermakers\", \"Ohio State Buckeyes\", \"Michigan Wolverines\", \"Michigan State Spartans\", \"Penn State Nittany Lions\", \"Rutgers Scarlet Knights\", \"Maryland Terrapins, Terps\")\n\nerrors &lt;- logs |&gt;\n  filter(team %in% big10) |&gt; \n  group_by(team) |&gt; \n  summarise(\n    total_errors = sum(errors), \n    opp_errors = sum(defensive_errors))\nNow, the way that the geom_dumbbell works is pretty simple when viewed through what we’ve done before. There’s just some tweaks.\nFirst: We start with the y axis. The reason is we want our dumbbells going left and right, so the label is going to be on the y axis.\nSecond: Our x is actually two things: x and xend. What you put in there will decide where on the line the dot appears.\nggplot() + \n  geom_dumbbell(\n    data=errors, \n    aes(y=team, x=total_errors, xend=opp_errors)\n  )\n\nWarning: Using the `size` aesthetic with geom_segment was deprecated in ggplot2 3.4.0.\nℹ Please use the `linewidth` aesthetic instead.\nWell, that’s a chart alright, but what dot is the team errors and what are the opponent errors? To fix this, we’ll add colors.\nSo our choice of colors here is important. We want team errors to be seen as bad and opponent errors to be seen as good. So lets try red for team errors and green for opponent errors To make this work, we’ll need to do three things: first, use the English spelling of color, so colour. The, uh, colour is the bar between the dots, the x_colour is the color of the x value dot and the xend_colour is the color of the xend dot. So in our setup, defensive errors are x, they’re good, so they’re green.\nggplot() + \n  geom_dumbbell(\n    data=errors, \n    aes(y=team, x=opp_errors, xend=total_errors),\n    colour = \"grey\",\n    colour_x = \"green\",\n    colour_xend = \"red\")\nBetter. Let’s make two more tweaks. First, let’s make the whole thing bigger with a size element. And let’s add theme_minimal to clean out some cruft.\nggplot() + \n  geom_dumbbell(\n    data=errors, \n    aes(y=team, x=opp_errors, xend=total_errors),\n    size = 1,\n    color = \"grey\",\n    colour_x = \"green\",\n    colour_xend = \"red\") + \n  theme_minimal()\nAnd now we have a chart that tells a story – got green on the right? That’s good. A long distance between green and red? Better. But what if we sort it by good errors?\nggplot() + \n  geom_dumbbell(\n    data=errors, \n    aes(y=reorder(team, opp_errors), x=opp_errors, xend=total_errors),\n    linewidth = 1,\n    color = \"grey\",\n    colour_x = \"green\",\n    colour_xend = \"red\") + \n  theme_minimal()\n\nWarning in geom_dumbbell(data = errors, aes(y = reorder(team, opp_errors), :\nIgnoring unknown parameters: `linewidth`\nMaryland’s opponents have committed some errors - that’s good news for the Terps - but there’s a clear gap between Maryland and the top teams in the conference when it comes to committing errors.",
    "crumbs": [
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Dumbbell and lollipop charts</span>"
    ]
  },
  {
    "objectID": "dumbbellcharts.html#dumbbell-plots",
    "href": "dumbbellcharts.html#dumbbell-plots",
    "title": "21  Dumbbell and lollipop charts",
    "section": "",
    "text": "For this walkthrough:\n   Download csv file",
    "crumbs": [
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Dumbbell and lollipop charts</span>"
    ]
  },
  {
    "objectID": "dumbbellcharts.html#lollipop-charts",
    "href": "dumbbellcharts.html#lollipop-charts",
    "title": "21  Dumbbell and lollipop charts",
    "section": "21.2 Lollipop charts",
    "text": "21.2 Lollipop charts\nSticking with takeaways, lollipops are similar to bar charts in that they show magnitude. And like dumbbells, they are similar in that we start with a y – the traditional lollipop chart is on its side – and we only need one x. The only additional thing we need to add is that we need to tell it that it is a horizontal chart.\n\nggplot() + \n  geom_lollipop(\n    data=errors, \n    aes(y=team, x=opp_errors), \n    horizontal = TRUE\n    )\n\n\n\n\n\n\n\n\nWe can do better than this with a simple theme_minimal and some better labels.\n\nggplot() + \n  geom_lollipop(\n    data=errors, \n    aes(y=reorder(team, opp_errors), x=opp_errors), \n    horizontal = TRUE\n    ) + theme_minimal() + \n  labs(title = \"Wisconsin, Purdue force more errors\", y=\"team\")\n\n\n\n\n\n\n\n\nHow about some layering?\n\nmd &lt;- errors |&gt; filter(team == \"Maryland Terrapins, Terps\")\n\n\nggplot() + \n  geom_lollipop(\n    data=errors, \n    aes(y=reorder(team, opp_errors), x=opp_errors), \n    horizontal = TRUE\n    ) + \n  geom_lollipop(\n    data=md,\n    aes(y=team, x=opp_errors),\n    horizontal = TRUE,\n    color = \"red\"\n  ) + \n  theme_minimal() + \n  labs(title = \"Maryland middle of the pack among Big Ten teams\", y=\"team\")\n\n\n\n\n\n\n\n\nThe headline says it all.",
    "crumbs": [
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Dumbbell and lollipop charts</span>"
    ]
  },
  {
    "objectID": "scatterplots.html",
    "href": "scatterplots.html",
    "title": "22  Scatterplots",
    "section": "",
    "text": "22.1 Let’s see it fail\nScatterplots also are useful for shooting down the hottest of takes. What about fouls? Are they related to wins in field hockey?\nfouls_wins &lt;- winlosslogs |&gt; \n  group_by(team) |&gt; \n  summarise(\n    wins = sum(winloss),\n    total_fouls = sum(fouls)\n    ) |&gt; \n  na.omit()\nNow we can chart it and see what our relationship looks like.\nggplot() + \n  geom_point(data=fouls_wins, aes(x=total_fouls, y=wins)) +\n  geom_smooth(data=fouls_wins, aes(x=total_fouls, y=wins), method=\"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\nThe downward slope from left to right indicates a negative relationship - the more fouls a team commits, the fewer wins it has. But the line here isn’t very steep at all, and you can see the dots spread widely around the plot. So there’s some kind of relationship, but how strong is it?\nLet’s get our linear regression stats.\nfoulsfit &lt;- lm(wins ~ total_fouls, data = fouls_wins)\nsummary(foulsfit)\n\n\nCall:\nlm(formula = wins ~ total_fouls, data = fouls_wins)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.6068 -3.0455 -0.0555  3.1984 10.8989 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 10.101065   0.705584  14.316   &lt;2e-16 ***\ntotal_fouls -0.004753   0.003253  -1.461    0.148    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.478 on 80 degrees of freedom\nMultiple R-squared:  0.02598,   Adjusted R-squared:  0.01381 \nF-statistic: 2.134 on 1 and 80 DF,  p-value: 0.148\nThe p-value is a fair bit above 0.05, so the impact of fouls to wins (or losses) could just be random. The adjusted R-squared is all of 1 percent. We’ve do not have something here. Let’s use our coefficients to look at Maryland’s 2022-23 season.\n(-0.004753 * 12) + 10.101065\n\n[1] 10.04403\nThis model says that based only on Maryland’s fouls, they should have won 10 games. They won 19. Maybe not a great model for many teams.\nThe power in combining scatterplots + regression is that we can answer two questions: is there a relationship, and how meaningful is it?",
    "crumbs": [
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Scatterplots</span>"
    ]
  },
  {
    "objectID": "bubblecharts.html",
    "href": "bubblecharts.html",
    "title": "23  Bubble charts",
    "section": "",
    "text": "Here is the real talk: Bubble charts are hard. The reason they are hard is not because of the code, or the complexity or anything like that. They’re a scatterplot with magnitude added – the size of the dot in the scatterplot has meaning. The hard part is seeing when a bubble chart works and when it doesn’t.\nIf you want to see it work spectacularly well, watch a semi-famous Ted Talk by Hans Rosling from 2006 where bubble charts were the centerpiece. It’s worth watching. It’ll change your perspective on the world. No seriously. It will.\nAnd since then, people have wanted bubble charts. And we’re back to the original problem: They’re hard. There’s a finite set of circumstances where they work.\nHere’s one: placing players or teams into groups based on performance.\nI’m going to load up my libraries.\n\nlibrary(tidyverse)\n\nSo for this example, I want to look at where Big Ten teams compare to the rest of college football last season. Is the Big Ten’s reputation for tough games and defenses earned? Can we see patterns in good team vs bad teams?\nI’m going to create a scatterplot with offensive yards per play on the X axis and defensive yards per play on the y axis. We can then divide the grid into four quadrants. Teams with high yards per offensive play and low defensive yards per play are teams with good offenses and good defenses. The opposite means bad defense, bad offense. Then, to drive the point home, I’m going to make the dot the size of the total wins on the season – the bubble in my bubble charts.\nWe’ll use last season’s college football games.\nFor this walkthrough:\n   Download csv file\n\nAnd load it.\n\nlogs &lt;- read_csv(\"data/footballlogs22.csv\")\n\nRows: 1672 Columns: 54\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (8): HomeAway, Opponent, Result, TeamFull, TeamURL, Outcome, Team, Con...\ndbl  (45): Game, PassingCmp, PassingAtt, PassingPct, PassingYds, PassingTD, ...\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nTo do this, I’ve got some work to do. First, I need to mutate the outcomes of the games into 1s and 0s so I can add up the wins. We’ve done this before, so this won’t be new to you, just adjusted slightly from basketball data.\n\nwinlosslogs &lt;- logs |&gt; \n  mutate(\n    wins = case_when(\n      grepl(\"W\", Outcome) ~ 1, \n      grepl(\"L\", Outcome) ~ 0)\n)\n\nNow I have some more work to do. My football logs data has the yards per play of each game, and I could average those together and get something very close to what I’m going to do, but averaging each games yards per play is not the same thing as calculating it, so we’re going to calculate it.\n\nwinlosslogs |&gt; \n  group_by(Team, Conference) |&gt; \n  summarise(\n    TotalPlays = sum(OffensivePlays), \n    TotalYards = sum(OffensiveYards), \n    DefensivePlays = sum(DefPlays), \n    DefensiveYards = sum(DefYards), \n    TotalWins = sum(wins)) |&gt; \n  mutate(\n    OffensiveYPP = TotalYards/TotalPlays, \n    DefensiveYPP = DefensiveYards/DefensivePlays) -&gt; ypp\n\n`summarise()` has grouped output by 'Team'. You can override using the\n`.groups` argument.\n\n\nA bubble chart is just a scatterplot with one additional element in the aesthetic – a size. Here’s the scatterplot version.\n\nggplot() + \n  geom_point(\n    data=ypp, aes(x=OffensiveYPP, y=DefensiveYPP)\n    )\n\n\n\n\n\n\n\n\nLooks kind of random, eh? In this case, that’s not that bad because we’re not claiming a relationship. We’re saying the location on the chart has meaning. So, do teams on the bottom right – good offense, good defense – win more games?\nLet’s add the size element.\n\nggplot() + \n  geom_point(\n    data=ypp, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins)\n    )\n\n\n\n\n\n\n\n\nWhat does this chart tell you? We can see a general pattern that there are more big dots on the bottom right than the upper left. But we can make this more readable by adding an alpha element outside the aesthetic – alpha in this case is transparency – and we can manually change the size of the dots by adding scale_size and a range.\n\nggplot() + \n  geom_point(\n    data=ypp, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins),\n    alpha = .3) + \n  scale_size(range = c(3, 8), name=\"Wins\")\n\n\n\n\n\n\n\n\nAnd by now, you now know to add in the Big Ten as a layer, I would hope.\n\nbigten &lt;- ypp |&gt; filter(Conference == \"Big Ten Conference\")\n\n\nggplot() + \n  geom_point(\n    data=ypp, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), \n    color=\"grey\", \n    alpha=.5) + \n  geom_point(\n    data=bigten, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), \n    color=\"red\")\n\n\n\n\n\n\n\n\nLet’s add some things to this chart to help us out. First, let’s add lines that show us the average of all teams for those two metrics. So first, we need to calculate those. Because I have grouped data, it’s going to require me to ungroup it so I can get just the total average of those two numbers.\n\nypp |&gt; \n  ungroup() |&gt; \n  summarise(\n    offense = mean(OffensiveYPP), \n    defense = mean(DefensiveYPP)\n    )\n\n# A tibble: 1 × 2\n  offense defense\n    &lt;dbl&gt;   &lt;dbl&gt;\n1    5.70    5.55\n\n\nNow we can use those averages to add two more geoms – geom_vline and geom_hline, for vertical lines and horizontal lines.\n\nggplot() + \n  geom_point(\n    data=ypp, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), \n    color=\"grey\", \n    alpha=.5) + \n  geom_point(\n    data=bigten, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), \n    color=\"red\") + \n  geom_vline(xintercept = 5.700174) + \n  geom_hline(yintercept = 5.55143)\n\n\n\n\n\n\n\n\nNow, let’s add another new geom for us, using a new library called ggrepel, which will help us label the dots without overwriting other labels. So we’ll have to install that in the console:\n`install.packages(“ggrepel”)\n\nlibrary(ggrepel)\n\nAnd with that, we can add labels to the dots. The geom_text_repel is pretty much the exact same thing as your Big Ten geom point, but instead of a size, you include a label.\n\nggplot() + \n  geom_point(\n    data=ypp, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), \n    color=\"grey\", \n    alpha=.5) + \n  geom_point(\n    data=bigten, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), \n    color=\"red\") + \n  geom_vline(xintercept = 5.700174) + \n  geom_hline(yintercept = 5.55143) +\n  geom_text_repel(\n    data=bigten, \n    aes(x=OffensiveYPP, y=DefensiveYPP, label=Team)\n  )\n\n\n\n\n\n\n\n\nWell, what do you know about that? Maryland was … really a mixed bag this season.\nAll that’s left is some labels and some finishing touches.\n\nggplot() + \n  geom_point(\n    data=ypp, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), \n    color=\"grey\", \n    alpha=.5) + \n  geom_point(\n    data=bigten, \n    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), \n    color=\"red\") + \n  geom_vline(xintercept = 5.700174) + \n  geom_hline(yintercept = 5.55143) + \n  geom_text_repel(\n    data=bigten, \n    aes(x=OffensiveYPP, y=DefensiveYPP, label=Team)\n  ) +\n  labs(title=\"Is Maryland moving up to the Big Ten's best?\", subtitle=\"The Terps offense and defense puts it among ranked teams in the conference.\", caption=\"Source: NCAA | By Derek Willis\")  + theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    )",
    "crumbs": [
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Bubble charts</span>"
    ]
  },
  {
    "objectID": "beeswarmplots.html",
    "href": "beeswarmplots.html",
    "title": "24  Beeswarm plots",
    "section": "",
    "text": "24.1 A few other options\nThe ggbeeswarm library has a couple of variations on the geom_beeswarm that may work better for your application. They are geom_quasirandom and geom_jitter.\nThere’s not a lot to change from our example to see what they do.\nggplot() + \n  geom_quasirandom(\n    data=shooters, \n    groupOnX=TRUE, \n    aes(x=pos, y=tspct), color=\"grey\") + \n  geom_quasirandom(\n    data=umd, \n    groupOnX=TRUE, \n    aes(x=pos, y=tspct), color=\"red\") +\n  geom_text_repel(\n    data=umd, \n    aes(x=pos, y=tspct, label=player))\nQuasirandom spreads out the dots you see in beeswarm using – you guessed it – quasirandom spacing.\nFor geom_jitter, we need to remove the groupOnX value. Why? No clue.\nggplot() + \n  geom_jitter(\n    data=shooters, \n    aes(x=pos, y=tspct), color=\"grey\") + \n  geom_jitter(\n    data=umd, \n    aes(x=pos, y=tspct), color=\"red\") +\n  geom_text_repel(\n    data=umd, \n    aes(x=pos, y=tspct, label=player))\ngeom_jitter spreads out the dots evenly across the width of the column, randomly deciding where in the line of the true shooting percentage they appear.\nWhich one is right for you? You’re going to have to experiment and decide. This is the art in the art and a science.",
    "crumbs": [
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Beeswarm plots</span>"
    ]
  },
  {
    "objectID": "bumpcharts.html",
    "href": "bumpcharts.html",
    "title": "25  Bump charts",
    "section": "",
    "text": "The point of a bump chart is to show how the ranking of something changed over time – you could do this with the top 25 in football or basketball. I’ve seen it done with European soccer league standings over a season.\nThe requirements are that you have a row of data for a team, in that week, with their rank.\nThis is another extension to ggplot, and you’ll install it the usual way: install.packages(\"ggbump\")\n\nlibrary(tidyverse)\nlibrary(ggbump)\n\nLet’s use the 2020-21 college football playoff rankings:\nFor this walkthrough:\n   Download csv file\n\n\nrankings &lt;- read_csv(\"data/cfbranking22.csv\")\n\nRows: 60 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Team\ndbl (2): Week, Rank\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nGiven our requirements of a row of data for a team, in that week, with their rank, take a look at the data provided. We have 5 weeks of playoff rankings, so we should see a ranking, the week of the ranking and the team at that rank. You can see the basic look of the data by using head()\n\nhead(rankings)\n\n# A tibble: 6 × 3\n   Week  Rank Team      \n  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     \n1    15     1 Georgia   \n2    15     2 Michigan  \n3    15     3 TCU       \n4    15     4 Ohio State\n5    15     5 Alabama   \n6    15     6 Tennessee \n\n\nSo Georgia was ranked in the first (yawn), followed by Michigan (double yawn), TCU (hey now!), Ohio State and so on. Our data is in the form we need it to be. Now we can make a bump chart. We’ll start simple.\n\nggplot() + \n  geom_bump(\n    data=rankings, aes(x=Week, y=Rank, color=Team))\n\nWarning in compute_group(...): 'StatBump' needs at least two observations per\ngroup\n\n\n\n\n\n\n\n\n\nWell, it’s a start.\nThe warning that you’re seeing is that there’s three teams last season who made one appearance on the college football playoff rankings and disappeared. Some fans would bite your arm off for that. Alas. We should eliminate them and thin up our chart a little. Let’s just take teams that finished in the top 10. We’re going to use a neat filter trick for this that you learned earlier using %in%.\n\ntop10 &lt;- rankings |&gt; filter(Week == 15 & Rank &lt;= 10)\n\nnewrankings &lt;- rankings |&gt; filter(Team %in% top10$Team)\n\nNow you have something called newrankings that shows how teams who finished in the top 10 at the end of the season ended up there. And every team who finished in the top 10 in week 17 had been in the rankings more than once in the 5 weeks before.\n\nggplot() + \n  geom_bump(\n    data=newrankings, aes(x=Week, y=Rank, color=Team))\n\n\n\n\n\n\n\n\nFirst things first: I’m immediately annoyed by the top teams being at the bottom. I learned a neat trick from ggbump that’s been in ggplot all along – scale_y_reverse()\n\nggplot() + \n  geom_bump(\n    data=newrankings, aes(x=Week, y=Rank, color=Team)) + \n  scale_y_reverse()\n\n\n\n\n\n\n\n\nBetter. But, still not great. Let’s add a point at each week.\n\nggplot() + \n  geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) + \n  geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +\n  scale_y_reverse() \n\n\n\n\n\n\n\n\nAnother step. That makes it more subway-map like. But the colors are all wrong. To fix this, we’re going to use scale_color_manual and we’re going to Google the hex codes for each team. The legend will tell you what order your scale_color_manual needs to be.\n\nggplot() + \n  geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) + \n  geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) + \n  scale_color_manual(values = c(\"#9E1B32\",\"#F56600\", \"#BA0C2F\", \"#0021A5\", \"#ffcb05\", \"#BB0000\", \"#4d1979\",\"#FF8200\", \"#990000\", \"#CC0000\")) +\n  scale_y_reverse() \n\n\n\n\n\n\n\n\nAnother step. But the legend is annoying. And trying to find which red is Alabama vs Ohio State is hard. So what if we labeled each dot at the beginning and end? We can do that with some clever usage of geom_text and a little dplyr filtering inside the data step. We filter out the first and last weeks, then use hjust – horizontal justification – to move them left or right.\n\nggplot() + \n  geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) + \n  geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +   \n  geom_text(data = newrankings |&gt; filter(Week == min(Week)), aes(x = Week - .2, y=Rank, label = Team), size = 3, hjust = 1) +\n  geom_text(data = newrankings |&gt; filter(Week == max(Week)), aes(x = Week + .2, y=Rank, label = Team), size = 3, hjust = 0) +\n  scale_color_manual(values = c(\"#9E1B32\",\"#F56600\", \"#BA0C2F\", \"#0021A5\", \"#ffcb05\", \"#BB0000\", \"#4d1979\",\"#FF8200\", \"#990000\", \"#CC0000\")) +\n  scale_y_reverse() \n\n\n\n\n\n\n\n\nBetter, but the legend is still there. We can drop it in a theme directive by saying legend.position = \"none\". We’ll also throw a theme_minimal on there to drop the default grey, and we’ll add some better labeling.\n\nggplot() + \n  geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) + \n  geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +   \n  geom_text(data = newrankings |&gt; filter(Week == min(Week)), aes(x = Week - .2, y=Rank, label = Team), size = 3, hjust = 1) +\n  geom_text(data = newrankings |&gt; filter(Week == max(Week)), aes(x = Week + .2, y=Rank, label = Team), size = 3, hjust = 0) +\n  labs(title=\"Last year's top ten was anything but boring\", subtitle=\"\", y= \"Rank\", x = \"Week\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major = element_blank()\n    ) +\n  scale_color_manual(values = c(\"#9E1B32\",\"#F56600\", \"#BA0C2F\", \"#0021A5\", \"#ffcb05\", \"#BB0000\", \"#4d1979\",\"#FF8200\", \"#990000\", \"#CC0000\")) +\n  scale_y_reverse() \n\n\n\n\n\n\n\n\nNow let’s fix our text hierarchy.\n\nggplot() + \n  geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) + \n  geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +   \n  geom_text(data = newrankings |&gt; filter(Week == min(Week)), aes(x = Week - .2, y=Rank, label = Team), size = 3, hjust = 1) +\n  geom_text(data = newrankings |&gt; filter(Week == max(Week)), aes(x = Week + .2, y=Rank, label = Team), size = 3, hjust = 0) +\n  labs(title=\"Last year's top ten was anything but boring\", subtitle=\"\", y= \"Rank\", x = \"Week\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major = element_blank(),\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  scale_color_manual(values = c(\"#9E1B32\",\"#F56600\", \"#BA0C2F\", \"#0021A5\", \"#ffcb05\", \"#BB0000\", \"#4d1979\",\"#FF8200\", \"#990000\", \"#CC0000\")) +\n  scale_y_reverse() \n\n\n\n\n\n\n\n\nAnd the last thing: anyone else annoyed at 7.5th place on the left? We can fix that too by specifying the breaks in scale_y_reverse. We can do that with the x axis as well, but since we haven’t reversed it, we do that in scale_x_continuous with the same breaks. Also: forgot my source and credit line.\nOne last thing: Let’s change the width of the chart to make the names fit. We can do that by adding fig.width=X in the {r} setup in your block. So something like this:\n\nggplot() + \n  geom_bump(data=newrankings, aes(x=Week, y=Rank, color=Team)) + \n  geom_point(data=newrankings, aes(x=Week, y=Rank, color=Team), size = 4) +   \n  geom_text(data = newrankings |&gt; filter(Week == min(Week)), aes(x = Week - .2, y=Rank, label = Team), size = 3, hjust = 1) +\n  geom_text(data = newrankings |&gt; filter(Week == max(Week)), aes(x = Week + .2, y=Rank, label = Team), size = 3, hjust = 0) +\n  labs(title=\"Last year's top ten was anything but boring\", subtitle=\"\", y= \"Rank\", x = \"Week\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major = element_blank(),\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  scale_color_manual(values = c(\"#9E1B32\",\"#F56600\", \"#BA0C2F\", \"#0021A5\", \"#ffcb05\", \"#BB0000\", \"#4d1979\",\"#FF8200\", \"#990000\", \"#CC0000\")) +\n  scale_x_continuous(breaks=c(13,14,15,16,17)) + \n  scale_y_reverse(breaks=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15))",
    "crumbs": [
      "<span class='chapter-number'>25</span>  <span class='chapter-title'>Bump charts</span>"
    ]
  },
  {
    "objectID": "tables.html",
    "href": "tables.html",
    "title": "26  Tables",
    "section": "",
    "text": "But not a table. A table with features.\nSometimes, the best way to show your data is with a table – simple rows and columns. It allows a reader to compare whatever they want to compare a little easier than a graph where you’ve chosen what to highlight. The folks that made R Studio and the tidyverse have a neat package called gt.\nFor this assignment, we’ll need gt so go over to the console and run:\ninstall.packages(\"gt\")\nSo what does all of these libraries do? Let’s gather a few and use data of every men’s basketball game between 2015-2024.\nFor this walkthrough:\n   Download csv file\n\nLoad libraries.\n\nlibrary(tidyverse)\nlibrary(gt)\n\nAnd the data.\n\nlogs &lt;- read_csv(\"data/cbblogs1524.csv\")\n\nRows: 98161 Columns: 51\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (9): Season, TeamFull, Opponent, HomeAway, W_L, URL, Conference, Team,...\ndbl  (39): Game, TeamScore, OpponentScore, TeamFG, TeamFGA, TeamFGPCT, Team3...\nlgl   (2): Blank, season\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nLet’s ask this question: which college basketball team saw the greatest decrease in three point attempts per game between last season as a percentage of shots? The simplest way to calculate that is by percent change.\nWe’ve got a little work to do, putting together ideas we’ve used before. What we need to end up with is some data that looks like this:\nTeam | 2022-2023 season threes | 2023-2024 season threes | pct change\nTo get that, we’ll need to do some filtering to get the right seasons, some grouping and summarizing to get the right number, some pivoting to get it organized correctly so we can mutate the percent change.\n\nthreechange &lt;- logs |&gt;\n  filter(Season == \"2022-2023\" | Season == \"2023-2024\") |&gt;\n  group_by(Team, Season) |&gt;\n  summarise(Total3PA = sum(Team3PA)) |&gt;\n  pivot_wider(names_from=Season, values_from = Total3PA) |&gt;\n  filter(!is.na(`2023-2024`)) |&gt; \n  mutate(PercentChange = (`2023-2024`-`2022-2023`)/`2022-2023`) |&gt;\n  arrange(PercentChange) |&gt; \n  ungroup() |&gt;\n  slice_head(n=10) # just want a top 10 list, but can't use top_n!\n\n`summarise()` has grouped output by 'Team'. You can override using the\n`.groups` argument.\n\n\nWe’ve output tables to the screen a thousand times in this class with head, but gt makes them look decent with very little code.\n\nthreechange |&gt; gt()\n\n\n\n\n\n\n\nTeam\n2022-2023\n2023-2024\nPercentChange\n\n\n\n\nHouston Christian\n726\n488\n-0.3278237\n\n\nJacksonville State\n747\n507\n-0.3212851\n\n\nCoppin State\n793\n540\n-0.3190416\n\n\nToledo\n764\n550\n-0.2801047\n\n\nSoutheast Missouri State\n875\n631\n-0.2788571\n\n\nEastern Kentucky\n927\n678\n-0.2686084\n\n\nSouthern Utah\n887\n649\n-0.2683202\n\n\nTennessee Tech\n829\n608\n-0.2665862\n\n\nUtah Valley\n728\n540\n-0.2582418\n\n\nLouisiana-Monroe\n690\n513\n-0.2565217\n\n\n\n\n\n\n\nSo there you have it. Long Island changed their team so much they took 44 percent fewer threes in 2022-23 from the season before. Where did Maryland come out? We ranked pretty low in college basketball in terms of fewer threes from the season before, because the Terps actually took 61 more.\ngt has a mountain of customization options. The good news is that it works in a very familiar pattern. We’ll start with fixing headers. What we have isn’t bad, but PercentChange isn’t good either. Let’s fix that.\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  )\n\n\n\n\n\n\n\nTeam\n2022-2023\n2023-2024\nPercent Change\n\n\n\n\nHouston Christian\n726\n488\n-0.3278237\n\n\nJacksonville State\n747\n507\n-0.3212851\n\n\nCoppin State\n793\n540\n-0.3190416\n\n\nToledo\n764\n550\n-0.2801047\n\n\nSoutheast Missouri State\n875\n631\n-0.2788571\n\n\nEastern Kentucky\n927\n678\n-0.2686084\n\n\nSouthern Utah\n887\n649\n-0.2683202\n\n\nTennessee Tech\n829\n608\n-0.2665862\n\n\nUtah Valley\n728\n540\n-0.2582418\n\n\nLouisiana-Monroe\n690\n513\n-0.2565217\n\n\n\n\n\n\n\nBetter. Note the pattern: Actual header name = “What we want to see”. So if we wanted to change Team to School, we’d do this: Team = \"School\" inside the cols_label bits.\nNow we can start working with styling. The truth is most of your code in tables is going to be dedicated to styling specific things. The first thing we need: A headline and some chatter. They’re required parts of a graphic, so they’re a good place to start. We do that with tab_header\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  ) |&gt;\n  tab_header(\n    title = \"Did Maryland Shoot Fewer Threes in 2021-22?\",\n    subtitle = \"No, the Terps shot more. But these 10 teams completely changed their offenses.\"\n  )\n\n\n\n\n  \n    \n      Did Maryland Shoot Fewer Threes in 2021-22?\n    \n    \n      No, the Terps shot more. But these 10 teams completely changed their offenses.\n    \n  \n  \n    \n      Team\n      2022-2023\n      2023-2024\n      Percent Change\n    \n  \n  \n    Houston Christian\n726\n488\n-0.3278237\n    Jacksonville State\n747\n507\n-0.3212851\n    Coppin State\n793\n540\n-0.3190416\n    Toledo\n764\n550\n-0.2801047\n    Southeast Missouri State\n875\n631\n-0.2788571\n    Eastern Kentucky\n927\n678\n-0.2686084\n    Southern Utah\n887\n649\n-0.2683202\n    Tennessee Tech\n829\n608\n-0.2665862\n    Utah Valley\n728\n540\n-0.2582418\n    Louisiana-Monroe\n690\n513\n-0.2565217\n  \n  \n  \n\n\n\n\nWe have a headline and some chatter, but … gross. Centered? The extra lines? No real difference in font weight? We can do better. We can style individual elements using tab_style. First, let’s make the main headline – the title – bold and left aligned.\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  ) |&gt;\n  tab_header(\n    title = \"Did Maryland Shoot Fewer Threes in 2021-22?\",\n    subtitle = \"No, the Terps shot more. But these 10 teams completely changed their offenses.\"\n  ) |&gt; tab_style(\n    style = cell_text(color = \"black\", weight = \"bold\", align = \"left\"),\n    locations = cells_title(\"title\")\n  )\n\n\n\n\n  \n    \n      Did Maryland Shoot Fewer Threes in 2021-22?\n    \n    \n      No, the Terps shot more. But these 10 teams completely changed their offenses.\n    \n  \n  \n    \n      Team\n      2022-2023\n      2023-2024\n      Percent Change\n    \n  \n  \n    Houston Christian\n726\n488\n-0.3278237\n    Jacksonville State\n747\n507\n-0.3212851\n    Coppin State\n793\n540\n-0.3190416\n    Toledo\n764\n550\n-0.2801047\n    Southeast Missouri State\n875\n631\n-0.2788571\n    Eastern Kentucky\n927\n678\n-0.2686084\n    Southern Utah\n887\n649\n-0.2683202\n    Tennessee Tech\n829\n608\n-0.2665862\n    Utah Valley\n728\n540\n-0.2582418\n    Louisiana-Monroe\n690\n513\n-0.2565217\n  \n  \n  \n\n\n\n\nIt’s hard to see here, but the chatter below is also centered (it doesn’t look like it because it fills the space). We can left align that too, but leave it normal weight (i.e. not bold).\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  ) |&gt;\n  tab_header(\n    title = \"Did Maryland Shoot Fewer Threes in 2021-22?\",\n    subtitle = \"No, the Terps shot more. But these 10 teams completely changed their offenses.\"\n  ) |&gt; tab_style(\n    style = cell_text(color = \"black\", weight = \"bold\", align = \"left\"),\n    locations = cells_title(\"title\")\n  ) |&gt; tab_style(\n    style = cell_text(color = \"black\", align = \"left\"),\n    locations = cells_title(\"subtitle\")\n  )\n\n\n\n\n  \n    \n      Did Maryland Shoot Fewer Threes in 2021-22?\n    \n    \n      No, the Terps shot more. But these 10 teams completely changed their offenses.\n    \n  \n  \n    \n      Team\n      2022-2023\n      2023-2024\n      Percent Change\n    \n  \n  \n    Houston Christian\n726\n488\n-0.3278237\n    Jacksonville State\n747\n507\n-0.3212851\n    Coppin State\n793\n540\n-0.3190416\n    Toledo\n764\n550\n-0.2801047\n    Southeast Missouri State\n875\n631\n-0.2788571\n    Eastern Kentucky\n927\n678\n-0.2686084\n    Southern Utah\n887\n649\n-0.2683202\n    Tennessee Tech\n829\n608\n-0.2665862\n    Utah Valley\n728\n540\n-0.2582418\n    Louisiana-Monroe\n690\n513\n-0.2565217\n  \n  \n  \n\n\n\n\nThe next item on the required elements list: Source and credit lines. In gt, those are called tab_source_notes and we can add them like this:\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  ) |&gt;\n  tab_header(\n    title = \"Did Maryland Shoot Fewer Threes in 2021-22?\",\n    subtitle = \"No, the Terps shot more. But these 10 teams completely changed their offenses.\"\n  ) |&gt; tab_style(\n    style = cell_text(color = \"black\", weight = \"bold\", align = \"left\"),\n    locations = cells_title(\"title\")\n  ) |&gt; tab_style(\n    style = cell_text(color = \"black\", align = \"left\"),\n    locations = cells_title(\"subtitle\")\n  ) |&gt;\n  tab_source_note(\n    source_note = md(\"**By:** Derek Willis  |  **Source:** [Sports Reference](https://www.sports-reference.com/cbb/seasons/)\")\n  )\n\n\n\n\n  \n    \n      Did Maryland Shoot Fewer Threes in 2021-22?\n    \n    \n      No, the Terps shot more. But these 10 teams completely changed their offenses.\n    \n  \n  \n    \n      Team\n      2022-2023\n      2023-2024\n      Percent Change\n    \n  \n  \n    Houston Christian\n726\n488\n-0.3278237\n    Jacksonville State\n747\n507\n-0.3212851\n    Coppin State\n793\n540\n-0.3190416\n    Toledo\n764\n550\n-0.2801047\n    Southeast Missouri State\n875\n631\n-0.2788571\n    Eastern Kentucky\n927\n678\n-0.2686084\n    Southern Utah\n887\n649\n-0.2683202\n    Tennessee Tech\n829\n608\n-0.2665862\n    Utah Valley\n728\n540\n-0.2582418\n    Louisiana-Monroe\n690\n513\n-0.2565217\n  \n  \n    \n      By: Derek Willis  |  Source: Sports Reference\n    \n  \n  \n\n\n\n\nWe can do a lot with tab_style. For instance, we can make the headers bold and reduce the size a bit to reduce font congestion in the area.\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  ) |&gt;\n  tab_header(\n    title = \"Did Maryland Shoot Fewer Threes in 2021-22?\",\n    subtitle = \"No, the Terps shot more. But these 10 teams completely changed their offenses.\"\n  ) |&gt; \n  tab_style(\n    style = cell_text(color = \"black\", weight = \"bold\", align = \"left\"),\n    locations = cells_title(\"title\")\n  ) |&gt; \n  tab_style(\n    style = cell_text(color = \"black\", align = \"left\"),\n    locations = cells_title(\"subtitle\")\n  ) |&gt;  \n  tab_source_note(\n    source_note = md(\"**By:** Derek Willis  |  **Source:** [Sports Reference](https://www.sports-reference.com/cbb/seasons/)\")\n  ) |&gt;\n  tab_style(\n     locations = cells_column_labels(columns = everything()),\n     style = list(\n       cell_borders(sides = \"bottom\", weight = px(3)),\n       cell_text(weight = \"bold\", size=12)\n     )\n   ) \n\n\n\n\n  \n    \n      Did Maryland Shoot Fewer Threes in 2021-22?\n    \n    \n      No, the Terps shot more. But these 10 teams completely changed their offenses.\n    \n  \n  \n    \n      Team\n      2022-2023\n      2023-2024\n      Percent Change\n    \n  \n  \n    Houston Christian\n726\n488\n-0.3278237\n    Jacksonville State\n747\n507\n-0.3212851\n    Coppin State\n793\n540\n-0.3190416\n    Toledo\n764\n550\n-0.2801047\n    Southeast Missouri State\n875\n631\n-0.2788571\n    Eastern Kentucky\n927\n678\n-0.2686084\n    Southern Utah\n887\n649\n-0.2683202\n    Tennessee Tech\n829\n608\n-0.2665862\n    Utah Valley\n728\n540\n-0.2582418\n    Louisiana-Monroe\n690\n513\n-0.2565217\n  \n  \n    \n      By: Derek Willis  |  Source: Sports Reference\n    \n  \n  \n\n\n\n\nNext up: There’s a lot of lines in this that don’t need to be there. gt has some tools to get rid of them easily and add in some other readability improvements.\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  ) |&gt;\n  tab_header(\n    title = \"Did Maryland Shoot Fewer Threes in 2021-22?\",\n    subtitle = \"No, the Terps shot more. But these 10 teams completely changed their offenses.\"\n  ) |&gt;  \n  tab_source_note(\n    source_note = md(\"**By:** Derek Willis  |  **Source:** [Sports Reference](https://www.sports-reference.com/cbb/seasons/)\")\n  ) |&gt; \n  tab_style(\n    style = cell_text(color = \"black\", weight = \"bold\", align = \"left\"),\n    locations = cells_title(\"title\")\n  ) |&gt; \n  tab_style(\n    style = cell_text(color = \"black\", align = \"left\"),\n    locations = cells_title(\"subtitle\")\n  ) |&gt;\n  tab_style(\n     locations = cells_column_labels(columns = everything()),\n     style = list(\n       cell_borders(sides = \"bottom\", weight = px(3)),\n       cell_text(weight = \"bold\", size=12)\n     )\n   ) |&gt;\n  opt_row_striping() |&gt; \n  opt_table_lines(\"none\")\n\n\n\n\n  \n    \n      Did Maryland Shoot Fewer Threes in 2021-22?\n    \n    \n      No, the Terps shot more. But these 10 teams completely changed their offenses.\n    \n  \n  \n    \n      Team\n      2022-2023\n      2023-2024\n      Percent Change\n    \n  \n  \n    Houston Christian\n726\n488\n-0.3278237\n    Jacksonville State\n747\n507\n-0.3212851\n    Coppin State\n793\n540\n-0.3190416\n    Toledo\n764\n550\n-0.2801047\n    Southeast Missouri State\n875\n631\n-0.2788571\n    Eastern Kentucky\n927\n678\n-0.2686084\n    Southern Utah\n887\n649\n-0.2683202\n    Tennessee Tech\n829\n608\n-0.2665862\n    Utah Valley\n728\n540\n-0.2582418\n    Louisiana-Monroe\n690\n513\n-0.2565217\n  \n  \n    \n      By: Derek Willis  |  Source: Sports Reference\n    \n  \n  \n\n\n\n\nWe’re in pretty good shape here, but look closer. What else makes this table sub-par? How about the formatting of the percent change? We can fix that with a formatter.\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  ) |&gt;\n  tab_header(\n    title = \"Did Maryland Shoot Fewer Threes in 2021-22?\",\n    subtitle = \"No, the Terps shot more. But these 10 teams completely changed their offenses.\"\n  ) |&gt;  \n  tab_source_note(\n    source_note = md(\"**By:** Derek Willis  |  **Source:** [Sports Reference](https://www.sports-reference.com/cbb/seasons/)\")\n  ) |&gt; \n  tab_style(\n    style = cell_text(color = \"black\", weight = \"bold\", align = \"left\"),\n    locations = cells_title(\"title\")\n  ) |&gt; \n  tab_style(\n    style = cell_text(color = \"black\", align = \"left\"),\n    locations = cells_title(\"subtitle\")\n  ) |&gt;\n  tab_style(\n     locations = cells_column_labels(columns = everything()),\n     style = list(\n       cell_borders(sides = \"bottom\", weight = px(3)),\n       cell_text(weight = \"bold\", size=12)\n     )\n   ) |&gt;\n  opt_row_striping() |&gt; \n  opt_table_lines(\"none\") |&gt;\n    fmt_percent(\n    columns = c(PercentChange),\n    decimals = 1\n  )\n\n\n\n\n  \n    \n      Did Maryland Shoot Fewer Threes in 2021-22?\n    \n    \n      No, the Terps shot more. But these 10 teams completely changed their offenses.\n    \n  \n  \n    \n      Team\n      2022-2023\n      2023-2024\n      Percent Change\n    \n  \n  \n    Houston Christian\n726\n488\n−32.8%\n    Jacksonville State\n747\n507\n−32.1%\n    Coppin State\n793\n540\n−31.9%\n    Toledo\n764\n550\n−28.0%\n    Southeast Missouri State\n875\n631\n−27.9%\n    Eastern Kentucky\n927\n678\n−26.9%\n    Southern Utah\n887\n649\n−26.8%\n    Tennessee Tech\n829\n608\n−26.7%\n    Utah Valley\n728\n540\n−25.8%\n    Louisiana-Monroe\n690\n513\n−25.7%\n  \n  \n    \n      By: Derek Willis  |  Source: Sports Reference\n    \n  \n  \n\n\n\n\nThroughout the semester, we’ve been using color and other signals to highlight things. Let’s pretend we’re doing a project on Syracuse. With a little tab_style magic, we can change individual rows and add color. The last tab_style block here will first pass off the styles we want to use – we’re going to make the rows maroon and the text gold – and then for locations we specify where with a simple filter. What that means is that any rows we can address with logic – all rows with a value greater than X, for example – we can change the styling.\n\nthreechange |&gt; \n  gt() |&gt; \n  cols_label(\n    PercentChange = \"Percent Change\"\n  ) |&gt;\n  tab_header(\n    title = \"Did Maryland Shoot Fewer Threes in 2021-22?\",\n    subtitle = \"No, the Terps shot more. But these 10 teams completely changed their offenses.\"\n  ) |&gt;  \n  tab_source_note(\n    source_note = md(\"**By:** Derek Willis  |  **Source:** [Sports Reference](https://www.sports-reference.com/cbb/seasons/)\")\n  ) |&gt; \n  tab_style(\n    style = cell_text(color = \"black\", weight = \"bold\", align = \"left\"),\n    locations = cells_title(\"title\")\n  ) |&gt; \n  tab_style(\n    style = cell_text(color = \"black\", align = \"left\"),\n    locations = cells_title(\"subtitle\")\n  ) |&gt;\n  tab_style(\n     locations = cells_column_labels(columns = everything()),\n     style = list(\n       cell_borders(sides = \"bottom\", weight = px(3)),\n       cell_text(weight = \"bold\", size=12)\n     )\n   ) |&gt;\n  opt_row_striping() |&gt; \n  opt_table_lines(\"none\") |&gt;\n    fmt_percent(\n    columns = c(PercentChange),\n    decimals = 1\n  ) |&gt;\n  tab_style(\n    style = list(\n      cell_fill(color = \"blue\"),\n      cell_text(color = \"orange\")\n      ),\n    locations = cells_body(\n      rows = Team == \"Syracuse\")\n  )\n\n\n\n\n  \n    \n      Did Maryland Shoot Fewer Threes in 2021-22?\n    \n    \n      No, the Terps shot more. But these 10 teams completely changed their offenses.\n    \n  \n  \n    \n      Team\n      2022-2023\n      2023-2024\n      Percent Change\n    \n  \n  \n    Houston Christian\n726\n488\n−32.8%\n    Jacksonville State\n747\n507\n−32.1%\n    Coppin State\n793\n540\n−31.9%\n    Toledo\n764\n550\n−28.0%\n    Southeast Missouri State\n875\n631\n−27.9%\n    Eastern Kentucky\n927\n678\n−26.9%\n    Southern Utah\n887\n649\n−26.8%\n    Tennessee Tech\n829\n608\n−26.7%\n    Utah Valley\n728\n540\n−25.8%\n    Louisiana-Monroe\n690\n513\n−25.7%\n  \n  \n    \n      By: Derek Willis  |  Source: Sports Reference\n    \n  \n  \n\n\n\n\nTwo things here:\n\nDear God that color scheme is awful, which is fitting for a school that has a non-rhyming mascot.\nWe’ve arrived where we want to be: We’ve created a clear table that allows a reader to compare schools at will while also using color to draw attention to the thing we want to draw attention to. We’ve kept it simple so the color has impact.",
    "crumbs": [
      "<span class='chapter-number'>26</span>  <span class='chapter-title'>Tables</span>"
    ]
  },
  {
    "objectID": "facetwraps.html",
    "href": "facetwraps.html",
    "title": "27  Facet wraps",
    "section": "",
    "text": "27.1 Facet grid vs facet wraps\nFacet grids allow us to put teams on the same plane, versus just repeating them. And we can specify that plane as vertical or horizontal. For example, here’s our chart from above, but using facet_grid to stack them.\nggplot() + \n  geom_hline(yintercept=0.4549669, color=\"blue\") + \n  geom_line(data=big10, aes(x=Date, y=TeamFGPCT, group=Team)) + \n  scale_y_continuous(limits = c(0, .7)) + \n  facet_grid(Team ~ .)\nAnd here they are next to each other:\nggplot() + \n  geom_hline(yintercept=0.4549669, color=\"blue\") + \n  geom_line(data=big10, aes(x=Date, y=TeamFGPCT, group=Team)) + \n  scale_y_continuous(limits = c(0, .7)) + \n  facet_grid(. ~ Team)\nNote: We’d have some work to do with the labeling on this – we’ll get to that – but you can see where this is valuable comparing a group of things. One warning: Don’t go too crazy with this or it loses it’s visual power.",
    "crumbs": [
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Facet wraps</span>"
    ]
  },
  {
    "objectID": "facetwraps.html#other-types",
    "href": "facetwraps.html#other-types",
    "title": "27  Facet wraps",
    "section": "27.2 Other types",
    "text": "27.2 Other types\nLine charts aren’t the only things we can do. We can do any kind of chart in ggplot. Staying with shooting, where are team’s winning and losing performances coming from when we talk about team shooting and opponent shooting?\n\nggplot() + \n  geom_point(data=big10, aes(x=TeamFGPCT, y=OpponentFGPCT, color=W_L)) +\n  scale_y_continuous(limits = c(0, .7)) + \n  scale_x_continuous(limits = c(0, .7)) + \n  facet_wrap(~Team)",
    "crumbs": [
      "<span class='chapter-number'>27</span>  <span class='chapter-title'>Facet wraps</span>"
    ]
  },
  {
    "objectID": "cowplots.html",
    "href": "cowplots.html",
    "title": "28  Arranging multiple plots together",
    "section": "",
    "text": "Sometimes you have two or three (or more) charts that by themselves aren’t very exciting and are really just one chart that you need to merge together. It would be nice to be able to arrange them programmatically and not have to mess with it in Adobe Illustrator.\nGood news.\nThere is.\nIt’s called cowplot, and it’s pretty easy to use. First install cowplot with install.packages(\"cowplot\"). Then let’s load tidyverse and cowplot.\n\nlibrary(tidyverse)\nlibrary(cowplot)\n\nWe’ll use the college football attendance data we’ve used before.\nFor this walkthrough:\n   Download csv file\n\nAnd load it.\n\nattendance &lt;- read_csv(\"data/attendance.csv\")\n\nRows: 146 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): Institution, Conference\ndbl (11): 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nMaking a quick percent change.\n\nattendance &lt;- attendance |&gt; mutate(change = ((`2023`-`2022`)/`2022`)*100)\n\nLet’s chart the top 10 and bottom 10 of college football ticket growth … and shrinkage.\n\ntop10 &lt;- attendance |&gt; top_n(10, wt=change)\nbottom10 &lt;- attendance |&gt; top_n(10, wt=-change)\n\nHey, there are those Terps at #10 in the top 10!\nOkay, now to do this I need to save my plots to an object. We do this the same way we save things to a dataframe – with the arrow. We’ll make two identical bar charts, one with the top 10 and one with the bottom 10.\n\nbar1 &lt;- ggplot() + \n  geom_bar(data=top10, aes(x=reorder(Institution, change), weight=change)) +\n  coord_flip()\n\n\nbar2 &lt;- ggplot() + \n  geom_bar(data=bottom10, aes(x=reorder(Institution, change), weight=change)) +\n  coord_flip()\n\nWith cowplot, we can use a function called plot_grid to arrange the charts:\n\nplot_grid(bar1, bar2) \n\n\n\n\n\n\n\n\nWe can also stack them on top of each other:\n\nplot_grid(bar1, bar2, ncol=1) \n\n\n\n\n\n\n\n\nTo make these publishable, we should add headlines, chatter, decent labels, credit lines, etc. But to do this, we’ll have to figure out which labels go on which charts, so we can make it look decent. For example – both charts don’t need x or y labels. If you don’t have a title and subtitle on both, the spacing is off, so you need to leave one blank or the other blank. You’ll just have to fiddle with it until you get it looking right.\n\nbar1 &lt;- ggplot() + \n  geom_bar(data=top10, aes(x=reorder(Institution, change), weight=change)) +\n  coord_flip() + \n  labs(title=\"College football winners...\", subtitle = \"Not every football program saw attendance shrink in 2023. But some really did.\",  x=\"\", y=\"Percent change\", caption = \"\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    )\n\n\nbar2 &lt;- ggplot() + \n  geom_bar(data=bottom10, aes(x=reorder(Institution, change), weight=change)) +\n  coord_flip() +  \n  labs(title = \"... and losers\", subtitle= \"\", x=\"\", y=\"\",  caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    )\n\n\nplot_grid(bar1, bar2) \n\n\n\n\n\n\n\n\nWhat’s missing here? Color. Our eyes aren’t drawn to anything (except maybe the top and bottom). So we need to help that. A bar chart without context or color to draw attention to something isn’t much of a bar chart. Same with a line chart – if your line chart has one line, no context, no color, it’s going to fare poorly.\n\nlo &lt;- bottom10 |&gt; filter(Institution == \"Akron\")\nsd &lt;- top10 |&gt; filter(Institution == \"Houston\")\n\n\nbar1 &lt;- ggplot() + \n  geom_bar(data=top10, aes(x=reorder(Institution, change), weight=change)) + \n  geom_bar(data=sd, aes(x=reorder(Institution, change), weight=change), fill=\"#011E41\") + \n  coord_flip() + \n  labs(title=\"College football winners...\", subtitle = \"Not every football program saw attendance shrink in 2023 But some really did.\",  x=\"\", y=\"Percent change\", caption = \"\") +\n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    )\n\n\nbar2 &lt;- ggplot() + \n  geom_bar(data=bottom10, aes(x=reorder(Institution, change), weight=change)) + \n  geom_bar(data=lo, aes(x=reorder(Institution, change), weight=change), fill=\"#006F71\") + \n  coord_flip() +  \n  labs(title = \"... and losers\", subtitle= \"\", x=\"\", y=\"\",  caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    )\n\n\nplot_grid(bar1, bar2)",
    "crumbs": [
      "<span class='chapter-number'>28</span>  <span class='chapter-title'>Arranging multiple plots together</span>"
    ]
  },
  {
    "objectID": "encirclingpoints.html",
    "href": "encirclingpoints.html",
    "title": "29  Encircling points on a scatterplot",
    "section": "",
    "text": "29.1 A different, more local example\nYou can use circling outside of the top of something. It’s a bit obvious that the previous dots were top scorers. What about when they aren’t at the top?\nWorks the same way – use layering and color smartly and tell the story with all your tools.\nLet’s grab the top three point attempt takers on the 2023-24 Maryland roster.\nplayers24 &lt;- read_csv(\"https://thescoop.org/sports-data-files/players24.csv\")\n\nRows: 5678 Columns: 59\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (10): Team, Player, Class, Pos, Height, Hometown, High School, Summary, ...\ndbl (49): #, Weight, Rk.x, G, GS, MP, FG, FGA, FG%, 2P, 2PA, 2P%, 3P, 3PA, 3...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nmdtop &lt;- players24 |&gt; filter(Team == \"Maryland Terrapins Men's\") |&gt; top_n(3, `3PA`)\nAnd just like above, we can plug in our players geom, our mdtop dataframe into another geom, then encircle that dataframe. Slap some headlines and annotations on it and here’s what we get:\nggplot() + geom_point(data=players24, aes(x=MP, y=`3PA`), color=\"grey\") + geom_point(data=mdtop, aes(x=MP, y=`3PA`), color=\"red\") + geom_encircle(data=mdtop, aes(x=MP, y=`3PA`), s_shape=.02, expand=.18, colour=\"red\") +\n  geom_text(aes(x=400, y=200, label=\"Maryland's top three shooters\")) + \n  labs(title=\"The Big Three?\", subtitle=\"Maryland's top three point shooters not among the leaders in college basketball \", x=\"Minutes\", y=\"Three point attempts\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    )\n\nWarning: Removed 623 rows containing missing values (`geom_point()`).\nFrom the top, Maryland’s dots are Jahmir Young, Donta Scott and Jamie Kaiser. None of them return this season.",
    "crumbs": [
      "<span class='chapter-number'>29</span>  <span class='chapter-title'>Encircling points on a scatterplot</span>"
    ]
  },
  {
    "objectID": "textcleaning.html",
    "href": "textcleaning.html",
    "title": "30  Text cleaning",
    "section": "",
    "text": "30.1 Stripping out text\nThroughout this class, we’ve used data from Sports Reference. If you’ve used their Share &gt; CSV method to copy data from a table, you may have noticed some extra cruft in the player name field. If you haven’t seen it, I’ll give you an example – a dataset of NBA players and their advanced metrics.\nNow load it.\nnbaplayers &lt;- read_csv(\"data/nbaplayers.csv\")\n\nNew names:\nRows: 624 Columns: 29\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(3): Player, Pos, Tm dbl (24): Rk, Age, G, MP, PER, TS%, 3PAr, FTr, ORB%, DRB%,\nTRB%, AST%, STL%,... lgl (2): ...20, ...25\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...20`\n• `` -&gt; `...25`\nLet’s take a look:\nhead(nbaplayers)\n\n# A tibble: 6 × 29\n     Rk Player     Pos     Age Tm        G    MP   PER `TS%` `3PAr`   FTr `ORB%`\n  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1     1 \"Steven A… C        26 OKC      58  1564  20.8 0.605  0.007 0.413   14.4\n2     2 \"Bam Adeb… PF       22 MIA      65  2235  20.6 0.606  0.018 0.476    8.7\n3     3 \"LaMarcus… C        34 SAS      53  1754  19.8 0.571  0.198 0.241    6.3\n4     4 \"Nickeil … SG       21 NOP      41   501   7.6 0.441  0.515 0.123    1.7\n5     5 \"Grayson … SG       24 MEM      30   498  11.4 0.577  0.517 0.199    1.1\n6     6 \"Jarrett … C        21 BRK      64  1647  20.3 0.658  0.012 0.574   12.5\n# … with 17 more variables: `DRB%` &lt;dbl&gt;, `TRB%` &lt;dbl&gt;, `AST%` &lt;dbl&gt;,\n#   `STL%` &lt;dbl&gt;, `BLK%` &lt;dbl&gt;, `TOV%` &lt;dbl&gt;, `USG%` &lt;dbl&gt;, ...20 &lt;lgl&gt;,\n#   OWS &lt;dbl&gt;, DWS &lt;dbl&gt;, WS &lt;dbl&gt;, `WS/48` &lt;dbl&gt;, ...25 &lt;lgl&gt;, OBPM &lt;dbl&gt;,\n#   DBPM &lt;dbl&gt;, BPM &lt;dbl&gt;, VORP &lt;dbl&gt;\nYou can see that every players name is their name, then two backslashes, then some version of their name that must have meaning to Sports Reference, but not to us. So we need to get rid of that.\nTo do this, we’re going to use a little regular expression magic. Regular expressions are a programmatic way to find any pattern in text. What we’re looking for is that \\\\ business. But, that presents a problem, because the \\ is a special character. It’s called an escape character. That escape character means what comes next is potentially special. For instance, if you see \\n, that’s a newline character. So normally, if you see that, it would add a return.\nSo for us to get rid of the \\ we’re going to have to escape the escape character with an escape character. And we have two of them. So we have to do it twice.\nYes. Really.\nSo if we wanted to find two backslashes, we need \\\\\\\\. Then, using regular expressions, we can say “and then everything else after this” with this: .*\nNo really. That’s it. So we’re looking for \\\\\\\\.*. That’ll find two backslashes and then everything after it. If you think this is hard … you’re right. Regular expressions are an entire month of a programming course by themselves. They are EXTREMELY powerful.\nTo find something in text, we’ll use a function called gsub. The pattern in gsub is pattern, what we want to replace it with, what column this can all be found in. So in our example, the pattern is \\\\\\\\.*, what we want to replace it with is … nothing, and this is all in the Player column. Here’s the code.\nnbaplayers |&gt; mutate(Player=gsub(\"\\\\\\\\.*\",\"\",Player)) |&gt; head()\n\n# A tibble: 6 × 29\n     Rk Player     Pos     Age Tm        G    MP   PER `TS%` `3PAr`   FTr `ORB%`\n  &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;\n1     1 Steven Ad… C        26 OKC      58  1564  20.8 0.605  0.007 0.413   14.4\n2     2 Bam Adeba… PF       22 MIA      65  2235  20.6 0.606  0.018 0.476    8.7\n3     3 LaMarcus … C        34 SAS      53  1754  19.8 0.571  0.198 0.241    6.3\n4     4 Nickeil A… SG       21 NOP      41   501   7.6 0.441  0.515 0.123    1.7\n5     5 Grayson A… SG       24 MEM      30   498  11.4 0.577  0.517 0.199    1.1\n6     6 Jarrett A… C        21 BRK      64  1647  20.3 0.658  0.012 0.574   12.5\n# … with 17 more variables: `DRB%` &lt;dbl&gt;, `TRB%` &lt;dbl&gt;, `AST%` &lt;dbl&gt;,\n#   `STL%` &lt;dbl&gt;, `BLK%` &lt;dbl&gt;, `TOV%` &lt;dbl&gt;, `USG%` &lt;dbl&gt;, ...20 &lt;lgl&gt;,\n#   OWS &lt;dbl&gt;, DWS &lt;dbl&gt;, WS &lt;dbl&gt;, `WS/48` &lt;dbl&gt;, ...25 &lt;lgl&gt;, OBPM &lt;dbl&gt;,\n#   DBPM &lt;dbl&gt;, BPM &lt;dbl&gt;, VORP &lt;dbl&gt;\nJust like that, the trash is gone.",
    "crumbs": [
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Text cleaning</span>"
    ]
  },
  {
    "objectID": "textcleaning.html#stripping-out-text",
    "href": "textcleaning.html#stripping-out-text",
    "title": "30  Text cleaning",
    "section": "",
    "text": "For this walkthrough:\n   Download csv file",
    "crumbs": [
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Text cleaning</span>"
    ]
  },
  {
    "objectID": "textcleaning.html#another-example-splitting-columns",
    "href": "textcleaning.html#another-example-splitting-columns",
    "title": "30  Text cleaning",
    "section": "30.2 Another example: splitting columns",
    "text": "30.2 Another example: splitting columns\nText cleaning is really just a set of logic puzzles. What do I need to do? How can I get there step by step?\nThe NCAA does some very interesting things with data, making it pretty useless.\nFor this walkthrough:\n   Download csv file\n\nLet’s import it and take a look.\n\nkills &lt;- read_csv(\"data/killsperset.csv\")\n\nRows: 150 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): Player, Cl, Ht, Pos, Season\ndbl (4): Rank, S, Kills, Per Set\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\nhead(kills)\n\n# A tibble: 6 × 9\n   Rank Player                      Cl    Ht    Pos       S Kills Per S…¹ Season\n  &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; \n1     1 Lindsey Ruddins, UC Santa … So.   6-2   OH       90   526    5.84 2017-…\n2     2 Pilar Victoria, Arkansas (… Sr.   5-11  OH      116   634    5.47 2017-…\n3     3 Laura Milos, Oral Roberts … Sr.   5-10  OH      106   560    5.28 2017-…\n4     4 Carlyle Nusbaum, Lipscomb … Jr.   5-10  OH      100   522    5.22 2017-…\n5     5 Veronica Jones-Perry, BYU … Jr.   6-0   OH      118   569    4.82 2017-…\n6     6 Torrey Van Winden, Cal Pol… So.   6-3   OH      101   477    4.72 2017-…\n# … with abbreviated variable name ¹​`Per Set`\n\n\nFirst things first, Player isn’t just player, it’s player, school and conference, all in one. And Ht is a character field – and in feet and inches.\nSo … this is a mess. But there is a pattern. See it? A comma after the player’s name. The Conference is in parens. We can use that.\nFor this, we’re going to use a tidyr function called separate to split columns into multiple columns based on a character. We’ll do this step by step.\nFirst, let’s use that comma to split the player and the rest. Ignore the head at the end. That’s just to keep it from showing you all 150.\n\nkills |&gt; separate(Player, into=c(\"Player\", \"School\"), sep=\",\") |&gt; head()\n\n# A tibble: 6 × 10\n   Rank Player               School Cl    Ht    Pos       S Kills Per S…¹ Season\n  &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; \n1     1 Lindsey Ruddins      \" UC … So.   6-2   OH       90   526    5.84 2017-…\n2     2 Pilar Victoria       \" Ark… Sr.   5-11  OH      116   634    5.47 2017-…\n3     3 Laura Milos          \" Ora… Sr.   5-10  OH      106   560    5.28 2017-…\n4     4 Carlyle Nusbaum      \" Lip… Jr.   5-10  OH      100   522    5.22 2017-…\n5     5 Veronica Jones-Perry \" BYU… Jr.   6-0   OH      118   569    4.82 2017-…\n6     6 Torrey Van Winden    \" Cal… So.   6-3   OH      101   477    4.72 2017-…\n# … with abbreviated variable name ¹​`Per Set`\n\n\nGood start.\nNow, let’s get the conference separated. A problem is going to crop up here – the paren is a special character, so we have to escape it with the \\\\.\n\nkills |&gt; \n  separate(Player, into=c(\"Player\", \"School\"), sep=\",\") |&gt;\n  separate(School, into=c(\"School\", \"Conference\"), sep=\"\\\\(\") |&gt; \n  head()\n\nWarning: Expected 2 pieces. Additional pieces discarded in 3 rows [15, 42, 83].\n\n\n# A tibble: 6 × 11\n   Rank Player       School Confe…¹ Cl    Ht    Pos       S Kills Per S…² Season\n  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; \n1     1 Lindsey Rud… \" UC … Big We… So.   6-2   OH       90   526    5.84 2017-…\n2     2 Pilar Victo… \" Ark… SEC)    Sr.   5-11  OH      116   634    5.47 2017-…\n3     3 Laura Milos  \" Ora… Summit… Sr.   5-10  OH      106   560    5.28 2017-…\n4     4 Carlyle Nus… \" Lip… ASUN)   Jr.   5-10  OH      100   522    5.22 2017-…\n5     5 Veronica Jo… \" BYU… WCC)    Jr.   6-0   OH      118   569    4.82 2017-…\n6     6 Torrey Van … \" Cal… Big We… So.   6-3   OH      101   477    4.72 2017-…\n# … with abbreviated variable names ¹​Conference, ²​`Per Set`\n\n\nUh oh. Says we have problems in rows 15, 42 and 83. What are they? The NCAA has decided to put (FL), (NY) and (PA) into three teams to tell you they’re in Florida, New York and Pennsylvania respectively. Well, we can fix that with some gsub and we’ll use a switch called fixed, which when set to TRUE it means this literal string, no special characters.\n\nkills |&gt; \n  separate(Player, into=c(\"Player\", \"School\"), sep=\",\") |&gt; \n  mutate(School = gsub(\"(FL)\", \"FL\", School, fixed=TRUE)) |&gt;\n  mutate(School = gsub(\"(NY)\", \"NY\", School, fixed=TRUE)) |&gt;\n  mutate(School = gsub(\"(PA)\", \"PA\", School, fixed=TRUE)) |&gt;\n  separate(School, into=c(\"School\", \"Conference\"), sep=\"\\\\(\") |&gt; \n  head()\n\n# A tibble: 6 × 11\n   Rank Player       School Confe…¹ Cl    Ht    Pos       S Kills Per S…² Season\n  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; \n1     1 Lindsey Rud… \" UC … Big We… So.   6-2   OH       90   526    5.84 2017-…\n2     2 Pilar Victo… \" Ark… SEC)    Sr.   5-11  OH      116   634    5.47 2017-…\n3     3 Laura Milos  \" Ora… Summit… Sr.   5-10  OH      106   560    5.28 2017-…\n4     4 Carlyle Nus… \" Lip… ASUN)   Jr.   5-10  OH      100   522    5.22 2017-…\n5     5 Veronica Jo… \" BYU… WCC)    Jr.   6-0   OH      118   569    4.82 2017-…\n6     6 Torrey Van … \" Cal… Big We… So.   6-3   OH      101   477    4.72 2017-…\n# … with abbreviated variable names ¹​Conference, ²​`Per Set`\n\n\nOne last thing: see the trailing paren?\n\nkills |&gt; \n  separate(Player, into=c(\"Player\", \"School\"), sep=\",\") |&gt; \n  mutate(School = gsub(\"(FL)\", \"FL\", School, fixed=TRUE)) |&gt;\n  mutate(School = gsub(\"(NY)\", \"NY\", School, fixed=TRUE)) |&gt;\n  mutate(School = gsub(\"(PA)\", \"PA\", School, fixed=TRUE)) |&gt;\n  separate(School, into=c(\"School\", \"Conference\"), sep=\"\\\\(\") |&gt; \n  mutate(Conference=gsub(\")\", \"\", Conference)) |&gt;\n  head()\n\n# A tibble: 6 × 11\n   Rank Player       School Confe…¹ Cl    Ht    Pos       S Kills Per S…² Season\n  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; \n1     1 Lindsey Rud… \" UC … Big We… So.   6-2   OH       90   526    5.84 2017-…\n2     2 Pilar Victo… \" Ark… SEC     Sr.   5-11  OH      116   634    5.47 2017-…\n3     3 Laura Milos  \" Ora… Summit… Sr.   5-10  OH      106   560    5.28 2017-…\n4     4 Carlyle Nus… \" Lip… ASUN    Jr.   5-10  OH      100   522    5.22 2017-…\n5     5 Veronica Jo… \" BYU… WCC     Jr.   6-0   OH      118   569    4.82 2017-…\n6     6 Torrey Van … \" Cal… Big We… So.   6-3   OH      101   477    4.72 2017-…\n# … with abbreviated variable names ¹​Conference, ²​`Per Set`\n\n\nLooking good, no errors.\nNow, what should we do about Ht? 6-2 is not going to tell me much when I want to run a regression of height to kills per set. And it’s a character field. So we need to convert it to numbers.\nSeparate again comes to the rescue.\n\nkills |&gt; \n  separate(Player, into=c(\"Player\", \"School\"), sep=\",\") |&gt; \n  mutate(School = gsub(\"(FL)\", \"FL\", School, fixed=TRUE)) |&gt;\n  mutate(School = gsub(\"(NY)\", \"NY\", School, fixed=TRUE)) |&gt;\n  mutate(School = gsub(\"(PA)\", \"PA\", School, fixed=TRUE)) |&gt;\n  separate(School, into=c(\"School\", \"Conference\"), sep=\"\\\\(\") |&gt; \n  mutate(Conference=gsub(\")\", \"\", Conference)) |&gt;\n  separate(Ht, into=c(\"Feet\", \"Inches\"), sep=\"-\") |&gt;\n  mutate(Feet = as.numeric(Feet), Inches = as.numeric(Inches)) |&gt;\n  head()\n\n# A tibble: 6 × 12\n   Rank Player       School Confe…¹ Cl     Feet Inches Pos       S Kills Per S…²\n  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n1     1 Lindsey Rud… \" UC … Big We… So.       6      2 OH       90   526    5.84\n2     2 Pilar Victo… \" Ark… SEC     Sr.       5     11 OH      116   634    5.47\n3     3 Laura Milos  \" Ora… Summit… Sr.       5     10 OH      106   560    5.28\n4     4 Carlyle Nus… \" Lip… ASUN    Jr.       5     10 OH      100   522    5.22\n5     5 Veronica Jo… \" BYU… WCC     Jr.       6      0 OH      118   569    4.82\n6     6 Torrey Van … \" Cal… Big We… So.       6      3 OH      101   477    4.72\n# … with 1 more variable: Season &lt;chr&gt;, and abbreviated variable names\n#   ¹​Conference, ²​`Per Set`\n\n\nBut how do we turn that into a height? Math!\n\nkills |&gt; \n  separate(Player, into=c(\"Player\", \"School\"), sep=\",\") |&gt; \n  mutate(School = gsub(\"(FL)\", \"FL\", School, fixed=TRUE)) |&gt;\n  mutate(School = gsub(\"(NY)\", \"NY\", School, fixed=TRUE)) |&gt;\n  mutate(School = gsub(\"(PA)\", \"PA\", School, fixed=TRUE)) |&gt;\n  separate(School, into=c(\"School\", \"Conference\"), sep=\"\\\\(\") |&gt; \n  mutate(Conference=gsub(\")\", \"\", Conference)) |&gt;\n  separate(Ht, into=c(\"Feet\", \"Inches\"), sep=\"-\") |&gt;\n  mutate(Feet = as.numeric(Feet), Inches = as.numeric(Inches)) |&gt;\n  mutate(Height = (Feet*12)+Inches) |&gt;\n  head()\n\n# A tibble: 6 × 13\n   Rank Player       School Confe…¹ Cl     Feet Inches Pos       S Kills Per S…²\n  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;\n1     1 Lindsey Rud… \" UC … Big We… So.       6      2 OH       90   526    5.84\n2     2 Pilar Victo… \" Ark… SEC     Sr.       5     11 OH      116   634    5.47\n3     3 Laura Milos  \" Ora… Summit… Sr.       5     10 OH      106   560    5.28\n4     4 Carlyle Nus… \" Lip… ASUN    Jr.       5     10 OH      100   522    5.22\n5     5 Veronica Jo… \" BYU… WCC     Jr.       6      0 OH      118   569    4.82\n6     6 Torrey Van … \" Cal… Big We… So.       6      3 OH      101   477    4.72\n# … with 2 more variables: Season &lt;chr&gt;, Height &lt;dbl&gt;, and abbreviated variable\n#   names ¹​Conference, ²​`Per Set`\n\n\nAnd now, in 10 lines of code, using separate, mutate and gsub, we’ve turned the mess that is the NCAA’s data into actually useful data we can analyze.\nThese patterns of thought come in handy when facing messed up data.",
    "crumbs": [
      "<span class='chapter-number'>30</span>  <span class='chapter-title'>Text cleaning</span>"
    ]
  },
  {
    "objectID": "headlines.html",
    "href": "headlines.html",
    "title": "31  Headlines",
    "section": "",
    "text": "These are the pieces of a good graphic:\n\nHeadline\nChatter\nThe main body\nAnnotations\nLabels\nSource line\nCredit line\n\nThe first on that list is the first for a reason. The headline is an incredibly important part of any graphic: it’s often the first thing a reader will see. It’s got to entice people in, tell them a little bit about what they’re going to see, and help tell the story.\nThe second item is the chatter – the text underneath that headline. It needs to work with the headline to further the story, drive people toward the point, maybe add some context.\nThe two bits of text are extremely important. Let’s set up a chart and talk about how to do it wrong and how to do it better.\n\nlibrary(tidyverse)\nlibrary(ggrepel)\n\nThe data and the chart code isn’t important for you to follow along. The code is nothing special. The issues will be with the words that you’ll see below.\n\nscoring &lt;- read_csv(\"data/scoringoffense.csv\")\n\nRows: 1253 Columns: 10\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Name\ndbl (9): G, TD, FG, 1XP, 2XP, Safety, Points, Points/G, Year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntotal &lt;- read_csv(\"data/totaloffense.csv\")\n\nRows: 1253 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Name\ndbl (8): G, Rush Yards, Pass Yards, Plays, Total Yards, Yards/Play, Yards/G,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\noffense &lt;- total |&gt; left_join(scoring, by=c(\"Name\", \"Year\"))\n\numd &lt;- offense |&gt; filter(Name == \"Maryland\") |&gt; filter(Year == 2018)\n\n\nggplot(offense, aes(x=`Yards/G`, y=`Points/G`)) + \n  geom_point(color=\"grey\") + geom_smooth(method=lm, se=FALSE) + \n  labs(x=\"Total yards per game\", y=\"Points per game\", title=\"Headline here\", subtitle=\"This is the chatter. It is chatter. Chatter.\", caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nFirst, let’s start with some headline basics:\n\nYour headline should be about what the chart is about, not what makes up the chart. What story is the chart telling? What made it interesting to you? Don’t tell me what the stats are, tell me what it says.\nYour headline should be specific. Generic headlines are boring and ignored.\nYour headline should, most often, have a verb. It’s not a 100 percent requirement, but a headline without a verb means you’re trying to be cute and …\nYour headline shouldn’t be overly cute. Trying to get away with slang, a very Of The Moment cultural reference that will be forgotten soon, or some inside joke is asking for trouble.\nYour headline should provoke a reaction.\n\nGiven our graph, here’s a few that don’t work.\n\nggplot(offense, aes(x=`Yards/G`, y=`Points/G`)) + \n  geom_point(color=\"grey\") + geom_smooth(method=lm, se=FALSE) + \n  labs(x=\"Total yards per game\", y=\"Points per game\", title=\"Maryland's offense\", subtitle=\"Maryland's 2018 offense is the red dot.\", caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nThe problems here:\n\nNo verb.\nGeneric, forgettable, doesn’t say anything.\nWhat is this chart about? What does it say? We have no idea from the headline and chatter.\nDon’t repeat words from the headline in the chatter. Nebraska Nebraska looks bad. Make one of the Huskers if you’re going to do this.\n\nAnother example:\n\nggplot(offense, aes(x=`Yards/G`, y=`Points/G`)) + \n  geom_point(color=\"grey\") + geom_smooth(method=lm, se=FALSE) + \n  labs(x=\"Total yards per game\", y=\"Points per game\", title=\"Points per game vs total yards per game\", subtitle=\"Maryland's 2018 offense is above the blue line, which is good.\", caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWhat’s wrong here?\n\nThe headline is about the stats, not the story.\nThe headline lacks a verb.\nThe headline lacks any interest, really.\nThe headline at least moves in the direction of what this chart is about, but see the previous two.\nThe chatter adds more flavor to it, but what does “below the blue line” even mean? We’re leaving the reader with a lot of questions and no real answers. That;s bad.\n\nLet’s try to do this better.\n\nggplot(offense, aes(x=`Yards/G`, y=`Points/G`)) + \n  geom_point(color=\"grey\") + geom_smooth(method=lm, se=FALSE) + \n  labs(x=\"Total yards per game\", y=\"Points per game\", title=\"Maryland's strength\", subtitle=\"The Terps' offense was supposed to power the team, and it did.\", caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWhat works here:\n\nProvokes a reaction by asking a question. Drives at what the story is about.\nThe chatter answers the question in the headline without talking about the blue line, a model, anything. A reader can see it.\nSimple, precise, direct language.\n\nOne more, same chart.\n\nggplot(offense, aes(x=`Yards/G`, y=`Points/G`)) + \n  geom_point(color=\"grey\") + geom_smooth(method=lm, se=FALSE) + \n  labs(x=\"Total yards per game\", y=\"Points per game\", title=\"Maryland's offense overperformed\", subtitle=\"The Terps' offense fared better than many given their output.\", caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nWhat works here:\n\nStrong verb: overperformed.\nHeadline tells the story. Chatter bolsters it.\nDoesn’t repeat Maryland or Terps\n\nTaking time to sharpen your headlines will make your graphics better.",
    "crumbs": [
      "<span class='chapter-number'>31</span>  <span class='chapter-title'>Headlines</span>"
    ]
  },
  {
    "objectID": "annotations.html",
    "href": "annotations.html",
    "title": "32  Annotations",
    "section": "",
    "text": "Some of the best sports data visualizations start with a provocative question. How about this one: Who really belongs in the college football playoffs and why is it never Notre Dame?\nFor this, we’re going to go back to some code we started in Bubble Charts and we’re going to add some annotations to it. Annotations help us draw attention to things, or help the reader understand what they’re looking at. They’re labels on things, be that the teams we want to highlight or regions of the chart or lines or all of those things.\nFor this, we’ll need to add a new library to the mix called ggrepel. You’ll need to install it in the console with install.packages(\"ggrepel\").\n\nlibrary(tidyverse)\nlibrary(ggrepel)\n\nNow we’ll grab the data, each football game in 2021.\nFor this walkthrough:\n   Download csv file\n\nNow load it.\n\nlogs &lt;- read_csv(\"data/footballlogs22.csv\")\n\nRows: 1672 Columns: 54\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (8): HomeAway, Opponent, Result, TeamFull, TeamURL, Outcome, Team, Con...\ndbl  (45): Game, PassingCmp, PassingAtt, PassingPct, PassingYds, PassingTD, ...\ndate  (1): Date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nI’m going to set up a point chart that places teams on two-axes – yards per play on offense on the x axis, and yards per play on defense. We did this in the bubble charts example.\n\nlogs |&gt; \n  group_by(Team, Conference) |&gt; \n  summarise(\n    TotalPlays = sum(OffensivePlays), \n    TotalYards = sum(OffensiveYards), \n    DefensivePlays = sum(DefPlays), \n    DefensiveYards = sum(DefYards)) |&gt; \n  mutate(\n    OffensiveYPP = TotalYards/TotalPlays, \n    DefensiveYPP = DefensiveYards/DefensivePlays) -&gt; ypp\n\n`summarise()` has grouped output by 'Team'. You can override using the\n`.groups` argument.\n\n\nTo build the annotations, I want the average for offensive yards per play and defensive yards per play. We’re going to use those as a proxy for quality. If your team averages more yards per play on offense, that’s good. If they average fewer yards per play on defense, that too is good. So that sets up a situation where we have four corners, anchored by good at both and bad at both. The averages will create lines to divide those four corners up.\n\naverages &lt;- ypp |&gt; ungroup() |&gt; summarise(AvgOffYardsPer = mean(OffensiveYPP), AvgDefYardsPer = mean(DefensiveYPP))\n\naverages\n\n# A tibble: 1 × 2\n  AvgOffYardsPer AvgDefYardsPer\n           &lt;dbl&gt;          &lt;dbl&gt;\n1           5.70           5.55\n\n\nI also want to highlight playoff teams.\n\nplayoff_teams &lt;- c(\"Texas Christian\", \"Georgia\", \"Michigan\", \"Ohio State\")\n\nplayoffs &lt;- ypp |&gt; filter(Team %in% playoff_teams)\n\nNow we create the plot. We have two geom_points, starting with everyone, then playoff teams. I alter the colors on each to separate them. Next, I add a geom_hline to add the horizontal line of my defensive average and a geom_vline for my offensive average. Next, I want to add some text annotations, labeling two corners of my chart (the other two, in my opinion, become obvious). Then, I want to label all the playoff teams. I use geom_text_repel to do that – it’s using the ggrepel library to push the text away from the dots, respective of other labels and other dots. It means you don’t have to move them around so you can read them, or so they don’t cover up the dots.\nThe rest is just adding labels and messing with the theme.\n\nggplot() + \n  geom_point(data=ypp, aes(x=OffensiveYPP, y=DefensiveYPP), color=\"light grey\") +\n  geom_point(data=playoffs, aes(x=OffensiveYPP, y=DefensiveYPP)) +\n  geom_hline(yintercept=5.7, color=\"dark grey\") + \n  geom_vline(xintercept=5.7, color=\"dark grey\") + \n  geom_text(aes(x=6.7, y=4.3, label=\"Good Offense, Good Defense\"), color=\"blue\") +\n  geom_text(aes(x=5, y=6, label=\"Bad Defense, Bad Offense\"), color=\"blue\") +\n  geom_text_repel(data=playoffs, aes(x=OffensiveYPP, y=DefensiveYPP, label=Team)) +\n  labs(x=\"Offensive Yards Per Play\", y=\"Defensive Points Per Play\", title=\"All four playoff teams were good\", subtitle=\"Three of the four have above average offenses and defenses.\", caption=\"Source: Sports-Reference.com | By Derek Willis\") +\n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.text = element_text(size = 7),\n    axis.ticks = element_blank(),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank()\n  )",
    "crumbs": [
      "<span class='chapter-number'>32</span>  <span class='chapter-title'>Annotations</span>"
    ]
  },
  {
    "objectID": "finishingtouches.html",
    "href": "finishingtouches.html",
    "title": "33  Finishing touches",
    "section": "",
    "text": "33.1 Graphics vs visual stories\nWhile the elements above are nearly required in every chart, they aren’t when you are making visual stories.\nAn example from The Upshot. Note how the charts don’t have headlines, source or credit lines.",
    "crumbs": [
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Finishing touches</span>"
    ]
  },
  {
    "objectID": "finishingtouches.html#graphics-vs-visual-stories",
    "href": "finishingtouches.html#graphics-vs-visual-stories",
    "title": "33  Finishing touches",
    "section": "",
    "text": "When you have a visual story, things like credit lines can become a byline.\nIn visual stories, source lines are often a note at the end of the story.\nGraphics don’t always get headlines – sometimes just labels, letting the visual story headline carry the load.",
    "crumbs": [
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Finishing touches</span>"
    ]
  },
  {
    "objectID": "finishingtouches.html#getting-ggplot-closer-to-output",
    "href": "finishingtouches.html#getting-ggplot-closer-to-output",
    "title": "33  Finishing touches",
    "section": "33.2 Getting ggplot closer to output",
    "text": "33.2 Getting ggplot closer to output\nLet’s explore fixing up ggplot’s output before we send it to a finishing program like Adobe Illustrator. We’ll need a graphic to work with first.\n\nlibrary(tidyverse)\nlibrary(ggrepel)\n\nHere’s the data we’ll use: college football team scoring from 2009-2018.\nFor this walkthrough:\n   Download csv file\n\n   Download csv file\n\nLet’s load them and join them together.\n\nscoring &lt;- read_csv(\"data/scoringoffense.csv\")\n\nRows: 1253 Columns: 10\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Name\ndbl (9): G, TD, FG, 1XP, 2XP, Safety, Points, Points/G, Year\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntotal &lt;- read_csv(\"data/totaloffense.csv\")\n\nRows: 1253 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Name\ndbl (8): G, Rush Yards, Pass Yards, Plays, Total Yards, Yards/Play, Yards/G,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\noffense &lt;- total |&gt; left_join(scoring, by=c(\"Name\", \"Year\"))\n\nWe’re going to need this later, so let’s grab Maryland’s 2018 stats from this dataframe.\n\numd &lt;- offense |&gt; \n  filter(Name == \"Maryland\") |&gt; \n  filter(Year == 2018)\n\nWe’ll start with the basics.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\")\n\n\n\n\n\n\n\n\nLet’s take changing things one by one. The first thing we can do is change the figure size. Sometimes you don’t want a square. We can use the knitr output settings in our chunk to do this easily in our notebooks.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\")\n\n\n\n\n\n\n\n\nNow let’s add a fit line.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") +\n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE)\n\n\n\n\n\n\n\n\nAnd now some labels.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team. They overperformed.\",\n    caption=\"Source: NCAA | By Derek Willis\"\n    )\n\n\n\n\n\n\n\n\nLet’s get rid of the default plot look and drop the grey background.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team. They overperformed.\",\n    caption=\"Source: NCAA | By Derek Willis\"\n    ) + \n  theme_minimal()\n\n\n\n\n\n\n\n\nOff to a good start, but our text has no real heirarchy. We’d want our headline to stand out more. So let’s change that. When it comes to changing text, the place to do that is in the theme element. There are a lot of ways to modify the theme. We’ll start easy. Let’s make the headline bigger and bold.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team. They overperformed.\",\n    caption=\"Source: NCAA | By Derek Willis\") +\n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 20, face = \"bold\")\n    ) \n\n\n\n\n\n\n\n\nNow let’s fix a few other things – like the axis labels being too big, the subtitle could be bigger and lets drop some grid lines.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team. They overperformed.\",\n    caption=\"Source: NCAA | By Derek Willis\") +\n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 20, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) \n\n\n\n\n\n\n\n\nMissing from this graph is the context that the headline promises. Where is Maryland? We haven’t added it yet. So let’s add a point and a label for it.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team. They overperformed.\",\n    caption=\"Source: NCAA | By Derek Willis\") +\n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n\n\n\n\n\n\n\nIf we’re happy with this output – if it meets all of our needs for publication – then we can simply export it as a png file. We do that by adding + ggsave(\"plot.png\", width=5, height=2) to the end of our code. Note the width and the height are from our knitr parameters at the top – you have to repeat them or the graph will export at the default 7x7.\nIf there’s more work you want to do with this graph that isn’t easy or possible in R but is in Illustrator, simply change the file extension to pdf instead of png. The pdf will open as a vector file in Illustrator with everything being fully editable.",
    "crumbs": [
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Finishing touches</span>"
    ]
  },
  {
    "objectID": "finishingtouches.html#waffle-charts-require-special-attention",
    "href": "finishingtouches.html#waffle-charts-require-special-attention",
    "title": "33  Finishing touches",
    "section": "33.3 Waffle charts require special attention",
    "text": "33.3 Waffle charts require special attention\nFrequently in my classes, students use the waffle charts library quite extensively to make graphics. This is a quick walkthough on how to get a waffle chart into a publication ready state.\n\nlibrary(waffle)\n\nLet’s look at the offensive numbers from the 2021 Maryland v. Illinois football game. Maryland won 20-17, even though the Terps outgained the Illini by 113 yards. You can find the official stats on the NCAA’s website.\nI’m going to make two vectors for each team and record rushing yards and passing yards.\n\nmd &lt;- c(\"Rushing\"=131, \"Passing\"=350, 113)\nil &lt;- c(\"Rushing\"=183, \"Passing\"=185, 0)\n\nSo what does the breakdown of Maryland’s night look like? How balanced was the offense?\nThe waffle library can break this down in a way that’s easier on the eyes than a pie chart. We call the library, add the data, specify the number of rows, give it a title and an x value label, and to clean up a quirk of the library, we’ve got to specify colors.\nADDITIONALLY\nWe can add labels and themes, but you have to be careful. The waffle library is applying it’s own theme, but if we override something they are using in their theme, some things that are hidden come back and make it worse. So here is an example of how to use ggplot’s labs and the theme to make a fully publication ready graphic.\n\nwaffle(md/10, rows = 5, xlab=\"1 square = 10 yards\", colors = c(\"black\", \"red\", \"white\")) + \n  labs(\n    title=\"Maryland vs Illinois on offense\", \n    subtitle=\"The Terps couldn't get much of a running game going.\",\n    caption=\"Source: NCAA | Graphic by Derek Willis\") + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n  )\n\n\n\n\n\n\n\n\nBut what if we’re using a waffle iron? And what if we want to change the output size? It gets tougher.\nTruth is, I’m not sure what is going on with the sizing. You can try it and you’ll find that the outputs are … unpredictable.\nThings you need to know about waffle irons:\n\nThey’re a convenience method, but all they’re really doing is executing two waffle charts together. If you don’t apply the theme to both waffle charts, it breaks.\nYou will have to get creative about applying headline and subtitle to the top waffle chart and the caption to the bottom.\nUsing ggsave doesn’t work either. So you’ll have to use R’s pdf output.\n\nHere is a full example. I start with my waffle iron code, but note that each waffle is pretty much a self contained thing. That’s because a waffle iron isn’t really a thing. It’s just a way to group waffles together, so you have to make each waffle individually. My first waffle has the title and subtitle but no x axis labels and the bottom one has not title or subtitle but the axis labels and the caption.\n\niron(\n waffle(\n   md/10, \n   rows = 2, \n   xlab=\"Maryland\",\n   colors = c(\"black\", \"red\", \"white\")) + \n   labs(\n     title=\"Maryland vs Illinois: By the numbers\", \n     subtitle=\"The Terps couldn't run, the Illini could.\") + \n   theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 10),\n    axis.title.y = element_blank()\n  ),\n waffle(\n   il/10, \n   rows = 2, \n   xlab=\"Illinois\\n1 square = 10 yards\", \n   colors = c(\"orange\", \"blue\", \"white\")) + \n   labs(caption=\"Source: NCAA | Graphic by Derek Willis\")\n)",
    "crumbs": [
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Finishing touches</span>"
    ]
  },
  {
    "objectID": "finishingtouches.html#advanced-text-wrangling",
    "href": "finishingtouches.html#advanced-text-wrangling",
    "title": "33  Finishing touches",
    "section": "33.4 Advanced text wrangling",
    "text": "33.4 Advanced text wrangling\nSometimes, you need a little more help with text than what is easily available. Sometimes you want a little more in your finishing touches. Let’s work on some issues common in projects that can be fixed with new new libraries: multi-line chatter, axis labels that need more than just a word, axis labels that don’t fit, and additional text boxes.\nFirst things first, we’ll need to install ggtext with install.packages. Then we’ll load it.\n\nlibrary(ggtext)\n\nLet’s go back to our scatterplot above. As created, it’s very simple, and the chatter doesn’t say much. Let’s write chatter that instead of being super spare is more verbose.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team, having to overcome a defense that often struggled to stop opponents. If you compare the offense to every other offense and how many points they score vs the number of yards they roll up, Maryland actually overperformed.\", \n    caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_text(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n\n\n\n\n\n\n\nYou can see the problem right away – it’s too long and gets cut off. One way to fix this is to put \\n where you think the line break should be. That’s a newline character, so it would add a return there. But with ggtext, you can use simple HTML to style the text, which opens up a lot of options. We can use a  to break the line. The other thing we need to do is in the theme element, change the element_text for plot.subtitle to element_markdown.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team, having to overcome a defense that often struggled to stop&lt;br/&gt;opponents. If you compare the offense to every other offense and how many points they score vs the number of&lt;br/&gt; yards they roll up, Maryland actually overperformed.\", \n    caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_markdown(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n\n\n\n\n\n\n\nWith ggtext, there’s a lot more you can do with CSS, like change the color of text, that I don’t recommend. Also, there’s only a few HTML tags that have been implemented. For example, you can’t add links because the a tag hasn’t been added.\nAnother sometimes useful thing you can do is add much more explanation to your axis labels. This is going to be a silly example because “Points per game” is pretty self-explanatory, but roll with it. First, we create an unusually long y axis label, then, in theme, we add some code to axis.title.y.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game is an imperfect metric of offensive efficiency because defenses and special teams score points as well.\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team, having to overcome a defense that often struggled to stop&lt;br/&gt;opponents. If you compare the offense to every other offense and how many points they score vs the number of&lt;br/&gt; yards they roll up, Maryland actually overperformed.\", \n    caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_markdown(size=10), \n    panel.grid.minor = element_blank(),\n    axis.title.y = element_textbox_simple(\n      orientation = \"left-rotated\",\n      width = grid::unit(2.5, \"in\")\n    )\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))\n\n\n\n\n\n\n\n\nOne last advanced trick: Adding a text box explainer in the graphic. This should be used in somewhat rare circumstances – you don’t want to pollute your data space with lots of text. If your graphic needs so much explainer text, you should be asking yourself hard questions about if your chart is clearly telling a story.\nTo add a text box explainer, you need to add a geom_textbox to your chart. The code below does that, and also adds a geom_point to anchor the box to a spot.\n\nggplot() + \n  geom_point(data=offense, aes(x=`Yards/G`, y=`Points/G`), color=\"grey\") + \n  geom_smooth(data=offense, aes(x=`Yards/G`, y=`Points/G`), method=lm, se=FALSE) + \n  geom_textbox(\n    aes(x=225, \n        y=50, \n        label=\"Dots above the blue line indicate offenses that scored more points than their yards per game would suggest they should.\", \n        orientation = \"upright\", \n        hjust=0, \n        vjust=1), width = unit(2.8, \"in\")) +\n  geom_point(aes(x=225, y=50), size=2) + \n  labs(\n    x=\"Total yards per game\", \n    y=\"Points per game\", \n    title=\"Maryland's overperforming offense\", \n    subtitle=\"The Terps' offense was the strength of the team, having to overcome a defense that often struggled to stop&lt;br/&gt;opponents. If you compare the offense to every other offense and how many points they score vs the number of&lt;br/&gt; yards they roll up, Maryland actually overperformed.\", \n    caption=\"Source: NCAA | By Derek Willis\") + \n  theme_minimal() + \n  theme(\n    plot.title = element_text(size = 16, face = \"bold\"),\n    axis.title = element_text(size = 8), \n    plot.subtitle = element_markdown(size=10), \n    panel.grid.minor = element_blank()\n    ) +\n  geom_point(data=umd, aes(x=`Yards/G`, y=`Points/G`), color=\"red\") + \n  geom_text_repel(data=umd, aes(x=`Yards/G`, y=`Points/G`, label=\"Maryland 2018\"))",
    "crumbs": [
      "<span class='chapter-number'>33</span>  <span class='chapter-title'>Finishing touches</span>"
    ]
  },
  {
    "objectID": "rvest.html",
    "href": "rvest.html",
    "title": "34  Intro to rvest",
    "section": "",
    "text": "34.1 A slightly more complicated example\nWhat if we want more than one year in our dataframe?\nThis is a common problem. What if we want to look at every scoring offense going back several years? The website has them going back to 2009. How can we combine them?\nFirst, we should note, that the data does not have anything in it to indicate what year it comes from. So we’re going to have to add that. And we’re going to have to figure out a way to stack two dataframes on top of each other.\nSo let’s grab 2022.\nscoringoffenseurl22 &lt;- \"http://www.cfbstats.com/2022/leader/national/team/offense/split01/category09/sort01.html\"\n\nscoringoffense22 &lt;- scoringoffenseurl22 |&gt;\n  read_html() |&gt;\n  html_nodes(xpath = '//*[@id=\"content\"]/div[2]/table') |&gt;\n  html_table()\n\nscoringoffense22 &lt;- scoringoffense22[[1]]\nFirst, how are we going to know, in the data, which year our data is from? We can use mutate.\nscoringoffense22 &lt;- scoringoffense22 |&gt; mutate(YEAR = 2022)\n\nError in initialize(...): attempt to use zero-length variable name\nUh oh. Error. What does it say? It’s … not clear, but a hint is that our first column doesn’t have a name. Each column must be named. If you look at our data in the environment tab in the upper right corner, you’ll see that indeed, the first column has no name. It’s the FBS rank of each team. So we can fix that and mutate in the same step. We’ll do that using rename and since the field doesn’t have a name to rename it, we’ll use a position argument. We’ll say rename column 1 as Rank.\nscoringoffense23 &lt;- scoringoffense |&gt; rename(Rank = 1) |&gt; mutate(YEAR = 2023)\nscoringoffense22 &lt;- scoringoffense22 |&gt; rename(Rank = 1) |&gt; mutate(YEAR = 2022)\nAnd now, to combine the two tables together length-wise – we need to make long data – we’ll use a dpylr function called bind_rows. The good thing is bind_rows is simple.\ncombined &lt;- bind_rows(scoringoffense23, scoringoffense22)\nNote in the environment tab we now have a data frame called combined that has 264 observations – which just so happens to be what 131 from 2022 and 133 from 2023 add up to.\nhead(combined)\n\n# A tibble: 6 × 11\n   Rank Name         G    TD    FG `1XP` `2XP` Safety Points `Points/G`  YEAR\n  &lt;int&gt; &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;  &lt;int&gt;      &lt;dbl&gt; &lt;dbl&gt;\n1     1 LSU         13    79    12    78     1      1    592       45.5  2023\n2     2 Oregon      14    83    12    75     5      0    619       44.2  2023\n3     3 USC         13    74    10    66     2      0    544       41.8  2023\n4     4 Oklahoma    13    71    15    69     0      1    542       41.7  2023\n5     5 Georgia     14    71    21    71     0      1    562       40.1  2023\n6     6 Memphis     13    68    13    61     2      0    512       39.4  2023",
    "crumbs": [
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Intro to rvest</span>"
    ]
  },
  {
    "objectID": "rvest.html#an-even-more-complicated-example",
    "href": "rvest.html#an-even-more-complicated-example",
    "title": "34  Intro to rvest",
    "section": "34.2 An even more complicated example",
    "text": "34.2 An even more complicated example\nWhat do you do when the table has non-standard headers?\nUnfortunately, non-standard means there’s no one way to do it – it’s going to depend on the table and the headers. But here’s one idea: Don’t try to make it work.\nI’ll explain.\nLet’s try to get season team stats from Sports Reference. If you look at that page, you’ll see the problem right away – the headers span two rows, and they repeat. That’s going to be all kinds of no good. You can’t import that. Dataframes must have names all in one row. If you have two-line headers, you have a problem you have to fix before you can do anything else with it.\nFirst we’ll grab the page.\n\nurl &lt;- \"https://www.sports-reference.com/cbb/seasons/2023-school-stats.html\"\n\nNow, similar to our example above, we’ll read the html, use XPath to find the table, and then read that table with a directive passed to it setting the header to FALSE. That tells rvest that there isn’t a header row. Just import it as data.\n\nstats &lt;- url |&gt;\n  read_html() |&gt;\n  html_nodes(xpath = '//*[@id=\"basic_school_stats\"]') |&gt;\n  html_table(header=FALSE)\n\nWhat we get back is a list of one element (similar to above). So let’s pop it out into a data frame.\n\nstats &lt;- stats[[1]] |&gt; slice(-1) |&gt; slice(-1)\n\nAnd we’ll take a look at what we have.\n\nhead(stats)\n\n# A tibble: 6 × 38\n  X1    X2     X3    X4    X5    X6    X7    X8    X9    X10   X11   X12   X13  \n  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt; &lt;chr&gt;\n1 1     Abile… 30    13    17    .433  -2.79 0.90  NA    5     11    NA    9    \n2 2     Air F… 32    14    18    .438  2.00  2.12  NA    5     13    NA    10   \n3 3     Akron  33    22    11    .667  4.19  -1.65 NA    13    5     NA    15   \n4 4     Alaba… 37    31    6     .838  23.19 9.65  NA    16    2     NA    15   \n5 5     Alaba… 33    15    18    .455  -10.… -7.71 NA    10    8     NA    9    \n6 6     Alaba… 31    8     23    .258  -16.… -6.29 NA    6     12    NA    5    \n# … with 25 more variables: X14 &lt;chr&gt;, X15 &lt;lgl&gt;, X16 &lt;chr&gt;, X17 &lt;chr&gt;,\n#   X18 &lt;lgl&gt;, X19 &lt;chr&gt;, X20 &lt;chr&gt;, X21 &lt;lgl&gt;, X22 &lt;chr&gt;, X23 &lt;chr&gt;,\n#   X24 &lt;chr&gt;, X25 &lt;chr&gt;, X26 &lt;chr&gt;, X27 &lt;chr&gt;, X28 &lt;chr&gt;, X29 &lt;chr&gt;,\n#   X30 &lt;chr&gt;, X31 &lt;chr&gt;, X32 &lt;chr&gt;, X33 &lt;chr&gt;, X34 &lt;chr&gt;, X35 &lt;chr&gt;,\n#   X36 &lt;chr&gt;, X37 &lt;chr&gt;, X38 &lt;chr&gt;\n\n\nSo, that’s not ideal. We have headers and data mixed together, and our columns are named X1 to X38. Also note: They’re all character fields. Because the headers are interspersed with data, it all gets called character data. So we’ve got to first rename each field.\n\nstats &lt;- stats |&gt; rename(Rank=X1, School=X2, Games=X3, OverallWins=X4, OverallLosses=X5, WinPct=X6, OverallSRS=X7, OverallSOS=X8, Blank1=X9, ConferenceWins=X10, ConferenceLosses=X11, Blank2=X12, HomeWins=X13, HomeLosses=X14, Blank3=X15, AwayWins=X16, AwayLosses=X17, Blank4=X18, ForPoints=X19, OppPoints=X20, Blank5=X21, Minutes=X22, FieldGoalsMade=X23, FieldGoalsAttempted=X24, FieldGoalPCT=X25, ThreePointMade=X26, ThreePointAttempts=X27, ThreePointPct=X28, FreeThrowsMade=X29, FreeThrowsAttempted=X30, FreeThrowPCT=X31, OffensiveRebounds=X32, TotalRebounds=X33, Assists=X34, Steals=X35, Blocks=X36, Turnovers=X37, PersonalFouls=X38)\n\nNow we have to get rid of those headers interspersed in the data. We can do that with filter that say keep all the stuff that isn’t this.\n\nstats &lt;- stats |&gt; filter(Rank != \"Rk\" & Games != \"Overall\") \n\nAnd finally, we need to change the file type of all the fields that need it. We’re going to use a clever little trick, which goes like this: We’re going to use mutate_at, which means mutate these fields. The pattern for mutate_at is mutate_at these variables and do this thing to them. But instead of specifying which of 38 variables we’re going to mutate, we’re going to specify the one we don’t want to change, which is the name of the school. And we just want to convert them to numeric, which is simple. Here’s what it looks like:\n\nstats &lt;- stats |&gt; mutate_at(vars(-School), as.numeric)\n\nOne last thing: Who needs columns called Blank1, Blank2, Blank3, etc?\n\nstats &lt;- stats |&gt; select(-starts_with(\"Blank\"))\n\nAnd just like that, we have a method for getting up to the minute season stats for every team in Division I.\n\nhead(stats)\n\n# A tibble: 6 × 33\n   Rank School      Games Overa…¹ Overa…² WinPct Overa…³ Overa…⁴ Confe…⁵ Confe…⁶\n  &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1     1 Abilene Ch…    30      13      17  0.433   -2.79    0.9        5      11\n2     2 Air Force      32      14      18  0.438    2       2.12       5      13\n3     3 Akron          33      22      11  0.667    4.19   -1.65      13       5\n4     4 Alabama NC…    37      31       6  0.838   23.2     9.65      16       2\n5     5 Alabama A&M    33      15      18  0.455  -10.8    -7.71      10       8\n6     6 Alabama St…    31       8      23  0.258  -16.3    -6.29       6      12\n# … with 23 more variables: HomeWins &lt;dbl&gt;, HomeLosses &lt;dbl&gt;, AwayWins &lt;dbl&gt;,\n#   AwayLosses &lt;dbl&gt;, ForPoints &lt;dbl&gt;, OppPoints &lt;dbl&gt;, Minutes &lt;dbl&gt;,\n#   FieldGoalsMade &lt;dbl&gt;, FieldGoalsAttempted &lt;dbl&gt;, FieldGoalPCT &lt;dbl&gt;,\n#   ThreePointMade &lt;dbl&gt;, ThreePointAttempts &lt;dbl&gt;, ThreePointPct &lt;dbl&gt;,\n#   FreeThrowsMade &lt;dbl&gt;, FreeThrowsAttempted &lt;dbl&gt;, FreeThrowPCT &lt;dbl&gt;,\n#   OffensiveRebounds &lt;dbl&gt;, TotalRebounds &lt;dbl&gt;, Assists &lt;dbl&gt;, Steals &lt;dbl&gt;,\n#   Blocks &lt;dbl&gt;, Turnovers &lt;dbl&gt;, PersonalFouls &lt;dbl&gt;, and abbreviated …",
    "crumbs": [
      "<span class='chapter-number'>34</span>  <span class='chapter-title'>Intro to rvest</span>"
    ]
  },
  {
    "objectID": "advancedrvest.html",
    "href": "advancedrvest.html",
    "title": "35  Advanced rvest",
    "section": "",
    "text": "35.1 One last bit\nMost tables that Sports Reference sites have are in plain vanilla HTML. But some of them – particularly player based stuff – are hidden with a little trick. The site puts the data in a comment – where a browser will ignore it – and then uses javascript to interpret the commented data. To a human on the page, it looks the same. To a browser or a scraper, it’s invisible. You’ll get errors. How do you get around it?\nh &lt;- read_html('https://www.baseball-reference.com/leagues/MLB/2023-standard-pitching.shtml')\n\ndf &lt;- h |&gt; html_nodes(xpath = '//comment()') |&gt;    # select comment nodes\n    html_text() |&gt;    # extract comment text\n    paste(collapse = '') |&gt;    # collapse to a single string\n    read_html() |&gt;    # reparse to HTML\n    html_node('table') |&gt;    # select the desired table\n    html_table()",
    "crumbs": [
      "<span class='chapter-number'>35</span>  <span class='chapter-title'>Advanced rvest</span>"
    ]
  },
  {
    "objectID": "advancedrvest.html#one-last-bit",
    "href": "advancedrvest.html#one-last-bit",
    "title": "35  Advanced rvest",
    "section": "",
    "text": "Scrape the comments.\nTurn the comment into text.\nThen read that text as html.\nProceed as normal.",
    "crumbs": [
      "<span class='chapter-number'>35</span>  <span class='chapter-title'>Advanced rvest</span>"
    ]
  },
  {
    "objectID": "sportsreferencecsvs.html",
    "href": "sportsreferencecsvs.html",
    "title": "36  Getting CSVs from Sports Reference",
    "section": "",
    "text": "Every table of data on Sports Reference can be turned into a csv using the magic of copy and paste. There’s some tricks to it.\nStep 1: In R Studio, open a plain text file.\n\n\n\n\n\nStep 2: On the table you want in Sports Reference, find the Share & Export tab and go to Get table as CSV (For Excel). NOTE: THIS TABLE HAS TWO HEADER ROWS. You will need to fix that later.\n\nStep 3: Highlight and copy the data from Sports Reference.\n\nStep 4: Paste it into your plain text file in R Studio and fix your headers. Remember that data in R – and pretty much every other data analysis platform – must have one row for headers. What you need to do now, in the text file, is check and see if you have any headers in that second row that repeat. If you have multiple G for goals – one is total goals, one is goals per something – you need to fix that manually. In my example, the first row is header names and none of them repeat. I’m good to move forward.\n\nStep 6: Save your text file as whatever you want to name it DOT csv and put it where you’ve got your project data.\n\nStep 7: Import your data like you would in any other assignment. You just created a CSV file.",
    "crumbs": [
      "<span class='chapter-number'>36</span>  <span class='chapter-title'>Getting CSVs from Sports Reference</span>"
    ]
  },
  {
    "objectID": "blogging.html",
    "href": "blogging.html",
    "title": "37  Building your own blog with Quarto",
    "section": "",
    "text": "37.1 Setup\nWith those requirements in mind, we’re going to use a library called Quarto, which supercharges R Markdown to make documents, websites, blogs and books. It’s new, and growing, and you can do a lot with it.\nYou’ll first go to Quarto’s website and wait just one moment before you do anything.\nBefore you install Quarto, you should close R Studio. So close R Studio, install it, restart R Studio and come back to this tutorial. Then install Quarto.\nAfter that, we’re ready to start making a blog. To do that, go to File &gt; New Project and select New Directory, and follow the instructions here. In the Project Type view, you may have to scroll down to find “Quarto blog” but that’s the choice you want.\nAnd now we’ve come to our first decision point.\nFirst, name the directory you’re going to put this into. Keep it simple. Blog is fine. Then decide where on your computer you’re going to put it. Put it somewhere you’re going to remember. Don’t put it on your Desktop. Put it in a folder. Remember what folder because you’re going to need this later. Choose “None” as your engine and check the “Open in new session” box. Do NOT create a new repository at this point, then create the project.\nWhen you hit Create Project, you should get an R Studio screen. You might have two files open – _quarto.yml and index.qmd. If you don’t, open them (you can use the files pane in the bottom right). The important one for now is _quarto.yml. This file will look different depending on some choices you make.\nThe choices you need to make:",
    "crumbs": [
      "<span class='chapter-number'>37</span>  <span class='chapter-title'>Building your own blog with Quarto</span>"
    ]
  },
  {
    "objectID": "blogging.html#setup",
    "href": "blogging.html#setup",
    "title": "37  Building your own blog with Quarto",
    "section": "",
    "text": "The website title should be yours.\nThe Github account (more on this soon) and Twitter handles should be yours.\nIf you want a custom favicon logo, you’ll have to include one. You can ignore this for a while.\nYou should pick a not-default theme. If you want to have themes for light and dark mode, the code below handles that. If you want just one theme, the default code you get in your _quarto.yml file does that.\nAdd the execute: freeze bits below to your file. This way, your code only executes when you change it. This will become more important later when you have multiple posts.\n\nproject:\n  type: website\n\nwebsite:\n  title: \"Derek's Collection of Miscellany\"\n  description: \"A blog about random fiddling with code and data.\"\n  navbar:\n    right:\n      - about.qmd\n      - icon: github\n        href: https://github.com/dwillis\n      - icon: twitter\n        href: https://twitter.com/derekwillis\n  favicon: logo.png\n  \nformat:\n  html:\n    theme:\n      light: litera\n      dark: cyborg\n    css: styles.css\n\neditor: source\n\nexecute:\n  freeze: auto",
    "crumbs": [
      "<span class='chapter-number'>37</span>  <span class='chapter-title'>Building your own blog with Quarto</span>"
    ]
  },
  {
    "objectID": "blogging.html#creating-a-post",
    "href": "blogging.html#creating-a-post",
    "title": "37  Building your own blog with Quarto",
    "section": "37.2 Creating a post",
    "text": "37.2 Creating a post\nUnder the files tab on the lower right, you’ll see a folder named posts. In there, you’ll find two folders with sample posts in them. There’s not much to them, but they’re useful to look at before we delete them.\nTo create a post, you’re going to first create a folder for it. The folder name matters because it’s going to be part of your url. For this to work your folder name has to do a couple of things:\n\nContain only lowercase letters and dashes instead of spaces. So My Awesome Post will not work. It should be my-awesome-post.\nContain words that are in your post, and would be something people would search for. If your post is about Maryland women’s run into the NCAA Tournament, make sure your post title and folder name contains those words.\nIn other words, you need to think about what your post is about before you make this folder. Can you change it later? Yes. But the sooner you start focusing on a topic the better.\n\nAfter you have created the folder, go to the button next to the create folder button and create a Quarto Document. Name that document index.qmd. DO NOT NAME IT CAPITAL I INDEX. IT’S LOWER CASE I.\nAt the top, you will have something called a yaml header, which are things that set up the page. They are quite simple to figure out. Here is an example you should copy and edit for all of your posts.\n---\ntitle: \"CHANGE THIS TO BE THE TITLE OF YOUR POST\"\nauthor: \"THIS IS YOUR NAME\"\ndate: '2023-XX-XX'\ncategories: [lowercaseword, lowercaseword, lowercaseword]\nimage: \"image.png\"\nformat: \n  html:\n    code-fold: true\n---\nFor us, the cold-fold bit is important, and it is not standard. This will allow users to see your code that makes your graphics, without displaying it. Users can decide if they want to see the code.\nNow that you have a folder and an index.qmd file with a proper yaml header, you’re ready to write your post. This document works just the same as any .qmd file we’ve worked with all semester. Create text between code blocks, and your code blocks will execute to produce graphics.",
    "crumbs": [
      "<span class='chapter-number'>37</span>  <span class='chapter-title'>Building your own blog with Quarto</span>"
    ]
  },
  {
    "objectID": "blogging.html#seeing-your-site",
    "href": "blogging.html#seeing-your-site",
    "title": "37  Building your own blog with Quarto",
    "section": "37.3 Seeing your site",
    "text": "37.3 Seeing your site\nWhile you are creating your site, you’re going to want to see it. Now’s a good time to introduce serving your site in R Studio so you can see it before you deploy it.\nYou can use the Render button in your editor to do that, and if you want to see it inside RStudio you can check the “Preview in Viewer Pane” from the drop-down menu just to the right of the Render button. Otherwise, the site will render in your browser locally.",
    "crumbs": [
      "<span class='chapter-number'>37</span>  <span class='chapter-title'>Building your own blog with Quarto</span>"
    ]
  },
  {
    "objectID": "blogging.html#publishing-your-site",
    "href": "blogging.html#publishing-your-site",
    "title": "37  Building your own blog with Quarto",
    "section": "37.4 Publishing your site",
    "text": "37.4 Publishing your site\nQuarto will take your .qmd files and create static html. What does static html mean? It means there’s no server creating it on the fly – that’s called dynamic html – so this can be hosted on the simplest of servers.\nPublishing takes a lot of steps to get set up, but once it is, it’s easy.\nStep 1: Get a GitHub account\nGo to GitHub and sign up for an account. NOTE: Your username will be part of your website address, and you could potentially be sending this to employers. I’m sure blaze420rryday has been your handle since middle school, but do you want an employer to see that? My GitHub user name is dwillis See what I’m getting at here?\nStep 2: Set up your website repository\nFor the low low price of nothing, GitHub will host a website for you, and we are going to take them up on that bargain. There’s several tricks to getting this to work, but none of them are hard. They just require you to be specific.\nTo start, you can click on the plus sign in the top right corner or hit the green new button, depending on what your page looks like vs mine (I’m reasonably active GitHub user, so mine will look different from yours).\n\n\n\n\n\n\n\n\n\nIn the create a new repository page, the name of your respository needs to follow this pattern: yourusernamehere.github.io where yourusernamehere is … your username. So my site is dwillis.github.io because my username is dwillis This is why you do not want to select swaggylovedoctor as your username, no matter how attached to it you are. Your employment chances are zero with something dumb like that.\nAfter you’ve named the repository correctly, leave it public, check add .gitignore, and then select a gitignore template. Type R into the search, select it, and the create repository button will become active. Click create repository.\nFinally, setup your repository so that it will publish your site every time you push updated or new files from the main branch. You can do that under “Settings”:\n\n\n\n\n\n\n\n\n\nStep 3: (optional if you’re fine using the command line interface)\nDon’t close your GitHub window.\nIn a new tab, download the GitHub Desktop App and install it.\nGitHub is a version control system and a social network mixed together. Version control is like Track Changes in Word, but on steroids. If you plan on a career in analytics or data science, GitHub is a skill you will have to learn, but it’s beyond the scope of this book.\nTo work around this, we’re going to use GitHub Desktop to manage our interactions with GitHub. Open GitHub Desktop and log into your GitHub account in the app.\nTo get your repository into GitHub Desktop, go back to your tab with your GitHub repository in it. Find the Code button and click it. Click on the Open With GitHub Desktop button.\nIn the window that pops up, we need to set the Local Path. This path needs to be the same place your blog project is located. Click the Choose button and navigate to where your blog project is located. Then, just click Clone.\n\n\n\n\n\n\n\n\n\nStep 4:\nLet’s get your site on the internet.\nSwitch back to your blog project in R Studio. We’re going to output your site and upload it to GitHub.\nTo do this, we need to change config.yaml. We need to tell your website project that you want to publish to your GitHub folder, not the default.\nOpen _quarto.yml in your blog project. Near the top, below type: website, add this line:\noutput-dir: docs\nSave _quarto.yml.\nThen, add a .nojekyll file to the root of your repository that tells GitHub Pages not to do additional processing of your published site using Jekyll (the GitHub default site generation tool). You can follow these instructions on how to do that.\nOnce you are ready to build your site, you can do so using the quarto render command via the Terminal and then git push (or using GitHub Desktop).\nStep 5 (GitHub Desktop only)\nNow go to the GitHub Desktop App. You should see something that looks like this, though yours will be different from mine.\n\n\n\n\n\n\n\n\n\nThis is where you will commit files to your repository. GitHub is a two-step process for getting files from your computer to GitHub. The first is committing the files. To do that, add a message in the box next to your avatar (where it says update index.html in the screenshot above). Then click Commit to main (mine says master because it’s an older repository before GitHub switched to using main by default). The second step is to push it to GitHub. You do that on the screen that appears after you have committed your files. It should say you have No Local Changes, which is good because you sent them to GitHub. Now click Push origin.\n\n\n\n\n\n\n\n\n\nIn a few minutes, you should be able to go to username.github.io in a browser and you’ll see your site.",
    "crumbs": [
      "<span class='chapter-number'>37</span>  <span class='chapter-title'>Building your own blog with Quarto</span>"
    ]
  },
  {
    "objectID": "checklist.html",
    "href": "checklist.html",
    "title": "38  Project Checklist",
    "section": "",
    "text": "38.1 Writing checklist",
    "crumbs": [
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Project Checklist</span>"
    ]
  },
  {
    "objectID": "checklist.html#writing-checklist",
    "href": "checklist.html#writing-checklist",
    "title": "38  Project Checklist",
    "section": "",
    "text": "Have you spell checked your writing?\nHave you read what you have written out loud? Reading it out loud will help you find bad writing.\nNo really. Read it out loud. It makes a huge difference. If you stumble over your own words, you should rewrite it.\nIf what you read out loud doesn’t sound like you, rewrite it.\nDo you have complete sentences? Do you have active verbs?",
    "crumbs": [
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Project Checklist</span>"
    ]
  },
  {
    "objectID": "checklist.html#headline-checklist",
    "href": "checklist.html#headline-checklist",
    "title": "38  Project Checklist",
    "section": "38.2 Headline checklist",
    "text": "38.2 Headline checklist\n\nAre your headlines just labels? Example: Maryland’s offense. NBA’s Best Shooters. The best NFL punters. Those are labels, not headlines.\nDo your headlines tell a story, or attempt to draw me into one?\nDo your headlines include words that are what the chart is about?\nDo your headlines point me toward what I should see in the chart?",
    "crumbs": [
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Project Checklist</span>"
    ]
  },
  {
    "objectID": "checklist.html#graphics-checklist",
    "href": "checklist.html#graphics-checklist",
    "title": "38  Project Checklist",
    "section": "38.3 Graphics checklist",
    "text": "38.3 Graphics checklist\n\nDo you have the required parts? They are: headline, chatter, credit line, source line.\nDo your graphics have annotations that help me determine what is going on? Example: Are important dots labeled on a scatterplot?\nAre there lines to show me averages? Are those lines labeled?\nCan I read bar chart axis text?\n\nDo each one of your charts tell a story? Can I tell what that story is in a glance?\nDo you use color sparingly to draw my attention to something specific?\nIs there separation between your headline size and your chatter size?\nDoes your typography have a hierarchy? Does your headline stand out from your chatter? Are your axis labels smaller than your data labels?\nHave you simplified the theme (i.e. dropped the default grey background)?\nAre your axis labels something anyone can understand?",
    "crumbs": [
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Project Checklist</span>"
    ]
  },
  {
    "objectID": "checklist.html#code-checklist",
    "href": "checklist.html#code-checklist",
    "title": "38  Project Checklist",
    "section": "38.4 Code checklist",
    "text": "38.4 Code checklist\n\nAre your variables named what they are? Meaning, did you call your data logs when it’s made up of players? That’s bad.\nIs spaced out so it’s one line per command? Look at the example post for guidance.\nIs your code in the proper order? Libraries at the top. Data preparation before the graphics?\nDid you add message=FALSE, warning=FALSE to any {r} blocks that spit out large amounts of automated text? Your library step doesn’t need all that gibberish spitting out in your blog.",
    "crumbs": [
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Project Checklist</span>"
    ]
  },
  {
    "objectID": "checklist.html#last-thing",
    "href": "checklist.html#last-thing",
    "title": "38  Project Checklist",
    "section": "38.5 Last thing",
    "text": "38.5 Last thing\nCan you see your blog post on the internet?\nThe link you are turning in starts with YourGitHubUserNameHere.github.io. If you are turning in a GitHub.com url, you are turning in the wrong thing.",
    "crumbs": [
      "<span class='chapter-number'>38</span>  <span class='chapter-title'>Project Checklist</span>"
    ]
  }
]